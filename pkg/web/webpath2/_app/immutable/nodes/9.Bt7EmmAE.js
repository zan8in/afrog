import{p as he,a as Ne,q as fe,g as h,r as p,aw as zt,v as ut,w as Ie,d as s,e as $e,ax as Et,ay as Ot,Z as ce,a6 as st,j as e,W as A,az as At,f as u,i as l,D as d,aA as Lt,F as n,n as z,a1 as L,t as V,_ as Y,k as N,aB as He,aC as gt,C as X,aD as bt,aE as rt,y as Je,z as Ke,A as Ze,T as Ft,u as ot,aF as _t,aG as _e,aH as jt,aI as pt,aJ as mt,c as It,aK as Yt,aL as Dt,aM as Rt,aN as Qt,aO as Bt,m as Ut,aP as qt,aQ as it}from"../chunks/DP9-rN22.js";import{B as pe}from"../chunks/qSYZW6i7.js";import{B as re,b as tt}from"../chunks/BQ24xIRK.js";import{I as Nt}from"../chunks/mrCXMKbp.js";import{L as ht}from"../chunks/DPm9aVcr.js";import{a as qe}from"../chunks/rPupsha6.js";import{S as Ct,a as wt,b as St,c as kt,d as Mt}from"../chunks/BzdbhFAs.js";import{g as Vt,c as Xe}from"../chunks/D_N-Uuvj.js";import{M as Wt}from"../chunks/C92a979i.js";import{B as Gt,A as Ht,a as Jt,b as Kt,c as Zt,d as Xt,e as ea,f as ta,g as aa,R as sa,T as nt,h as dt}from"../chunks/DwEMkxvl.js";import{R as ct,s as at}from"../chunks/CFY-pZWZ.js";import{a as $t}from"../chunks/Dcjaah1X.js";function Pt(B,t){he(t,!0);let r=Ne(t,"ref",15,null),o=Ne(t,"open",15,!1),i=Ie(t,["$$slots","$$events","$$legacy","ref","open"]);var F=fe(),H=h(F);p(H,()=>zt,(oe,ie)=>{ie(oe,ut({"data-slot":"collapsible"},()=>i,{get ref(){return r()},set ref(le){r(le)},get open(){return o()},set open(le){o(le)}}))}),s(B,F),$e()}function yt(B,t){he(t,!0);let r=Ne(t,"ref",15,null),o=Ie(t,["$$slots","$$events","$$legacy","ref"]);var i=fe(),F=h(i);p(F,()=>Et,(H,oe)=>{oe(H,ut({"data-slot":"collapsible-trigger"},()=>o,{get ref(){return r()},set ref(ie){r(ie)}}))}),s(B,i),$e()}function xt(B,t){he(t,!0);let r=Ne(t,"ref",15,null),o=Ie(t,["$$slots","$$events","$$legacy","ref"]);var i=fe(),F=h(i);p(F,()=>Ot,(H,oe)=>{oe(H,ut({"data-slot":"collapsible-content"},()=>o,{get ref(){return r()},set ref(ie){r(ie)}}))}),s(B,i),$e()}class ra{#e=ce(st({source:"all",severity:[],tags:[],author:[],timeRange:"all",favorites:!1,searchQuery:""}));get filters(){return e(this.#e)}set filters(t){A(this.#e,t,!0)}#t=ce(st([]));get pocs(){return e(this.#t)}set pocs(t){A(this.#t,t,!0)}#a=ce(st({total:0,builtin:0,curated:0,my:0,bySeverity:{critical:0,high:0,medium:0,low:0,info:0},topTags:[],topAuthors:[]}));get stats(){return e(this.#a)}set stats(t){A(this.#a,t,!0)}#s=ce(null);get selectedPoc(){return e(this.#s)}set selectedPoc(t){A(this.#s,t,!0)}#r=ce(!1);get loading(){return e(this.#r)}set loading(t){A(this.#r,t,!0)}#o=ce(!1);get sidebarCollapsed(){return e(this.#o)}set sidebarCollapsed(t){A(this.#o,t,!0)}#l=ce(st({page:1,pageSize:10,total:0}));get pagination(){return e(this.#l)}set pagination(t){A(this.#l,t,!0)}async loadPocs(){this.loading=!0;try{const t=new At;this.filters.source!=="all"&&t.append("source",this.filters.source),this.filters.severity.length>0&&t.append("severity",this.filters.severity.join(",")),this.filters.tags.length>0&&t.append("tags",this.filters.tags.join(",")),this.filters.author.length>0&&t.append("author",this.filters.author.join(",")),this.filters.timeRange!=="all"&&t.append("time_range",this.filters.timeRange),this.filters.favorites&&t.append("favorites","true"),this.filters.searchQuery&&t.append("q",this.filters.searchQuery),t.append("page",this.pagination.page.toString()),t.append("page_size",this.pagination.pageSize.toString());const r=await qe.get(`/pocs?${t.toString()}`);r.success&&r.data?r.data.items?(this.pocs=r.data.items,this.pagination.total=r.data.total||0):Array.isArray(r.data)?(this.pocs=r.data,this.pagination.total=r.data.length):(this.pocs=[],this.pagination.total=0):(this.pocs=[],this.pagination.total=0)}catch(t){console.error("Failed to load POCs:",t),this.pocs=[],this.pagination.total=0}finally{this.loading=!1}}async loadStats(){try{const t=await qe.loadPocsStats();if(t.success&&t.data){const r=t.data;this.stats={total:r?.total??0,builtin:r?.by_source?.builtin??0,curated:r?.by_source?.curated??0,my:r?.by_source?.my??0,bySeverity:{critical:r?.by_severity?.critical??0,high:r?.by_severity?.high??0,medium:r?.by_severity?.medium??0,low:r?.by_severity?.low??0,info:r?.by_severity?.info??0},topTags:r?.top_tags??[],topAuthors:r?.top_authors??[]}}}catch(t){console.error("Failed to load POC stats:",t)}}async searchPocs(t){this.filters.searchQuery=t,this.pagination.page=1,await Promise.all([this.loadPocs(),this.loadStats()])}async updateFilters(t){this.filters={...this.filters,...t},this.pagination.page=1,await Promise.all([this.loadPocs(),this.loadStats()])}async selectPoc(t){if(this.selectedPoc=t,t&&!t.yaml_content){const r=t.poc_id||t.id?.toString();r?await this.loadPocContent(r):console.warn("POC has no valid ID:",t)}}async loadPocContent(t){try{const r=await qe.getPocYamlContent(t);if(r.success&&r.data&&this.selectedPoc){this.selectedPoc.yaml_content=r.data;const o=this.pocs.findIndex(i=>i.poc_id&&i.poc_id===t||i.id&&i.id.toString()===t);o!==-1&&(this.pocs[o].yaml_content=r.data)}}catch(r){console.error("Failed to load POC content:",r)}}async deletePoc(t){try{(await qe.delete(`/pocs/${t}`)).success&&(this.pocs=this.pocs.filter(o=>o.poc_id!==t),this.selectedPoc?.poc_id===t&&(this.selectedPoc=null),await this.loadStats())}catch(r){console.error("Failed to delete POC:",r)}}async syncCuratedPocs(){try{(await qe.post("/pocs/curated/sync")).success&&await Promise.all([this.loadPocs(),this.loadStats()])}catch(t){console.error("Failed to sync Curated POCs:",t)}}toggleSidebar(){this.sidebarCollapsed=!this.sidebarCollapsed}async goToPage(t){this.pagination.page=t,await Promise.all([this.loadPocs(),this.loadStats()])}async changePageSize(t){this.pagination.pageSize=t,this.pagination.page=1,await Promise.all([this.loadPocs(),this.loadStats()])}async init(){await Promise.all([this.loadPocs(),this.loadStats()])}}const a=new ra;var oa=u('<span class="text-sm">全部 PoCs</span> <!>',1),la=u('<span class="text-sm">公共 PoCs</span> <!>',1),ia=u('<span class="text-sm">精选 PoCs</span> <!>',1),na=u('<span class="text-sm">我的 PoCs</span> <!>',1),da=u('<span class="text-sm capitalize"> </span> <!>',1),ca=u('<div class="flex items-center gap-2"><!></div> <!>',1),ua=u('<span class="w-full truncate text-sm"> </span> <!>',1),va=u('<div class="space-y-2"><!> <!> <!></div>'),fa=u('<div class="p-2 text-sm text-muted-foreground">暂无标签数据</div>'),ga=u('<div class="border-b p-4"><!> <!></div>'),_a=u('<div class="flex items-center gap-2"><!></div> <!>',1),pa=u('<span class="w-full truncate text-sm"> </span> <!>',1),ma=u('<div class="space-y-2"><!> <!> <!></div>'),ha=u('<div class="border-b p-4"><!> <!></div>'),$a=u('<div class="border-b p-4"><div class="relative"><!> <!></div></div> <div class="border-b p-4"><div class="space-y-2"><!> <!> <!> <!></div></div> <div class="border-b p-4"><div class="space-y-2"></div></div> <!> <!>',1),Pa=u("<!> <!> <!>",1),ya=u('<div class="flex h-full w-64 flex-col border-r bg-card"><div class="border-b p-4"><h2 class="text-lg font-semibold">POC 管理</h2></div> <!> <div class="border-t p-4"><!></div></div>');function xa(B,t){he(t,!0);let r=Ne(t,"stats",19,()=>a.stats),o=st({tags:!1,authors:!1});function i(k){const W=[...a.filters.severity];W.includes(k)?a.updateFilters({severity:W.filter(ne=>ne!==k)}):a.updateFilters({severity:[...W,k]})}function F(k){const W=[...a.filters.tags];W.includes(k)?a.updateFilters({tags:W.filter(ne=>ne!==k)}):a.updateFilters({tags:[...W,k]})}function H(k){const W=[...a.filters.author];W.includes(k)?a.updateFilters({author:W.filter(ne=>ne!==k)}):a.updateFilters({author:[...W,k]})}function oe(){a.updateFilters({source:"all",severity:[],tags:[],author:[],timeRange:"all",favorites:!1,searchQuery:""})}const ie=["critical","high","medium","low","info"];var le=ya(),Ye=l(d(le),2);p(Ye,()=>Mt,(k,W)=>{W(k,{class:"flex-1",children:(ne,Se)=>{var ke=Pa(),ue=h(ke);p(ue,()=>Ct,(j,G)=>{G(j,{class:"h-full",children:(ye,ze)=>{var xe=$a(),Me=h(xe),ge=d(Me),me=d(ge);Lt(me,{class:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 transform text-muted-foreground"});var De=l(me,2);Nt(De,{placeholder:"搜索 PoC 名称、ID、标签",class:"pl-9",onkeydown:$=>{$.key==="Enter"&&a.searchPocs(a.filters.searchQuery)},get value(){return a.filters.searchQuery},set value($){a.filters.searchQuery=$}}),n(ge),n(Me);var Ve=l(Me,2),Ee=d(Ve),Re=d(Ee);{let $=N(()=>a.filters.source==="all"?"bg-muted":"");re(Re,{get class(){return`flex w-full items-center justify-between rounded-md p-2 text-left no-underline transition-colors hover:bg-muted ${e($)??""}`},onclick:()=>a.updateFilters({source:"all"}),variant:"ghost",children:(P,Z)=>{var E=oa(),v=l(h(E),2);pe(v,{variant:"secondary",children:(y,b)=>{z();var f=L();V(()=>Y(f,r().total)),s(y,f)},$$slots:{default:!0}}),s(P,E)},$$slots:{default:!0}})}var Qe=l(Re,2);{let $=N(()=>a.filters.source==="builtin"?"bg-muted":"");re(Qe,{get class(){return`un flex w-full items-center justify-between rounded-md p-2 text-left no-underline transition-colors hover:bg-muted ${e($)??""}`},onclick:()=>a.updateFilters({source:"builtin"}),variant:"ghost",children:(P,Z)=>{var E=la(),v=l(h(E),2);pe(v,{variant:"secondary",children:(y,b)=>{z();var f=L();V(()=>Y(f,r().builtin)),s(y,f)},$$slots:{default:!0}}),s(P,E)},$$slots:{default:!0}})}var Be=l(Qe,2);{let $=N(()=>a.filters.source==="curated"?"bg-muted":"");re(Be,{get class(){return`un flex w-full items-center justify-between rounded-md p-2 text-left no-underline transition-colors hover:bg-muted ${e($)??""}`},onclick:()=>a.updateFilters({source:"curated"}),variant:"ghost",children:(P,Z)=>{var E=ia(),v=l(h(E),2);pe(v,{variant:"secondary",children:(y,b)=>{z();var f=L();V(()=>Y(f,r().curated)),s(y,f)},$$slots:{default:!0}}),s(P,E)},$$slots:{default:!0}})}var c=l(Be,2);{let $=N(()=>a.filters.source==="my"?"bg-muted":"");re(c,{get class(){return`flex w-full items-center justify-between rounded-md p-2 text-left no-underline transition-colors hover:bg-muted ${e($)??""}`},onclick:()=>a.updateFilters({source:"my"}),variant:"ghost",children:(P,Z)=>{var E=na(),v=l(h(E),2);pe(v,{variant:"secondary",children:(y,b)=>{z();var f=L();V(()=>Y(f,r().my)),s(y,f)},$$slots:{default:!0}}),s(P,E)},$$slots:{default:!0}})}n(Ee),n(Ve);var S=l(Ve,2),U=d(S);He(U,20,()=>ie,$=>$,($,P)=>{{let Z=N(()=>a.filters.severity.includes(P)?"bg-muted":"");re($,{get class(){return`flex w-full items-center justify-between rounded-md p-2 text-left no-underline transition-colors hover:bg-muted ${e(Z)??""}`},onclick:()=>i(P),variant:"ghost",children:(E,v)=>{var y=da(),b=h(y),f=d(b,!0);n(b);var M=l(b,2);pe(M,{variant:"secondary",children:(C,R)=>{z();var _=L();V(()=>Y(_,r().bySeverity[P])),s(C,_)},$$slots:{default:!0}}),V(()=>Y(f,P)),s(E,y)},$$slots:{default:!0}})}}),n(U),n(S);var m=l(S,2);p(m,()=>Pt,($,P)=>{P($,{open:!0,children:(Z,E)=>{var v=ga(),y=d(v);p(y,()=>yt,(f,M)=>{M(f,{class:"mb-3 flex w-full items-center justify-between",children:(C,R)=>{var _=ca(),w=h(_),T=d(w);ht(T,{class:"font-medium",children:(x,O)=>{z();var g=L("按标签分类");s(x,g)},$$slots:{default:!0}}),n(w);var se=l(w,2);{let x=N(()=>`h-4 w-4 transition-transform ${o.tags?"rotate-180":""}`);gt(se,{get class(){return e(x)}})}s(C,_)},$$slots:{default:!0}})});var b=l(y,2);p(b,()=>xt,(f,M)=>{M(f,{children:(C,R)=>{var _=fe(),w=h(_);{var T=x=>{var O=va(),g=d(O);He(g,17,()=>r().topTags.slice(0,o.tags?r().topTags.length:5),({tag:Q,count:K})=>Q,(Q,K)=>{let ve=()=>e(K).tag,be=()=>e(K).count;{let Oe=N(()=>a.filters.tags.includes(ve())?"bg-muted":"");re(Q,{get class(){return`flex w-full items-center justify-between rounded-md p-2 text-left no-underline transition-colors hover:bg-muted ${e(Oe)??""}`},onclick:()=>F(ve()),variant:"ghost",children:(Le,We)=>{var Ge=ua(),Ae=h(Ge),de=d(Ae,!0);n(Ae);var Ce=l(Ae,2);pe(Ce,{variant:"outline",children:(Ue,Fe)=>{z();var Te=L();V(()=>Y(Te,be())),s(Ue,Te)},$$slots:{default:!0}}),V(()=>Y(de,ve())),s(Le,Ge)},$$slots:{default:!0}})}});var J=l(g,2);{var q=Q=>{re(Q,{variant:"ghost",size:"sm",class:"w-full",onclick:()=>{o.tags=!0},children:(K,ve)=>{z();var be=L();V(()=>Y(be,`显示更多... (${r().topTags.length-5} 个)`)),s(K,be)},$$slots:{default:!0}})};X(J,Q=>{!o.tags&&r().topTags.length>5&&Q(q)})}var ee=l(J,2);{var te=Q=>{re(Q,{variant:"ghost",size:"sm",class:"w-full",onclick:()=>{o.tags=!1},children:(K,ve)=>{z();var be=L("收起");s(K,be)},$$slots:{default:!0}})};X(ee,Q=>{o.tags&&r().topTags.length>5&&Q(te)})}n(O),s(x,O)},se=x=>{var O=fa();s(x,O)};X(w,x=>{r().topTags.length>0?x(T):x(se,!1)})}s(C,_)},$$slots:{default:!0}})}),n(v),s(Z,v)},$$slots:{default:!0}})});var D=l(m,2);p(D,()=>Pt,($,P)=>{P($,{open:!0,children:(Z,E)=>{var v=ha(),y=d(v);p(y,()=>yt,(f,M)=>{M(f,{class:"mb-3 flex w-full items-center justify-between",children:(C,R)=>{var _=_a(),w=h(_),T=d(w);ht(T,{class:"font-medium",children:(x,O)=>{z();var g=L("按作者分类");s(x,g)},$$slots:{default:!0}}),n(w);var se=l(w,2);{let x=N(()=>`h-4 w-4 transition-transform ${o.authors?"rotate-180":""}`);gt(se,{get class(){return e(x)}})}s(C,_)},$$slots:{default:!0}})});var b=l(y,2);p(b,()=>xt,(f,M)=>{M(f,{children:(C,R)=>{var _=ma(),w=d(_);He(w,17,()=>r().topAuthors.slice(0,o.authors?r().topAuthors.length:5),({author:g,count:J})=>g,(g,J)=>{let q=()=>e(J).author,ee=()=>e(J).count;{let te=N(()=>a.filters.author.includes(q())?"bg-muted":"");re(g,{get class(){return`flex w-full items-center justify-between rounded-md p-2 text-left no-underline transition-colors hover:bg-muted ${e(te)??""}`},onclick:()=>H(q()),variant:"ghost",children:(Q,K)=>{var ve=pa(),be=h(ve),Oe=d(be,!0);n(be);var Le=l(be,2);pe(Le,{variant:"outline",children:(We,Ge)=>{z();var Ae=L();V(()=>Y(Ae,ee())),s(We,Ae)},$$slots:{default:!0}}),V(()=>Y(Oe,q())),s(Q,ve)},$$slots:{default:!0}})}});var T=l(w,2);{var se=g=>{re(g,{variant:"ghost",size:"sm",class:"w-full",onclick:()=>o.authors=!0,children:(J,q)=>{z();var ee=L();V(()=>Y(ee,`显示更多... (${r().topAuthors.length-5} 个)`)),s(J,ee)},$$slots:{default:!0}})};X(T,g=>{!o.authors&&r().topAuthors.length>5&&g(se)})}var x=l(T,2);{var O=g=>{re(g,{variant:"ghost",size:"sm",class:"w-full",onclick:()=>o.authors=!1,children:(J,q)=>{z();var ee=L("收起");s(J,ee)},$$slots:{default:!0}})};X(x,g=>{o.authors&&r().topAuthors.length>5&&g(O)})}n(_),s(C,_)},$$slots:{default:!0}})}),n(v),s(Z,v)},$$slots:{default:!0}})}),s(ye,xe)},$$slots:{default:!0}})});var I=l(ue,2);p(I,()=>wt,(j,G)=>{G(j,{orientation:"vertical",children:(ye,ze)=>{var xe=fe(),Me=h(xe);p(Me,()=>St,(ge,me)=>{me(ge,{})}),s(ye,xe)},$$slots:{default:!0}})});var ae=l(I,2);p(ae,()=>kt,(j,G)=>{G(j,{})}),s(ne,ke)},$$slots:{default:!0}})});var we=l(Ye,2),Pe=d(we);re(Pe,{variant:"outline",size:"sm",class:"w-full",onclick:oe,children:(k,W)=>{z();var ne=L("清空筛选");s(k,ne)},$$slots:{default:!0}}),n(we),n(le),s(B,le),$e()}var ba=u('<div class="flex h-32 items-center justify-center"><div class="text-muted-foreground">加载中...</div></div>'),Ca=u('<div class="flex h-32 items-center justify-center"><div class="text-muted-foreground"></div></div>'),wa=(B,t,r)=>t(e(r)),Sa=u("<!> <!>",1),ka=u("<!> <!>",1),Ma=u('<div class="mt-2 flex flex-wrap gap-1"><!></div>'),Ta=u('<button type="button"><div class="min-w-0 flex-1"><div class="mb-1 flex items-center justify-between"><div class="flex items-center gap-2"><span class="max-w-[100px] truncate text-xs text-muted-foreground"> </span> <!></div> <div class="flex items-center gap-2 text-xs text-muted-foreground"><span> </span></div></div> <div class="font-sm mb-1 truncate text-foreground"> </div> <div class="line-clamp-2 text-sm leading-relaxed text-muted-foreground svelte-1eb3ol"> </div> <!></div></button>'),za=u("<!> <!> <!>",1),Ea=u('<div class="flex h-full flex-col bg-background"><div class="flex items-center justify-between border-b p-4"><div class="flex items-center gap-2"><h1 class="text-lg font-semibold">POC 列表</h1> <!></div></div> <!> <div class="flex items-center justify-between border-t p-3"><div class="text-sm text-muted-foreground"> </div> <div class="flex items-center gap-2"><!> <!></div></div></div>');function Oa(B,t){he(t,!0);let r="",o=N(()=>{if(!a.pocs)return[];let I=a.pocs;if(r.trim()){const ae=r.toLowerCase();I=I.filter(j=>j.name.toLowerCase().includes(ae)||j.author&&typeof j.author=="string"&&j.author.toLowerCase().includes(ae)||j.description.toLowerCase().includes(ae)||j.tags&&typeof j.tags=="string"&&j.tags.toLowerCase().includes(ae))}return I});function i(){a.pagination.page>1&&a.goToPage(a.pagination.page-1)}function F(){const I=Math.max(1,Math.ceil(a.pagination.total/a.pagination.pageSize));a.pagination.page<I&&a.goToPage(a.pagination.page+1)}async function H(I){await a.selectPoc(I)}var oe=Ea(),ie=d(oe),le=d(ie),Ye=l(d(le),2);{var we=I=>{pe(I,{variant:"secondary",class:"ml-2",children:(ae,j)=>{z();var G=L();V(()=>Y(G,a.pagination.total)),s(ae,G)},$$slots:{default:!0}})};X(Ye,I=>{a.pagination.total&&I(we)})}n(le),n(ie);var Pe=l(ie,2);p(Pe,()=>Mt,(I,ae)=>{ae(I,{class:"flex-1",children:(j,G)=>{var ye=za(),ze=h(ye);p(ze,()=>Ct,(ge,me)=>{me(ge,{class:"h-full",children:(De,Ve)=>{var Ee=fe(),Re=h(Ee);{var Qe=c=>{var S=ba();s(c,S)},Be=c=>{var S=fe(),U=h(S);{var m=$=>{var P=Ca(),Z=d(P);Z.textContent="暂无 POC 数据",n(P),s($,P)},D=$=>{var P=fe(),Z=h(P);He(Z,19,()=>e(o),(E,v)=>E.poc_id||E.id||v,(E,v)=>{var y=Ta();y.__click=[wa,H,v];var b=d(y),f=d(b),M=d(f),C=d(M),R=d(C,!0);n(C);var _=l(C,2);{let te=N(()=>`${Vt(e(v).severity)} lowercase`);pe(_,{variant:"secondary",get class(){return e(te)},children:(Q,K)=>{z();var ve=L();V(()=>Y(ve,e(v).severity)),s(Q,ve)},$$slots:{default:!0}})}n(M);var w=l(M,2),T=d(w),se=d(T,!0);n(T),n(w),n(f);var x=l(f,2),O=d(x,!0);n(x);var g=l(x,2),J=d(g,!0);n(g);var q=l(g,2);{var ee=te=>{var Q=Ma(),K=d(Q);{var ve=Oe=>{var Le=Sa(),We=h(Le);He(We,19,()=>e(v).tags.split(",").slice(0,4),(de,Ce)=>`${de}-${Ce}`,(de,Ce)=>{pe(de,{variant:"outline",class:"px-1.5 py-0.5 text-xs",children:(Ue,Fe)=>{z();var Te=L();V(je=>Y(Te,je),[()=>e(Ce).trim()]),s(Ue,Te)},$$slots:{default:!0}})});var Ge=l(We,2);{var Ae=de=>{pe(de,{variant:"outline",class:"px-1.5 py-0.5 text-xs",children:(Ce,Ue)=>{z();var Fe=L();V(Te=>Y(Fe,`+${Te??""}`),[()=>e(v).tags.split(",").length-4]),s(Ce,Fe)},$$slots:{default:!0}})};X(Ge,de=>{e(v).tags.split(",").length>4&&de(Ae)})}s(Oe,Le)},be=Oe=>{var Le=fe(),We=h(Le);{var Ge=de=>{var Ce=ka(),Ue=h(Ce);He(Ue,19,()=>e(v).tags.slice(0,4),(je,et)=>`${String(je)}-${et}`,(je,et)=>{pe(je,{variant:"outline",class:"px-1.5 py-0.5 text-xs",children:(vt,lt)=>{z();var ft=L();V(Tt=>Y(ft,Tt),[()=>String(e(et))]),s(vt,ft)},$$slots:{default:!0}})});var Fe=l(Ue,2);{var Te=je=>{pe(je,{variant:"outline",class:"px-1.5 py-0.5 text-xs",children:(et,vt)=>{z();var lt=L();V(()=>Y(lt,`+${e(v).tags.length-4}`)),s(et,lt)},$$slots:{default:!0}})};X(Fe,je=>{e(v).tags.length>4&&je(Te)})}s(de,Ce)},Ae=de=>{pe(de,{variant:"outline",class:"px-1.5 py-0.5 text-xs",children:(Ce,Ue)=>{z();var Fe=L();V(Te=>Y(Fe,Te),[()=>String(e(v).tags)]),s(Ce,Fe)},$$slots:{default:!0}})};X(We,de=>{Array.isArray(e(v).tags)&&e(v).tags.length>0?de(Ge):de(Ae,!1)},!0)}s(Oe,Le)};X(K,Oe=>{typeof e(v).tags=="string"?Oe(ve):Oe(be,!1)})}n(Q),s(te,Q)};X(q,te=>{e(v).tags&&te(ee)})}n(b),n(y),V(te=>{rt(y,1,te,"svelte-1eb3ol"),Y(R,e(v).author),Y(se,e(v).created),Y(O,e(v).name),Y(J,e(v).id||"暂无ID")},[()=>`flex w-full cursor-pointer items-start gap-4 border-b p-4 text-left transition-colors hover:bg-muted/50 ${(a.selectedPoc?.poc_id??a.selectedPoc?.id?.toString())===(e(v).poc_id??e(v).id?.toString())?"bg-muted/50":""}`]),s(E,y)}),s($,P)};X(U,$=>{!e(o)||e(o).length===0?$(m):$(D,!1)},!0)}s(c,S)};X(Re,c=>{a.loading?c(Qe):c(Be,!1)})}s(De,Ee)},$$slots:{default:!0}})});var xe=l(ze,2);p(xe,()=>wt,(ge,me)=>{me(ge,{orientation:"vertical",children:(De,Ve)=>{var Ee=fe(),Re=h(Ee);p(Re,()=>St,(Qe,Be)=>{Be(Qe,{})}),s(De,Ee)},$$slots:{default:!0}})});var Me=l(xe,2);p(Me,()=>kt,(ge,me)=>{me(ge,{})}),s(j,ye)},$$slots:{default:!0}})});var k=l(Pe,2),W=d(k),ne=d(W);n(W);var Se=l(W,2),ke=d(Se);{let I=N(()=>a.pagination.page<=1);re(ke,{variant:"outline",size:"sm",onclick:i,get disabled(){return e(I)},children:(ae,j)=>{z();var G=L("上一页");s(ae,G)},$$slots:{default:!0}})}var ue=l(ke,2);{let I=N(()=>a.pagination.page>=Math.max(1,Math.ceil(a.pagination.total/a.pagination.pageSize)));re(ue,{variant:"outline",size:"sm",onclick:F,get disabled(){return e(I)},children:(ae,j)=>{z();var G=L("下一页");s(ae,G)},$$slots:{default:!0}})}n(Se),n(k),n(oe),V(()=>Y(ne,`第 ${a.pagination.page??""} 页，共 ${a.pagination.total??""} 条`)),s(B,oe),$e()}bt(["click"]);var Aa=u("<div><!></div>");function La(B,t){he(t,!0);let r=Ie(t,["$$slots","$$events","$$legacy","class","children"]);var o=Aa();Je(o,F=>({"data-slot":"empty",class:F,...r}),[()=>Xe("flex min-w-0 flex-1 flex-col items-center justify-center gap-6 rounded-lg border-dashed p-6 text-center text-balance md:p-12",t.class)]);var i=d(o);Ke(i,()=>t.children??Ze),n(o),s(B,o),$e()}var Fa=u("<div><!></div>");function ja(B,t){he(t,!0);let r=Ie(t,["$$slots","$$events","$$legacy","class","children"]);var o=Fa();Je(o,F=>({"data-slot":"empty-header",class:F,...r}),[()=>Xe("flex max-w-sm flex-col items-center gap-2 text-center",t.class)]);var i=d(o);Ke(i,()=>t.children??Ze),n(o),s(B,o),$e()}const Ia=Ft({base:"mb-2 flex shrink-0 items-center justify-center [&_svg]:pointer-events-none [&_svg]:shrink-0",variants:{variant:{default:"bg-transparent",icon:"bg-muted text-foreground flex size-10 shrink-0 items-center justify-center rounded-lg [&_svg:not([class*='size-'])]:size-6"}},defaultVariants:{variant:"default"}});var Ya=u("<div><!></div>");function Da(B,t){he(t,!0);let r=Ne(t,"variant",3,"default"),o=Ie(t,["$$slots","$$events","$$legacy","class","children","variant"]);var i=Ya();Je(i,H=>({"data-slot":"empty-icon","data-variant":r(),class:H,...o}),[()=>Xe(Ia({variant:r()}),t.class)]);var F=d(i);Ke(F,()=>t.children??Ze),n(i),s(B,i),$e()}var Ra=u("<div><!></div>");function Qa(B,t){he(t,!0);let r=Ie(t,["$$slots","$$events","$$legacy","class","children"]);var o=Ra();Je(o,F=>({"data-slot":"empty-title",class:F,...r}),[()=>Xe("text-lg font-medium tracking-tight",t.class)]);var i=d(o);Ke(i,()=>t.children??Ze),n(o),s(B,o),$e()}var Ba=u("<div><!></div>");function Ua(B,t){he(t,!0);let r=Ie(t,["$$slots","$$events","$$legacy","class","children"]);var o=Ba();Je(o,F=>({"data-slot":"empty-description",class:F,...r}),[()=>Xe("text-sm/relaxed text-muted-foreground [&>a]:underline [&>a]:underline-offset-4 [&>a:hover]:text-primary",t.class)]);var i=d(o);Ke(i,()=>t.children??Ze),n(o),s(B,o),$e()}var qa=u("<div><!></div>");function Na(B,t){he(t,!0);let r=Ie(t,["$$slots","$$events","$$legacy","class","children"]);var o=qa();Je(o,F=>({"data-slot":"empty-content",class:F,...r}),[()=>Xe("flex w-full max-w-sm min-w-0 flex-col items-center gap-4 text-sm text-balance",t.class)]);var i=d(o);Ke(i,()=>t.children??Ze),n(o),s(B,o),$e()}var Va=u("<!> <!>",1),Wa=u("<!>新建 PoC",1),Ga=u("<!> <!> <!>",1),Ha=u("<!> <!>",1),Ja=u("<!> <!>",1),Ka=u("<!> <!>",1),Za=u("<!> <!>",1),Xa=u("<p> </p>"),es=u("<!> <!>",1),ts=u("<p>提交漏洞 PoC 至 afrog 社区</p>"),as=u("<!> <!>",1),ss=u("<!> <!> <!>",1),rs=u('<div class="flex h-full flex-col"><div class="flex min-h-0 min-w-0 flex-1 flex-col gap-3 overflow-hidden p-4"><!> <div class="relative min-h-0 flex-1 overflow-hidden"><div class="pointer-events-none absolute top-2 right-2 z-10 flex items-center gap-2"><!> <!></div> <!></div></div></div>'),os=u("<p> </p>"),ls=u("<!> <!>",1),is=u("<!> <!> <!>",1),ns=u("<!> 新建 PoC",1),ds=u('<div class="flex gap-2"><!></div>'),cs=u("<!> <!>",1),us=u('<div class="relative mt-6"><div class="absolute top-2 right-2 z-10"><!></div> <!></div>'),vs=u('<div class="flex h-full flex-col"><div class="flex items-center justify-between border-b p-4"><h3 class="text-lg font-semibold">POC 详情</h3> <div class="flex items-center gap-2"><!> <!></div></div> <!></div>');function fs(B,t){he(t,!0);let r=ce(!1),o=ce(!1),i=ce(""),F=ce(!1),H=ce(null),oe=Ne(t,"focusMode",3,!1),ie=Ne(t,"onToggleFocus",3,()=>{}),le=N(()=>()=>e(r)||e(o)?e(i):a.selectedPoc?.yaml_content||"");ot(()=>{console.log("displayYamlContent changed:",{editMode:e(r),isCreating:e(o),yamlContentLength:e(i).length,selectedPocId:a.selectedPoc?.poc_id||a.selectedPoc?.id,selectedPocYamlLength:a.selectedPoc?.yaml_content?.length||0,finalContentLength:e(le)().length,selectedPocYamlPreview:a.selectedPoc?.yaml_content?.substring(0,100)||"empty"})}),ot(()=>{if(console.log("selectedPoc effect triggered:",{selectedPocId:a.selectedPoc?.poc_id||a.selectedPoc?.id,editMode:e(r),isCreating:e(o),hasYamlContent:!!a.selectedPoc?.yaml_content,pocType:e(we)(),canEdit:e(Pe)(),canDelete:e(k)(),filePath:a.selectedPoc?.file_path,isCurated:a.selectedPoc?.is_curated}),a.selectedPoc&&!e(r)&&!e(o)){if(console.log("Clearing yamlContent for new POC selection"),A(i,""),!a.selectedPoc.yaml_content){const c=a.selectedPoc.poc_id||a.selectedPoc.id?.toString();c&&(console.log("Loading YAML content for POC:",c),a.loadPocContent(c))}}else!a.selectedPoc&&!e(o)&&(console.log("No POC selected, clearing yamlContent"),A(i,""))});function Ye(){const c=a.selectedPoc;if(!c)return;let S=at.activeTask;if(!S){const $=at.createTask("POC 扫描");at.setActiveTask($),S=at.activeTask}const U=c.poc_id||c.id?.toString()||"",m=c.name||U,D=c.severity||"info";at.addTaskPoc(S.id,{id:U,name:m,severity:D}),_e.success("已加入 1 个 PoC")}let we=N(()=>()=>a.selectedPoc?(console.log("POC Type Debug:",{poc_id:a.selectedPoc.poc_id,file_path:a.selectedPoc.file_path,is_curated:a.selectedPoc.is_curated,source:a.filters?.source}),a.selectedPoc.file_path&&a.selectedPoc.file_path.includes("/my/")?"my":a.selectedPoc.is_curated===!0?"curated":a.filters?.source==="my"||a.selectedPoc.poc_id&&(a.selectedPoc.poc_id.includes("custom-")||a.selectedPoc.poc_id.includes("user-")||a.selectedPoc.poc_id.includes("my-"))?"my":"builtin"):"unknown"),Pe=N(()=>()=>e(we)()==="my"),k=N(()=>()=>e(we)()==="my"),W=N(()=>()=>{const c=!e(r)&&!e(o);return console.log("isReadOnly calculated:",{editMode:e(r),isCreating:e(o),readonly:c,pocType:e(we)(),canEdit:e(Pe)()}),c});const ne=`id: new-poc

info:
  name: 新建 POC
  author: your-name
  severity: high
  description: |-
    描述
  tags: tag1,tag2
  created: ${new Date().toISOString().split("T")[0].replace(/-/g,"/")}

set:
  hostname: request.url.host
rules:
  r0:
    request:
      method: GET
      path: /login.html
    expression: response.status == 200 && response.body.bcontains(b'login')
expression: r0()`;function Se(){const c=e(le)();c&&(navigator.clipboard?.writeText(c),_e.success("YAML 内容已复制到剪贴板"))}function ke(){try{const c=e(le)();if(!c||!c.trim()){_e.error("暂无可下载的 YAML 内容");return}const S=a.selectedPoc?.poc_id||a.selectedPoc?.id||"poc",m=`${String(S).trim().replace(/[^\w.-]+/g,"_")}.yaml`,D=new Blob([c],{type:"text/yaml;charset=utf-8"}),$=URL.createObjectURL(D),P=document.createElement("a");P.href=$,P.download=m,document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL($),_e.success(`已下载: ${m}`)}catch(c){console.error("下载失败:",c),_e.error("下载失败，请稍后重试")}}function ue(){_e.info("功能尚未完成")}function I(){console.log("startEdit called:",{canEdit:e(Pe)(),currentEditMode:e(r),selectedPoc:!!a.selectedPoc}),e(Pe)()&&(A(r,!0),A(i,a.selectedPoc?.yaml_content||"",!0),console.log("startEdit completed:",{editMode:e(r),yamlContentLength:e(i).length}),setTimeout(()=>{if(e(H)&&e(H).focus)e(H).focus(),console.log("Monaco Editor focused via component method");else{const c=document.querySelector(".monaco-editor textarea");c&&(c.focus(),console.log("Monaco Editor focused via DOM element"))}},200))}function ae(){console.log("cancelEdit called:",{currentEditMode:e(r),currentIsCreating:e(o),yamlContentLength:e(i).length}),A(r,!1),A(o,!1),A(i,""),console.log("cancelEdit completed:",{editMode:e(r),isCreating:e(o),yamlContent:e(i).length}),setTimeout(()=>{console.log("Force update Monaco Editor after cancel")},100)}function j(){A(o,!0),A(r,!1),A(i,ne),a.selectedPoc=null}async function G(){if(console.log("savePoc called:",{yamlContentLength:e(i).length,isCreating:e(o),editMode:e(r),selectedPocId:a.selectedPoc?.poc_id}),!e(i).trim()){_e.error("YAML 内容不能为空");return}if(!ze(e(i))){_e.error("YAML 格式不正确，请检查语法");return}const c=e(r),S=e(o),U=e(i);A(F,!0);try{let m;if(e(o))console.log("Creating new POC"),m=await qe.createPoc({yaml_content:e(i)}),console.log("Create POC result:",m),_e.success("POC 创建成功"),A(o,!1);else if(e(r)&&a.selectedPoc){console.log("Updating existing POC:",{poc_id:a.selectedPoc.poc_id,id:a.selectedPoc.id,name:a.selectedPoc.name});const D=a.selectedPoc.poc_id||a.selectedPoc.id?.toString();if(!D)throw new Error("POC ID 不存在，无法更新");m=await qe.updatePoc(D,{yaml_content:e(i)}),console.log("Update POC result:",m),_e.success("POC 更新成功"),A(r,!1),a.selectedPoc&&(a.selectedPoc.yaml_content=e(i)),m.success&&m.data&&(a.selectedPoc=m.data)}if(m&&!m.success)throw new Error(m.message||"保存失败");console.log("Clearing yamlContent after save"),A(i,""),console.log("Reloading POCs"),await a.loadPocs(),console.log("savePoc completed:",{editMode:e(r),isCreating:e(o),yamlContentLength:e(i).length})}catch(m){console.error("保存失败:",m),A(r,c,!0),A(o,S,!0),A(i,U,!0),console.log("State rolled back due to error:",{editMode:e(r),isCreating:e(o),yamlContent:e(i).slice(0,50)+"..."});let D="保存失败，请重试";m instanceof Error&&(m.name==="ApiError"||m.message.includes("HTTP")?D=`API错误: ${m.message}`:m.message.includes("网络错误")||m.message.includes("fetch")?D="网络连接失败，请检查网络后重试":m.message.includes("登录过期")||m.message.includes("401")?D="登录已过期，请重新登录":m.message.includes("权限")?D="权限不足，无法执行此操作":D=`保存失败: ${m.message}`),_e.error(D)}finally{A(F,!1)}}async function ye(){if(!a.selectedPoc||!e(k)())return;const c=a.selectedPoc.poc_id||a.selectedPoc.id?.toString();if(!c){console.error("Delete POC failed: No valid POC ID found",{poc_id:a.selectedPoc.poc_id,id:a.selectedPoc.id,selectedPoc:a.selectedPoc}),_e.error("删除失败: POC ID 无效");return}console.log("Deleting POC:",{pocId:c,poc_id:a.selectedPoc.poc_id,id:a.selectedPoc.id,name:a.selectedPoc.name});try{await qe.deletePoc(c),_e.success("POC 删除成功"),a.selectedPoc=null,await a.loadPocs()}catch(S){const U=S instanceof Error?S.message:"未知错误";_e.error(`删除失败: ${U}`)}}function ze(c){try{const S=c.split(`
`);let U=!1,m=!1;for(const D of S)D.trim().startsWith("id:")&&(U=!0),D.trim().startsWith("info:")&&(m=!0);return U&&m}catch{return!1}}function xe(c){A(i,c,!0)}ot(()=>{const c=oe();if(e(H)?.getEditor){const S=e(H).getEditor();S&&setTimeout(()=>{try{S.layout(),console.log("Monaco Editor layout recalculated due to focusMode:",c)}catch(U){console.warn("Failed to layout editor on focusMode change",U)}},50)}});var Me=vs(),ge=d(Me),me=l(d(ge),2),De=d(me);p(De,()=>Gt,(c,S)=>{S(c,{children:(U,m)=>{var D=fe(),$=h(D);{var P=E=>{var v=Va(),y=h(v);re(y,{variant:"outline",size:"sm",onclick:ae,get disabled(){return e(F)},children:(f,M)=>{z();var C=L("取消");s(f,C)},$$slots:{default:!0}});var b=l(y,2);re(b,{size:"sm",onclick:G,get disabled(){return e(F)},children:(f,M)=>{z();var C=L();V(()=>Y(C,e(F)?"保存中...":"保存")),s(f,C)},$$slots:{default:!0}}),s(E,v)},Z=E=>{var v=Ga(),y=h(v);re(y,{size:"sm",onclick:j,children:(R,_)=>{var w=Wa(),T=h(w);_t(T,{}),z(),s(R,w)},$$slots:{default:!0}});var b=l(y,2);{var f=R=>{re(R,{variant:"outline",size:"sm",onclick:I,children:(_,w)=>{z();var T=L("编辑");s(_,T)},$$slots:{default:!0}})};X(b,R=>{a.selectedPoc&&e(Pe)()&&R(f)})}var M=l(b,2);{var C=R=>{re(R,{size:"sm",onclick:()=>Ye(),children:(_,w)=>{z();var T=L("加入扫描");s(_,T)},$$slots:{default:!0}})};X(M,R=>{a.selectedPoc&&R(C)})}s(E,v)};X($,E=>{e(o)||e(r)?E(P):E(Z,!1)})}s(U,D)},$$slots:{default:!0}})});var Ve=l(De,2);{var Ee=c=>{var S=fe(),U=h(S);p(U,()=>sa,(m,D)=>{D(m,{children:($,P)=>{var Z=Za(),E=h(Z);{let y=N(()=>tt({variant:"destructive",size:"sm"}));p(E,()=>Ht,(b,f)=>{f(b,{get class(){return e(y)},children:(M,C)=>{jt(M,{})},$$slots:{default:!0}})})}var v=l(E,2);p(v,()=>Jt,(y,b)=>{b(y,{children:(f,M)=>{var C=Ka(),R=h(C);p(R,()=>Kt,(w,T)=>{T(w,{children:(se,x)=>{var O=Ha(),g=h(O);p(g,()=>Zt,(q,ee)=>{ee(q,{children:(te,Q)=>{z();var K=L("确认删除 PoC?");s(te,K)},$$slots:{default:!0}})});var J=l(g,2);p(J,()=>Xt,(q,ee)=>{ee(q,{children:(te,Q)=>{z();var K=L();V(()=>Y(K,`确定要删除 POC "${a.selectedPoc?.name??""}" 吗？此操作不可撤销。`)),s(te,K)},$$slots:{default:!0}})}),s(se,O)},$$slots:{default:!0}})});var _=l(R,2);p(_,()=>ea,(w,T)=>{T(w,{children:(se,x)=>{var O=Ja(),g=h(O);p(g,()=>ta,(q,ee)=>{ee(q,{children:(te,Q)=>{z();var K=L("取消");s(te,K)},$$slots:{default:!0}})});var J=l(g,2);{let q=N(()=>tt({variant:"destructive"}));p(J,()=>aa,(ee,te)=>{te(ee,{get class(){return e(q)},onclick:ye,children:(Q,K)=>{z();var ve=L("确认删除");s(Q,ve)},$$slots:{default:!0}})})}s(se,O)},$$slots:{default:!0}})}),s(f,C)},$$slots:{default:!0}})}),s($,Z)},$$slots:{default:!0}})}),s(c,S)};X(Ve,c=>{a.selectedPoc&&e(k)()&&c(Ee)})}n(me),n(ge);var Re=l(ge,2);{var Qe=c=>{var S=rs(),U=d(S),m=d(U);{var D=b=>{};X(m,b=>{a.selectedPoc&&b(D)})}var $=l(m,2),P=d($),Z=d(P);p(Z,()=>ct,(b,f)=>{f(b,{children:(M,C)=>{var R=es(),_=h(R);{let T=N(()=>oe()?"退出专注":"专注模式"),se=N(()=>tt({variant:"outline",size:"sm"})+" pointer-events-auto");p(_,()=>nt,(x,O)=>{O(x,{get onclick(){return ie()},get"aria-label"(){return e(T)},get class(){return e(se)},children:(g,J)=>{var q=fe(),ee=h(q);{var te=K=>{pt(K,{})},Q=K=>{mt(K,{})};X(ee,K=>{oe()?K(te):K(Q,!1)})}s(g,q)},$$slots:{default:!0}})})}var w=l(_,2);p(w,()=>dt,(T,se)=>{se(T,{children:(x,O)=>{var g=Xa(),J=d(g,!0);n(g),V(()=>Y(J,oe()?"退出专注":"专注模式")),s(x,g)},$$slots:{default:!0}})}),s(M,R)},$$slots:{default:!0}})});var E=l(Z,2);{var v=b=>{var f=ss(),M=h(f);re(M,{variant:"outline",size:"sm",onclick:Se,"aria-label":"复制 YAML",title:"复制 YAML",class:"pointer-events-auto",children:(_,w)=>{Rt(_,{})},$$slots:{default:!0}});var C=l(M,2);re(C,{variant:"outline",size:"sm",onclick:ke,"aria-label":"下载 YAML",title:"下载 YAML",class:"pointer-events-auto",children:(_,w)=>{Qt(_,{})},$$slots:{default:!0}});var R=l(C,2);p(R,()=>ct,(_,w)=>{w(_,{children:(T,se)=>{var x=as(),O=h(x);{let J=N(()=>tt({variant:"outline",size:"sm"})+" pointer-events-auto");p(O,()=>nt,(q,ee)=>{ee(q,{onclick:ue,get class(){return e(J)},children:(te,Q)=>{Bt(te,{})},$$slots:{default:!0}})})}var g=l(O,2);p(g,()=>dt,(J,q)=>{q(J,{children:(ee,te)=>{var Q=ts();s(ee,Q)},$$slots:{default:!0}})}),s(T,x)},$$slots:{default:!0}})}),s(b,f)};X(E,b=>{e(o)||b(v)})}n(P);var y=l(P,2);{let b=N(()=>e(le)()),f=N(()=>Dt.current==="dark"?"yaml-dark":"yaml-light"),M=N(()=>e(W)());It(Wt(y,{get value(){return e(b)},language:"yaml",get theme(){return e(f)},get readonly(){return e(M)},height:"100%",onchange:xe}),C=>A(H,C,!0),()=>e(H))}n($),n(U),n(S),s(c,S)},Be=c=>{var S=us(),U=d(S),m=d(U);p(m,()=>ct,($,P)=>{P($,{children:(Z,E)=>{var v=ls(),y=h(v);{let f=N(()=>oe()?"退出专注":"专注模式"),M=N(()=>tt({variant:"outline",size:"sm"}));p(y,()=>nt,(C,R)=>{R(C,{get onclick(){return ie()},get"aria-label"(){return e(f)},get class(){return e(M)},children:(_,w)=>{var T=fe(),se=h(T);{var x=g=>{pt(g,{})},O=g=>{mt(g,{})};X(se,g=>{oe()?g(x):g(O,!1)})}s(_,T)},$$slots:{default:!0}})})}var b=l(y,2);p(b,()=>dt,(f,M)=>{M(f,{children:(C,R)=>{var _=os(),w=d(_,!0);n(_),V(()=>Y(w,oe()?"退出专注":"专注模式")),s(C,_)},$$slots:{default:!0}})}),s(Z,v)},$$slots:{default:!0}})}),n(U);var D=l(U,2);p(D,()=>La,($,P)=>{P($,{class:"h-full from-muted/50 from-30%",children:(Z,E)=>{var v=cs(),y=h(v);p(y,()=>ja,(f,M)=>{M(f,{children:(C,R)=>{var _=is(),w=h(_);p(w,()=>Da,(x,O)=>{O(x,{variant:"icon",children:(g,J)=>{Yt(g,{})},$$slots:{default:!0}})});var T=l(w,2);p(T,()=>Qa,(x,O)=>{O(x,{children:(g,J)=>{z();var q=L("No PoCs Yet");s(g,q)},$$slots:{default:!0}})});var se=l(T,2);p(se,()=>Ua,(x,O)=>{O(x,{children:(g,J)=>{z();var q=L('请选择左侧列表中的 PoC 查看详情，或点击"新建 PoC"创建新的 PoC');s(g,q)},$$slots:{default:!0}})}),s(C,_)},$$slots:{default:!0}})});var b=l(y,2);p(b,()=>Na,(f,M)=>{M(f,{children:(C,R)=>{var _=ds(),w=d(_);re(w,{onclick:j,children:(T,se)=>{var x=ns(),O=h(x);_t(O,{}),z(),s(T,x)},$$slots:{default:!0}}),n(_),s(C,_)},$$slots:{default:!0}})}),s(Z,v)},$$slots:{default:!0}})}),n(S),s(c,S)};X(Re,c=>{a.selectedPoc||e(o)?c(Qe):c(Be,!1)})}n(Me),s(B,Me),$e()}function gs(B,t,r){A(t,0),r()}var _s=u('<div class="mb-4 text-sm text-muted-foreground"> </div>'),ps=u('<button class="rounded bg-primary px-4 py-2 text-primary-foreground hover:bg-primary/90">重试</button>'),ms=u('<div class="flex items-center justify-center p-8"><div class="text-center"><div class="mb-2 text-destructive">数据加载失败</div> <div class="mb-4 text-sm text-muted-foreground"> </div> <!></div></div>'),hs=u('<div class="flex items-center justify-center p-8"><div class="text-center"><div class="mx-auto mb-2 h-6 w-6 animate-spin rounded-full border-2 border-primary border-t-transparent"></div> <div class="text-sm text-muted-foreground">正在加载数据...</div></div></div>'),$s=u('<div class="flex min-h-0 flex-1"><div><!></div> <div><!></div> <div><!></div></div>'),Ps=u('<div class="flex min-h-svh flex-1 flex-col"><!></div>');function As(B,t){he(t,!0);let r=ce(!1),o=ce(null),i=ce(0);const F=3;let H=ce(!1);function oe(){A(H,!e(H))}async function ie(){if($t.authenticated)try{A(o,null),await a.init(),A(r,!0),A(i,0)}catch(k){if(console.error("Failed to initialize POC data:",k),A(o,k instanceof Error?k.message:"数据加载失败",!0),k instanceof Error&&k.message.includes("401"))return;e(i)<F&&(qt(i),setTimeout(()=>{ie()},1e3*e(i)))}}ot(()=>{Ut.url.pathname==="/pocs"&&$t.authenticated&&!e(r)&&ie()});var le=Ps(),Ye=d(le);{var we=k=>{var W=ms(),ne=d(W),Se=l(d(ne),2),ke=d(Se,!0);n(Se);var ue=l(Se,2);{var I=j=>{var G=_s(),ye=d(G);n(G),V(()=>Y(ye,`正在重试... (${e(i)??""}/3)`)),s(j,G)},ae=j=>{var G=ps();G.__click=[gs,i,ie],s(j,G)};X(ue,j=>{e(i)<F?j(I):j(ae,!1)})}n(ne),n(W),V(()=>Y(ke,e(o))),s(k,W)},Pe=k=>{var W=fe(),ne=h(W);{var Se=ue=>{var I=hs();s(ue,I)},ke=ue=>{var I=$s(),ae=d(I),j=d(ae);xa(j,{}),n(ae);var G=l(ae,2),ye=d(G);Oa(ye,{}),n(G);var ze=l(G,2),xe=d(ze);fs(xe,{get focusMode(){return e(H)},onToggleFocus:oe}),n(ze),n(I),V(()=>{rt(ae,1,it(e(H)?"hidden":"hidden w-64 border-r xl:block")),rt(G,1,it(e(H)?"hidden":"min-h-0 w-[350px]")),rt(ze,1,it(e(H)?"min-h-0 min-w-0 flex-1":"hidden min-h-0 min-w-0 flex-1 border-l lg:block"))}),s(ue,I)};X(ne,ue=>{e(r)?ue(ke,!1):ue(Se)},!0)}s(k,W)};X(Ye,k=>{e(o)?k(we):k(Pe,!1)})}n(le),s(B,le),$e()}bt(["click"]);export{As as component};
