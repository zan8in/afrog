import{p as te,a as de,r as ue,g as _,v as m,aE as mt,w as Fe,x as ge,d as r,e as ae,aq as vt,aF as ht,f as u,B as Ye,C as Ie,i as c,aG as pt,A as De,j as t,k as T,aH as $t,aI as Pt,aJ as yt,a2 as ke,a9 as Be,_ as F,aK as xt,P as d,aL as bt,Q as n,n as j,a5 as R,t as J,a3 as B,an as Ue,av as Ve,aM as rt,F as le,al as ft,am as Ne,y as gt,aN as wt,aO as Ct,aP as kt,aQ as zt,c as et,aR as Mt,aS as St,aT as Ot,aU as At,u as Ge,aV as st,aW as Le,aX as Tt,aY as ot,aZ as lt,a_ as Et,aA as Lt,a$ as Ft,b0 as jt,b1 as Yt,m as It,b2 as Dt,aw as Je}from"../chunks/DV-hihCm.js";import{B as Ee}from"../chunks/6U22DVjV.js";import{c as ze,B as fe,g as Rt,b as qe}from"../chunks/CIPFYnYa.js";import{I as Qt}from"../chunks/boSQUZcc.js";import{L as it}from"../chunks/DXOkeXk4.js";import{a as Re}from"../chunks/DmjiqfOo.js";import{M as qt}from"../chunks/BzkQKSe_.js";import{R as Ke}from"../chunks/CmWy_sPc.js";import{a as nt}from"../chunks/BWtG5-W7.js";function Xe(g,e){te(e,!0);let a=de(e,"ref",15,null),l=ge(e,["$$slots","$$events","$$legacy","ref"]);var o=ue(),v=_(o);m(v,()=>mt,(f,w)=>{w(f,Fe({"data-slot":"tooltip-trigger"},()=>l,{get ref(){return a()},set ref(C){a(C)}}))}),r(g,o),ae()}var Ut=u("<div></div>"),Bt=u("<!> <!>",1);function Ze(g,e){te(e,!0);let a=de(e,"ref",15,null),l=de(e,"sideOffset",3,0),o=de(e,"side",3,"top"),v=ge(e,["$$slots","$$events","$$legacy","ref","class","sideOffset","side","children","arrowClasses"]);var f=ue(),w=_(f);m(w,()=>vt,(C,Y)=>{Y(C,{children:($e,ye)=>{var Ae=ue(),ee=_(Ae);{let Me=T(()=>ze("z-50 w-fit origin-(--bits-tooltip-content-transform-origin) animate-in rounded-md bg-primary px-3 py-1.5 text-xs text-balance text-primary-foreground fade-in-0 zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95",e.class));m(ee,()=>ht,(Se,Oe)=>{Oe(Se,Fe({"data-slot":"tooltip-content",get sideOffset(){return l()},get side(){return o()},get class(){return t(Me)}},()=>v,{get ref(){return a()},set ref(Te){a(Te)},children:(Te,Pe)=>{var xe=Bt(),be=_(xe);Ye(be,()=>e.children??Ie);var me=c(be,2);{const _e=(k,K)=>{let re=()=>K?.().props;var we=Ut();De(we,x=>({class:x,...re()}),[()=>ze("z-50 size-2.5 rotate-45 rounded-[2px] bg-primary","data-[side=top]:translate-x-1/2 data-[side=top]:translate-y-[calc(-50%_+_2px)]","data-[side=bottom]:-translate-x-1/2 data-[side=bottom]:-translate-y-[calc(-50%_+_1px)]","data-[side=right]:translate-x-[calc(50%_+_2px)] data-[side=right]:translate-y-1/2","data-[side=left]:-translate-y-[calc(50%_-_3px)]",e.arrowClasses)]),r(k,we)};m(me,()=>pt,(k,K)=>{K(k,{child:_e,$$slots:{child:!0}})})}r(Te,xe)},$$slots:{default:!0}}))})}r($e,Ae)},$$slots:{default:!0}})}),r(g,f),ae()}function dt(g,e){te(e,!0);let a=de(e,"ref",15,null),l=de(e,"open",15,!1),o=ge(e,["$$slots","$$events","$$legacy","ref","open"]);var v=ue(),f=_(v);m(f,()=>$t,(w,C)=>{C(w,Fe({"data-slot":"collapsible"},()=>o,{get ref(){return a()},set ref(Y){a(Y)},get open(){return l()},set open(Y){l(Y)}}))}),r(g,v),ae()}function ct(g,e){te(e,!0);let a=de(e,"ref",15,null),l=ge(e,["$$slots","$$events","$$legacy","ref"]);var o=ue(),v=_(o);m(v,()=>Pt,(f,w)=>{w(f,Fe({"data-slot":"collapsible-trigger"},()=>l,{get ref(){return a()},set ref(C){a(C)}}))}),r(g,o),ae()}function ut(g,e){te(e,!0);let a=de(e,"ref",15,null),l=ge(e,["$$slots","$$events","$$legacy","ref"]);var o=ue(),v=_(o);m(v,()=>yt,(f,w)=>{w(f,Fe({"data-slot":"collapsible-content"},()=>l,{get ref(){return a()},set ref(C){a(C)}}))}),r(g,o),ae()}class Vt{#e=ke(Be({source:"all",severity:[],tags:[],author:[],timeRange:"all",favorites:!1,searchQuery:""}));get filters(){return t(this.#e)}set filters(e){F(this.#e,e,!0)}#t=ke(Be([]));get pocs(){return t(this.#t)}set pocs(e){F(this.#t,e,!0)}#a=ke(Be({total:0,builtin:0,curated:0,my:0,bySeverity:{critical:0,high:0,medium:0,low:0,info:0},topTags:[],topAuthors:[]}));get stats(){return t(this.#a)}set stats(e){F(this.#a,e,!0)}#r=ke(null);get selectedPoc(){return t(this.#r)}set selectedPoc(e){F(this.#r,e,!0)}#s=ke(!1);get loading(){return t(this.#s)}set loading(e){F(this.#s,e,!0)}#o=ke(!1);get sidebarCollapsed(){return t(this.#o)}set sidebarCollapsed(e){F(this.#o,e,!0)}#l=ke(Be({page:1,pageSize:10,total:0}));get pagination(){return t(this.#l)}set pagination(e){F(this.#l,e,!0)}async loadPocs(){this.loading=!0;try{const e=new xt;this.filters.source!=="all"&&e.append("source",this.filters.source),this.filters.severity.length>0&&e.append("severity",this.filters.severity.join(",")),this.filters.tags.length>0&&e.append("tags",this.filters.tags.join(",")),this.filters.author.length>0&&e.append("author",this.filters.author.join(",")),this.filters.timeRange!=="all"&&e.append("time_range",this.filters.timeRange),this.filters.favorites&&e.append("favorites","true"),this.filters.searchQuery&&e.append("q",this.filters.searchQuery),e.append("page",this.pagination.page.toString()),e.append("page_size",this.pagination.pageSize.toString());const a=await Re.get(`/pocs?${e.toString()}`);a.success&&a.data?a.data.items?(this.pocs=a.data.items,this.pagination.total=a.data.total||0):Array.isArray(a.data)?(this.pocs=a.data,this.pagination.total=a.data.length):(this.pocs=[],this.pagination.total=0):(this.pocs=[],this.pagination.total=0)}catch(e){console.error("Failed to load POCs:",e),this.pocs=[],this.pagination.total=0}finally{this.loading=!1}}async loadStats(){try{const e=await Re.loadPocsStats();if(e.success&&e.data){const a=e.data;this.stats={total:a?.total??0,builtin:a?.by_source?.builtin??0,curated:a?.by_source?.curated??0,my:a?.by_source?.my??0,bySeverity:{critical:a?.by_severity?.critical??0,high:a?.by_severity?.high??0,medium:a?.by_severity?.medium??0,low:a?.by_severity?.low??0,info:a?.by_severity?.info??0},topTags:a?.top_tags??[],topAuthors:a?.top_authors??[]}}}catch(e){console.error("Failed to load POC stats:",e)}}async searchPocs(e){this.filters.searchQuery=e,this.pagination.page=1,await Promise.all([this.loadPocs(),this.loadStats()])}async updateFilters(e){this.filters={...this.filters,...e},this.pagination.page=1,await Promise.all([this.loadPocs(),this.loadStats()])}async selectPoc(e){if(this.selectedPoc=e,e&&!e.yaml_content){const a=e.poc_id||e.id?.toString();a?await this.loadPocContent(a):console.warn("POC has no valid ID:",e)}}async loadPocContent(e){try{const a=await Re.getPocYamlContent(e);if(a.success&&a.data&&this.selectedPoc){this.selectedPoc.yaml_content=a.data;const l=this.pocs.findIndex(o=>o.poc_id&&o.poc_id===e||o.id&&o.id.toString()===e);l!==-1&&(this.pocs[l].yaml_content=a.data)}}catch(a){console.error("Failed to load POC content:",a)}}async deletePoc(e){try{(await Re.delete(`/pocs/${e}`)).success&&(this.pocs=this.pocs.filter(l=>l.poc_id!==e),this.selectedPoc?.poc_id===e&&(this.selectedPoc=null),await this.loadStats())}catch(a){console.error("Failed to delete POC:",a)}}async syncCuratedPocs(){try{(await Re.post("/pocs/curated/sync")).success&&await Promise.all([this.loadPocs(),this.loadStats()])}catch(e){console.error("Failed to sync Curated POCs:",e)}}toggleSidebar(){this.sidebarCollapsed=!this.sidebarCollapsed}async goToPage(e){this.pagination.page=e,await Promise.all([this.loadPocs(),this.loadStats()])}async changePageSize(e){this.pagination.pageSize=e,this.pagination.page=1,await Promise.all([this.loadPocs(),this.loadStats()])}async init(){await Promise.all([this.loadPocs(),this.loadStats()])}}const s=new Vt;var Nt=u('<span class="text-sm">全部 PoCs</span> <!>',1),Gt=u('<span class="text-sm">公共 PoCs</span> <!>',1),Wt=u('<span class="text-sm">精选 PoCs</span> <!>',1),Ht=u('<span class="text-sm">我的 PoCs</span> <!>',1),Jt=u('<span class="text-sm capitalize"> </span> <!>',1),Kt=u('<div class="flex items-center gap-2"><!></div> <!>',1),Xt=u('<span class="w-full truncate text-sm"> </span> <!>',1),Zt=u('<div class="space-y-2"><!> <!> <!></div>'),ea=u('<div class="p-2 text-sm text-muted-foreground">暂无标签数据</div>'),ta=u('<div class="border-b p-4"><!> <!></div>'),aa=u('<div class="flex items-center gap-2"><!></div> <!>',1),ra=u('<span class="w-full truncate text-sm"> </span> <!>',1),sa=u('<div class="space-y-2"><!> <!> <!></div>'),oa=u('<div class="border-b p-4"><!> <!></div>'),la=u('<div class="flex h-full w-64 flex-col border-r bg-card"><div class="border-b p-4"><h2 class="text-lg font-semibold">POC 管理</h2></div> <div class="flex-1 overflow-y-auto"><div class="border-b p-4"><div class="relative"><!> <!></div></div> <div class="border-b p-4"><div class="space-y-2"><!> <!> <!> <!></div></div> <div class="border-b p-4"><div class="space-y-2"></div></div> <!> <!></div> <div class="border-t p-4"><!></div></div>');function ia(g,e){te(e,!0);let a=de(e,"stats",19,()=>s.stats);de(e,"loading",19,()=>s.loading);let l=Be({tags:!1,authors:!1});function o(x){const y=[...s.filters.severity];y.includes(x)?s.updateFilters({severity:y.filter(X=>X!==x)}):s.updateFilters({severity:[...y,x]})}function v(x){const y=[...s.filters.tags];y.includes(x)?s.updateFilters({tags:y.filter(X=>X!==x)}):s.updateFilters({tags:[...y,x]})}function f(x){const y=[...s.filters.author];y.includes(x)?s.updateFilters({author:y.filter(X=>X!==x)}):s.updateFilters({author:[...y,x]})}function w(){s.updateFilters({source:"all",severity:[],tags:[],author:[],timeRange:"all",favorites:!1,searchQuery:""})}const C=["critical","high","medium","low","info"];var Y=la(),$e=c(d(Y),2),ye=d($e),Ae=d(ye),ee=d(Ae);bt(ee,{class:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 transform text-muted-foreground"});var Me=c(ee,2);Qt(Me,{placeholder:"搜索 PoC 名称、ID、标签",class:"pl-9",onkeydown:x=>{x.key==="Enter"&&s.searchPocs(s.filters.searchQuery)},get value(){return s.filters.searchQuery},set value(x){s.filters.searchQuery=x}}),n(Ae),n(ye);var Se=c(ye,2),Oe=d(Se),Te=d(Oe);{let x=T(()=>s.filters.source==="all"?"bg-muted":"");fe(Te,{get class(){return`flex w-full items-center justify-between rounded-md p-2 text-left no-underline transition-colors hover:bg-muted ${t(x)??""}`},onclick:()=>s.updateFilters({source:"all"}),variant:"ghost",children:(y,X)=>{var ve=Nt(),ie=c(_(ve),2);Ee(ie,{variant:"secondary",children:(p,he)=>{j();var i=R();J(()=>B(i,a().total)),r(p,i)},$$slots:{default:!0}}),r(y,ve)},$$slots:{default:!0}})}var Pe=c(Te,2);{let x=T(()=>s.filters.source==="builtin"?"bg-muted":"");fe(Pe,{get class(){return`un flex w-full items-center justify-between rounded-md p-2 text-left no-underline transition-colors hover:bg-muted ${t(x)??""}`},onclick:()=>s.updateFilters({source:"builtin"}),variant:"ghost",children:(y,X)=>{var ve=Gt(),ie=c(_(ve),2);Ee(ie,{variant:"secondary",children:(p,he)=>{j();var i=R();J(()=>B(i,a().builtin)),r(p,i)},$$slots:{default:!0}}),r(y,ve)},$$slots:{default:!0}})}var xe=c(Pe,2);{let x=T(()=>s.filters.source==="curated"?"bg-muted":"");fe(xe,{get class(){return`un flex w-full items-center justify-between rounded-md p-2 text-left no-underline transition-colors hover:bg-muted ${t(x)??""}`},onclick:()=>s.updateFilters({source:"curated"}),variant:"ghost",children:(y,X)=>{var ve=Wt(),ie=c(_(ve),2);Ee(ie,{variant:"secondary",children:(p,he)=>{j();var i=R();J(()=>B(i,a().curated)),r(p,i)},$$slots:{default:!0}}),r(y,ve)},$$slots:{default:!0}})}var be=c(xe,2);{let x=T(()=>s.filters.source==="my"?"bg-muted":"");fe(be,{get class(){return`flex w-full items-center justify-between rounded-md p-2 text-left no-underline transition-colors hover:bg-muted ${t(x)??""}`},onclick:()=>s.updateFilters({source:"my"}),variant:"ghost",children:(y,X)=>{var ve=Ht(),ie=c(_(ve),2);Ee(ie,{variant:"secondary",children:(p,he)=>{j();var i=R();J(()=>B(i,a().my)),r(p,i)},$$slots:{default:!0}}),r(y,ve)},$$slots:{default:!0}})}n(Oe),n(Se);var me=c(Se,2),_e=d(me);Ue(_e,21,()=>C,Ve,(x,y)=>{{let X=T(()=>s.filters.severity.includes(t(y))?"bg-muted":"");fe(x,{get class(){return`flex w-full items-center justify-between rounded-md p-2 text-left no-underline transition-colors hover:bg-muted ${t(X)??""}`},onclick:()=>o(t(y)),variant:"ghost",children:(ve,ie)=>{var p=Jt(),he=_(p),i=d(he,!0);n(he);var b=c(he,2);Ee(b,{variant:"secondary",children:(E,h)=>{j();var $=R();J(()=>B($,a().bySeverity[t(y)])),r(E,$)},$$slots:{default:!0}}),J(()=>B(i,t(y))),r(ve,p)},$$slots:{default:!0}})}}),n(_e),n(me);var k=c(me,2);m(k,()=>dt,(x,y)=>{y(x,{open:!0,children:(X,ve)=>{var ie=ta(),p=d(ie);m(p,()=>ct,(i,b)=>{b(i,{class:"mb-3 flex w-full items-center justify-between",children:(E,h)=>{var $=Kt(),G=_($),W=d(G);it(W,{class:"font-medium",children:(D,V)=>{j();var z=R("按标签分类");r(D,z)},$$slots:{default:!0}}),n(G);var ce=c(G,2);{let D=T(()=>`h-4 w-4 transition-transform ${l.tags?"rotate-180":""}`);rt(ce,{get class(){return t(D)}})}r(E,$)},$$slots:{default:!0}})});var he=c(p,2);m(he,()=>ut,(i,b)=>{b(i,{children:(E,h)=>{var $=ue(),G=_($);{var W=D=>{var V=Zt(),z=d(V);Ue(z,17,()=>a().topTags.slice(0,l.tags?a().topTags.length:5),Ve,(O,P)=>{let N=()=>t(P).tag,I=()=>t(P).count;{let pe=T(()=>s.filters.tags.includes(N())?"bg-muted":"");fe(O,{get class(){return`flex w-full items-center justify-between rounded-md p-2 text-left no-underline transition-colors hover:bg-muted ${t(pe)??""}`},onclick:()=>v(N()),variant:"ghost",children:(q,U)=>{var A=Xt(),se=_(A),oe=d(se,!0);n(se);var H=c(se,2);Ee(H,{variant:"outline",children:(ne,Ce)=>{j();var Z=R();J(()=>B(Z,I())),r(ne,Z)},$$slots:{default:!0}}),J(()=>B(oe,N())),r(q,A)},$$slots:{default:!0}})}});var M=c(z,2);{var L=O=>{fe(O,{variant:"ghost",size:"sm",class:"w-full",onclick:()=>{l.tags=!0},children:(P,N)=>{j();var I=R();J(()=>B(I,`显示更多... (${a().topTags.length-5} 个)`)),r(P,I)},$$slots:{default:!0}})};le(M,O=>{!l.tags&&a().topTags.length>5&&O(L)})}var S=c(M,2);{var Q=O=>{fe(O,{variant:"ghost",size:"sm",class:"w-full",onclick:()=>{l.tags=!1},children:(P,N)=>{j();var I=R("收起");r(P,I)},$$slots:{default:!0}})};le(S,O=>{l.tags&&a().topTags.length>5&&O(Q)})}n(V),r(D,V)},ce=D=>{var V=ea();r(D,V)};le(G,D=>{a().topTags.length>0?D(W):D(ce,!1)})}r(E,$)},$$slots:{default:!0}})}),n(ie),r(X,ie)},$$slots:{default:!0}})});var K=c(k,2);m(K,()=>dt,(x,y)=>{y(x,{open:!0,children:(X,ve)=>{var ie=oa(),p=d(ie);m(p,()=>ct,(i,b)=>{b(i,{class:"mb-3 flex w-full items-center justify-between",children:(E,h)=>{var $=aa(),G=_($),W=d(G);it(W,{class:"font-medium",children:(D,V)=>{j();var z=R("按作者分类");r(D,z)},$$slots:{default:!0}}),n(G);var ce=c(G,2);{let D=T(()=>`h-4 w-4 transition-transform ${l.authors?"rotate-180":""}`);rt(ce,{get class(){return t(D)}})}r(E,$)},$$slots:{default:!0}})});var he=c(p,2);m(he,()=>ut,(i,b)=>{b(i,{children:(E,h)=>{var $=sa(),G=d($);Ue(G,17,()=>a().topAuthors.slice(0,l.authors?a().topAuthors.length:5),Ve,(z,M)=>{let L=()=>t(M).author,S=()=>t(M).count;{let Q=T(()=>s.filters.author.includes(L())?"bg-muted":"");fe(z,{get class(){return`flex w-full items-center justify-between rounded-md p-2 text-left no-underline transition-colors hover:bg-muted ${t(Q)??""}`},onclick:()=>f(L()),variant:"ghost",children:(O,P)=>{var N=ra(),I=_(N),pe=d(I,!0);n(I);var q=c(I,2);Ee(q,{variant:"outline",children:(U,A)=>{j();var se=R();J(()=>B(se,S())),r(U,se)},$$slots:{default:!0}}),J(()=>B(pe,L())),r(O,N)},$$slots:{default:!0}})}});var W=c(G,2);{var ce=z=>{fe(z,{variant:"ghost",size:"sm",class:"w-full",onclick:()=>l.authors=!0,children:(M,L)=>{j();var S=R();J(()=>B(S,`显示更多... (${a().topAuthors.length-5} 个)`)),r(M,S)},$$slots:{default:!0}})};le(W,z=>{!l.authors&&a().topAuthors.length>5&&z(ce)})}var D=c(W,2);{var V=z=>{fe(z,{variant:"ghost",size:"sm",class:"w-full",onclick:()=>l.authors=!1,children:(M,L)=>{j();var S=R("收起");r(M,S)},$$slots:{default:!0}})};le(D,z=>{l.authors&&a().topAuthors.length>5&&z(V)})}n($),r(E,$)},$$slots:{default:!0}})}),n(ie),r(X,ie)},$$slots:{default:!0}})}),n($e);var re=c($e,2),we=d(re);fe(we,{variant:"outline",size:"sm",class:"w-full",onclick:w,children:(x,y)=>{j();var X=R("清空筛选");r(x,X)},$$slots:{default:!0}}),n(re),n(Y),r(g,Y),ae()}var na=u('<div class="flex h-32 items-center justify-center"><div class="text-muted-foreground">加载中...</div></div>'),da=u('<div class="flex h-32 items-center justify-center"><div class="text-muted-foreground"></div></div>'),ca=(g,e,a)=>e(t(a)),ua=u("<!> <!>",1),va=u("<!> <!>",1),fa=u('<div class="mt-2 flex flex-wrap gap-1"><!></div>'),ga=u('<button type="button"><div class="min-w-0 flex-1"><div class="mb-1 flex items-center justify-between"><div class="flex items-center gap-2"><span class="max-w-[100px] truncate text-xs text-muted-foreground"> </span> <!></div> <div class="flex items-center gap-2 text-xs text-muted-foreground"><span> </span></div></div> <div class="font-sm mb-1 truncate text-foreground"> </div> <div class="line-clamp-2 text-sm leading-relaxed text-muted-foreground svelte-1b0ih1q"> </div> <!></div></button>'),_a=u('<div class="flex h-full flex-col bg-background"><div class="flex items-center justify-between border-b p-4"><div class="flex items-center gap-2"><h1 class="text-lg font-semibold">POC 列表</h1> <!></div></div> <div class="flex-1 overflow-auto"><!></div> <div class="flex items-center justify-between border-t p-3"><div class="text-sm text-muted-foreground"> </div> <div class="flex items-center gap-2"><!> <!></div></div></div>');function ma(g,e){te(e,!0);let a="",l=ke(null),o=T(()=>{if(!s.pocs)return[];let k=s.pocs;if(a.trim()){const K=a.toLowerCase();k=k.filter(re=>re.name.toLowerCase().includes(K)||re.author&&typeof re.author=="string"&&re.author.toLowerCase().includes(K)||re.description.toLowerCase().includes(K)||re.tags&&typeof re.tags=="string"&&re.tags.toLowerCase().includes(K))}return k});function v(){s.pagination.page>1&&s.goToPage(s.pagination.page-1)}function f(){const k=Math.max(1,Math.ceil(s.pagination.total/s.pagination.pageSize));s.pagination.page<k&&s.goToPage(s.pagination.page+1)}async function w(k){F(l,k,!0),await s.selectPoc(k)}var C=_a(),Y=d(C),$e=d(Y),ye=c(d($e),2);{var Ae=k=>{Ee(k,{variant:"secondary",class:"ml-2",children:(K,re)=>{j();var we=R();J(()=>B(we,s.pagination.total)),r(K,we)},$$slots:{default:!0}})};le(ye,k=>{s.pagination.total&&k(Ae)})}n($e),n(Y);var ee=c(Y,2),Me=d(ee);{var Se=k=>{var K=na();r(k,K)},Oe=k=>{var K=ue(),re=_(K);{var we=y=>{var X=da(),ve=d(X);ve.textContent="暂无 POC 数据",n(X),r(y,X)},x=y=>{var X=ue(),ve=_(X);Ue(ve,19,()=>t(o),(ie,p)=>ie.poc_id||ie.id||p,(ie,p)=>{var he=ga();he.__click=[ca,w,p];var i=d(he),b=d(i),E=d(b),h=d(E),$=d(h,!0);n(h);var G=c(h,2);{let O=T(()=>`${Rt(t(p).severity)} lowercase`);Ee(G,{variant:"secondary",get class(){return t(O)},children:(P,N)=>{j();var I=R();J(()=>B(I,t(p).severity)),r(P,I)},$$slots:{default:!0}})}n(E);var W=c(E,2),ce=d(W),D=d(ce,!0);n(ce),n(W),n(b);var V=c(b,2),z=d(V,!0);n(V);var M=c(V,2),L=d(M,!0);n(M);var S=c(M,2);{var Q=O=>{var P=fa(),N=d(P);{var I=q=>{var U=ua(),A=_(U);Ue(A,17,()=>t(p).tags.split(",").slice(0,4),Ve,(H,ne)=>{Ee(H,{variant:"outline",class:"px-1.5 py-0.5 text-xs",children:(Ce,Z)=>{j();var je=R();J(Qe=>B(je,Qe),[()=>t(ne).trim()]),r(Ce,je)},$$slots:{default:!0}})});var se=c(A,2);{var oe=H=>{Ee(H,{variant:"outline",class:"px-1.5 py-0.5 text-xs",children:(ne,Ce)=>{j();var Z=R();J(je=>B(Z,`+${je??""}`),[()=>t(p).tags.split(",").length-4]),r(ne,Z)},$$slots:{default:!0}})};le(se,H=>{t(p).tags.split(",").length>4&&H(oe)})}r(q,U)},pe=q=>{var U=ue(),A=_(U);{var se=H=>{var ne=va(),Ce=_(ne);Ue(Ce,17,()=>t(p).tags.slice(0,4),Ve,(Qe,We)=>{Ee(Qe,{variant:"outline",class:"px-1.5 py-0.5 text-xs",children:(tt,He)=>{j();var at=R();J(_t=>B(at,_t),[()=>String(t(We))]),r(tt,at)},$$slots:{default:!0}})});var Z=c(Ce,2);{var je=Qe=>{Ee(Qe,{variant:"outline",class:"px-1.5 py-0.5 text-xs",children:(We,tt)=>{j();var He=R();J(()=>B(He,`+${t(p).tags.length-4}`)),r(We,He)},$$slots:{default:!0}})};le(Z,Qe=>{t(p).tags.length>4&&Qe(je)})}r(H,ne)},oe=H=>{Ee(H,{variant:"outline",class:"px-1.5 py-0.5 text-xs",children:(ne,Ce)=>{j();var Z=R();J(je=>B(Z,je),[()=>String(t(p).tags)]),r(ne,Z)},$$slots:{default:!0}})};le(A,H=>{Array.isArray(t(p).tags)&&t(p).tags.length>0?H(se):H(oe,!1)},!0)}r(q,U)};le(N,q=>{typeof t(p).tags=="string"?q(I):q(pe,!1)})}n(P),r(O,P)};le(S,O=>{t(p).tags&&O(Q)})}n(i),n(he),J(O=>{Ne(he,1,O,"svelte-1b0ih1q"),B($,t(p).author),B(D,t(p).created),B(z,t(p).name),B(L,t(p).id||"暂无ID")},[()=>`flex w-full cursor-pointer items-start gap-4 border-b p-4 text-left transition-colors hover:bg-muted/50 ${(s.selectedPoc?.poc_id??s.selectedPoc?.id?.toString())===(t(p).poc_id??t(p).id?.toString())?"bg-muted/50":""}`]),r(ie,he)}),r(y,X)};le(re,y=>{!t(o)||t(o).length===0?y(we):y(x,!1)},!0)}r(k,K)};le(Me,k=>{s.loading?k(Se):k(Oe,!1)})}n(ee);var Te=c(ee,2),Pe=d(Te),xe=d(Pe);n(Pe);var be=c(Pe,2),me=d(be);{let k=T(()=>s.pagination.page<=1);fe(me,{variant:"outline",size:"sm",onclick:v,get disabled(){return t(k)},children:(K,re)=>{j();var we=R("上一页");r(K,we)},$$slots:{default:!0}})}var _e=c(me,2);{let k=T(()=>s.pagination.page>=Math.max(1,Math.ceil(s.pagination.total/s.pagination.pageSize)));fe(_e,{variant:"outline",size:"sm",onclick:f,get disabled(){return t(k)},children:(K,re)=>{j();var we=R("下一页");r(K,we)},$$slots:{default:!0}})}n(be),n(Te),n(C),J(()=>B(xe,`第 ${s.pagination.page??""} 页，共 ${s.pagination.total??""} 条`)),r(g,C),ae()}ft(["click"]);const ha=gt({base:"flex w-fit items-stretch has-[>[data-slot=button-group]]:gap-2 [&>*]:focus-visible:relative [&>*]:focus-visible:z-10 has-[select[aria-hidden=true]:last-child]:[&>[data-slot=select-trigger]:last-of-type]:rounded-r-md [&>[data-slot=select-trigger]:not([class*='w-'])]:w-fit [&>input]:flex-1",variants:{orientation:{horizontal:"[&>*:not(:first-child)]:rounded-l-none [&>*:not(:first-child)]:border-l-0 [&>*:not(:last-child)]:rounded-r-none",vertical:"flex-col [&>*:not(:first-child)]:rounded-t-none [&>*:not(:first-child)]:border-t-0 [&>*:not(:last-child)]:rounded-b-none"}},defaultVariants:{orientation:"horizontal"}});var pa=u("<div><!></div>");function $a(g,e){te(e,!0);let a=de(e,"orientation",3,"horizontal"),l=ge(e,["$$slots","$$events","$$legacy","class","children","orientation"]);var o=pa();De(o,f=>({role:"group","data-slot":"button-group","data-orientation":a(),class:f,...l}),[()=>ze(ha({orientation:a()}),e.class)]);var v=d(o);Ye(v,()=>e.children??Ie),n(o),r(g,o),ae()}function Pa(g,e){te(e,!0);let a=de(e,"ref",15,null),l=ge(e,["$$slots","$$events","$$legacy","ref"]);var o=ue(),v=_(o);m(v,()=>wt,(f,w)=>{w(f,Fe({"data-slot":"alert-dialog-trigger"},()=>l,{get ref(){return a()},set ref(C){a(C)}}))}),r(g,o),ae()}function ya(g,e){te(e,!0);let a=de(e,"ref",15,null),l=ge(e,["$$slots","$$events","$$legacy","ref","class"]);var o=ue(),v=_(o);{let f=T(()=>ze("text-lg font-semibold",e.class));m(v,()=>Ct,(w,C)=>{C(w,Fe({"data-slot":"alert-dialog-title",get class(){return t(f)}},()=>l,{get ref(){return a()},set ref(Y){a(Y)}}))})}r(g,o),ae()}function xa(g,e){te(e,!0);let a=de(e,"ref",15,null),l=ge(e,["$$slots","$$events","$$legacy","ref","class"]);var o=ue(),v=_(o);{let f=T(()=>ze(qe(),e.class));m(v,()=>kt,(w,C)=>{C(w,Fe({"data-slot":"alert-dialog-action",get class(){return t(f)}},()=>l,{get ref(){return a()},set ref(Y){a(Y)}}))})}r(g,o),ae()}function ba(g,e){te(e,!0);let a=de(e,"ref",15,null),l=ge(e,["$$slots","$$events","$$legacy","ref","class"]);var o=ue(),v=_(o);{let f=T(()=>ze(qe({variant:"outline"}),e.class));m(v,()=>zt,(w,C)=>{C(w,Fe({"data-slot":"alert-dialog-cancel",get class(){return t(f)}},()=>l,{get ref(){return a()},set ref(Y){a(Y)}}))})}r(g,o),ae()}var wa=u("<div><!></div>");function Ca(g,e){te(e,!0);let a=de(e,"ref",15,null),l=ge(e,["$$slots","$$events","$$legacy","ref","class","children"]);var o=wa();De(o,f=>({"data-slot":"alert-dialog-footer",class:f,...l}),[()=>ze("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e.class)]);var v=d(o);Ye(v,()=>e.children??Ie),n(o),et(o,f=>a(f),()=>a()),r(g,o),ae()}var ka=u("<div><!></div>");function za(g,e){te(e,!0);let a=de(e,"ref",15,null),l=ge(e,["$$slots","$$events","$$legacy","ref","class","children"]);var o=ka();De(o,f=>({"data-slot":"alert-dialog-header",class:f,...l}),[()=>ze("flex flex-col gap-2 text-center sm:text-left",e.class)]);var v=d(o);Ye(v,()=>e.children??Ie),n(o),et(o,f=>a(f),()=>a()),r(g,o),ae()}function Ma(g,e){te(e,!0);let a=de(e,"ref",15,null),l=ge(e,["$$slots","$$events","$$legacy","ref","class"]);var o=ue(),v=_(o);{let f=T(()=>ze("fixed inset-0 z-50 bg-black/50 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:animate-in data-[state=open]:fade-in-0",e.class));m(v,()=>Mt,(w,C)=>{C(w,Fe({"data-slot":"alert-dialog-overlay",get class(){return t(f)}},()=>l,{get ref(){return a()},set ref(Y){a(Y)}}))})}r(g,o),ae()}var Sa=u("<!> <!>",1);function Oa(g,e){te(e,!0);let a=de(e,"ref",15,null),l=ge(e,["$$slots","$$events","$$legacy","ref","class","portalProps"]);var o=ue(),v=_(o);m(v,()=>vt,(f,w)=>{w(f,Fe(()=>e.portalProps,{children:(C,Y)=>{var $e=Sa(),ye=_($e);Ma(ye,{});var Ae=c(ye,2);{let ee=T(()=>ze("fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border bg-background p-6 shadow-lg duration-200 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-95 sm:max-w-lg",e.class));m(Ae,()=>St,(Me,Se)=>{Se(Me,Fe({"data-slot":"alert-dialog-content",get class(){return t(ee)}},()=>l,{get ref(){return a()},set ref(Oe){a(Oe)}}))})}r(C,$e)},$$slots:{default:!0}}))}),r(g,o),ae()}function Aa(g,e){te(e,!0);let a=de(e,"ref",15,null),l=ge(e,["$$slots","$$events","$$legacy","ref","class"]);var o=ue(),v=_(o);{let f=T(()=>ze("text-sm text-muted-foreground",e.class));m(v,()=>Ot,(w,C)=>{C(w,Fe({"data-slot":"alert-dialog-description",get class(){return t(f)}},()=>l,{get ref(){return a()},set ref(Y){a(Y)}}))})}r(g,o),ae()}const Ta=At;var Ea=u("<div><!></div>");function La(g,e){te(e,!0);let a=ge(e,["$$slots","$$events","$$legacy","class","children"]);var l=Ea();De(l,v=>({"data-slot":"empty",class:v,...a}),[()=>ze("flex min-w-0 flex-1 flex-col items-center justify-center gap-6 rounded-lg border-dashed p-6 text-center text-balance md:p-12",e.class)]);var o=d(l);Ye(o,()=>e.children??Ie),n(l),r(g,l),ae()}var Fa=u("<div><!></div>");function ja(g,e){te(e,!0);let a=ge(e,["$$slots","$$events","$$legacy","class","children"]);var l=Fa();De(l,v=>({"data-slot":"empty-header",class:v,...a}),[()=>ze("flex max-w-sm flex-col items-center gap-2 text-center",e.class)]);var o=d(l);Ye(o,()=>e.children??Ie),n(l),r(g,l),ae()}const Ya=gt({base:"mb-2 flex shrink-0 items-center justify-center [&_svg]:pointer-events-none [&_svg]:shrink-0",variants:{variant:{default:"bg-transparent",icon:"bg-muted text-foreground flex size-10 shrink-0 items-center justify-center rounded-lg [&_svg:not([class*='size-'])]:size-6"}},defaultVariants:{variant:"default"}});var Ia=u("<div><!></div>");function Da(g,e){te(e,!0);let a=de(e,"variant",3,"default"),l=ge(e,["$$slots","$$events","$$legacy","class","children","variant"]);var o=Ia();De(o,f=>({"data-slot":"empty-icon","data-variant":a(),class:f,...l}),[()=>ze(Ya({variant:a()}),e.class)]);var v=d(o);Ye(v,()=>e.children??Ie),n(o),r(g,o),ae()}var Ra=u("<div><!></div>");function Qa(g,e){te(e,!0);let a=ge(e,["$$slots","$$events","$$legacy","class","children"]);var l=Ra();De(l,v=>({"data-slot":"empty-title",class:v,...a}),[()=>ze("text-lg font-medium tracking-tight",e.class)]);var o=d(l);Ye(o,()=>e.children??Ie),n(l),r(g,l),ae()}var qa=u("<div><!></div>");function Ua(g,e){te(e,!0);let a=ge(e,["$$slots","$$events","$$legacy","class","children"]);var l=qa();De(l,v=>({"data-slot":"empty-description",class:v,...a}),[()=>ze("text-sm/relaxed text-muted-foreground [&>a]:underline [&>a]:underline-offset-4 [&>a:hover]:text-primary",e.class)]);var o=d(l);Ye(o,()=>e.children??Ie),n(l),r(g,l),ae()}var Ba=u("<div><!></div>");function Va(g,e){te(e,!0);let a=ge(e,["$$slots","$$events","$$legacy","class","children"]);var l=Ba();De(l,v=>({"data-slot":"empty-content",class:v,...a}),[()=>ze("flex w-full max-w-sm min-w-0 flex-col items-center gap-4 text-sm text-balance",e.class)]);var o=d(l);Ye(o,()=>e.children??Ie),n(l),r(g,l),ae()}var Na=u("<!> <!>",1),Ga=u("<!>新建 PoC",1),Wa=u("<!> <!>",1),Ha=u("<!> <!>",1),Ja=u("<!> <!>",1),Ka=u("<!> <!>",1),Xa=u("<!> <!>",1),Za=u("<p> </p>"),er=u("<!> <!>",1),tr=u("<p>提交漏洞 PoC 至 afrog 社区</p>"),ar=u("<!> <!>",1),rr=u("<!> <!> <!>",1),sr=u('<div class="flex h-full flex-col"><div class="flex min-h-0 min-w-0 flex-1 flex-col gap-3 overflow-hidden p-4"><!> <div class="relative min-h-0 flex-1 overflow-hidden"><div class="pointer-events-none absolute top-2 right-2 z-10 flex items-center gap-2"><!> <!></div> <!></div></div></div>'),or=u("<p> </p>"),lr=u("<!> <!>",1),ir=u("<!> <!> <!>",1),nr=u("<!> 新建 PoC",1),dr=u('<div class="flex gap-2"><!></div>'),cr=u("<!> <!>",1),ur=u('<div class="relative mt-6"><div class="absolute top-2 right-2 z-10"><!></div> <!></div>'),vr=u('<div class="flex h-full flex-col"><div class="flex max-h-[3.8rem] items-center justify-between border-b p-4"><h3 class="text-lg font-semibold">POC 详情</h3> <div class="flex items-center gap-2"><!> <!></div></div> <!></div>');function fr(g,e){te(e,!0);let a=ke(!1),l=ke(!1),o=ke(""),v=ke(!1),f=ke(null),w=de(e,"focusMode",3,!1),C=de(e,"onToggleFocus",3,()=>{}),Y=T(()=>()=>t(a)||t(l)?t(o):s.selectedPoc?.yaml_content||"");Ge(()=>{console.log("displayYamlContent changed:",{editMode:t(a),isCreating:t(l),yamlContentLength:t(o).length,selectedPocId:s.selectedPoc?.poc_id||s.selectedPoc?.id,selectedPocYamlLength:s.selectedPoc?.yaml_content?.length||0,finalContentLength:t(Y)().length,selectedPocYamlPreview:s.selectedPoc?.yaml_content?.substring(0,100)||"empty"})}),Ge(()=>{if(console.log("selectedPoc effect triggered:",{selectedPocId:s.selectedPoc?.poc_id||s.selectedPoc?.id,editMode:t(a),isCreating:t(l),hasYamlContent:!!s.selectedPoc?.yaml_content,pocType:t($e)(),canEdit:t(ye)(),canDelete:t(Ae)(),filePath:s.selectedPoc?.file_path,isCurated:s.selectedPoc?.is_curated}),s.selectedPoc&&!t(a)&&!t(l)){if(console.log("Clearing yamlContent for new POC selection"),F(o,""),!s.selectedPoc.yaml_content){const i=s.selectedPoc.poc_id||s.selectedPoc.id?.toString();i&&(console.log("Loading YAML content for POC:",i),s.loadPocContent(i))}}else!s.selectedPoc&&!t(l)&&(console.log("No POC selected, clearing yamlContent"),F(o,""))});let $e=T(()=>()=>s.selectedPoc?(console.log("POC Type Debug:",{poc_id:s.selectedPoc.poc_id,file_path:s.selectedPoc.file_path,is_curated:s.selectedPoc.is_curated,source:s.filters?.source}),s.selectedPoc.file_path&&s.selectedPoc.file_path.includes("/my/")?"my":s.selectedPoc.is_curated===!0?"curated":s.filters?.source==="my"||s.selectedPoc.poc_id&&(s.selectedPoc.poc_id.includes("custom-")||s.selectedPoc.poc_id.includes("user-")||s.selectedPoc.poc_id.includes("my-"))?"my":"builtin"):"unknown"),ye=T(()=>()=>t($e)()==="my"),Ae=T(()=>()=>t($e)()==="my"),ee=T(()=>()=>{const i=!t(a)&&!t(l);return console.log("isReadOnly calculated:",{editMode:t(a),isCreating:t(l),readonly:i,pocType:t($e)(),canEdit:t(ye)()}),i});const Me=`id: new-poc

info:
  name: 新建 POC
  author: your-name
  severity: high
  description: |-
    描述
  tags: tag1,tag2
  created: ${new Date().toISOString().split("T")[0].replace(/-/g,"/")}

set:
  hostname: request.url.host
rules:
  r0:
    request:
      method: GET
      path: /login.html
    expression: response.status == 200 && response.body.bcontains(b'login')
expression: r0()`;function Se(){const i=t(Y)();i&&(navigator.clipboard?.writeText(i),Le.success("YAML 内容已复制到剪贴板"))}function Oe(){try{const i=t(Y)();if(!i||!i.trim()){Le.error("暂无可下载的 YAML 内容");return}const b=s.selectedPoc?.poc_id||s.selectedPoc?.id||"poc",h=`${String(b).trim().replace(/[^\w.-]+/g,"_")}.yaml`,$=new Blob([i],{type:"text/yaml;charset=utf-8"}),G=URL.createObjectURL($),W=document.createElement("a");W.href=G,W.download=h,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(G),Le.success(`已下载: ${h}`)}catch(i){console.error("下载失败:",i),Le.error("下载失败，请稍后重试")}}function Te(){Le.info("功能尚未完成")}function Pe(){console.log("startEdit called:",{canEdit:t(ye)(),currentEditMode:t(a),selectedPoc:!!s.selectedPoc}),t(ye)()&&(F(a,!0),F(o,s.selectedPoc?.yaml_content||"",!0),console.log("startEdit completed:",{editMode:t(a),yamlContentLength:t(o).length}),setTimeout(()=>{if(t(f)&&t(f).focus)t(f).focus(),console.log("Monaco Editor focused via component method");else{const i=document.querySelector(".monaco-editor textarea");i&&(i.focus(),console.log("Monaco Editor focused via DOM element"))}},200))}function xe(){console.log("cancelEdit called:",{currentEditMode:t(a),currentIsCreating:t(l),yamlContentLength:t(o).length}),F(a,!1),F(l,!1),F(o,""),console.log("cancelEdit completed:",{editMode:t(a),isCreating:t(l),yamlContent:t(o).length}),setTimeout(()=>{console.log("Force update Monaco Editor after cancel")},100)}function be(){F(l,!0),F(a,!1),F(o,Me),s.selectedPoc=null}async function me(){if(console.log("savePoc called:",{yamlContentLength:t(o).length,isCreating:t(l),editMode:t(a),selectedPocId:s.selectedPoc?.poc_id}),!t(o).trim()){Le.error("YAML 内容不能为空");return}if(!k(t(o))){Le.error("YAML 格式不正确，请检查语法");return}const i=t(a),b=t(l),E=t(o);F(v,!0);try{let h;if(t(l))console.log("Creating new POC"),h=await Re.createPoc({yaml_content:t(o)}),console.log("Create POC result:",h),Le.success("POC 创建成功"),F(l,!1);else if(t(a)&&s.selectedPoc){console.log("Updating existing POC:",{poc_id:s.selectedPoc.poc_id,id:s.selectedPoc.id,name:s.selectedPoc.name});const $=s.selectedPoc.poc_id||s.selectedPoc.id?.toString();if(!$)throw new Error("POC ID 不存在，无法更新");h=await Re.updatePoc($,{yaml_content:t(o)}),console.log("Update POC result:",h),Le.success("POC 更新成功"),F(a,!1),s.selectedPoc&&(s.selectedPoc.yaml_content=t(o)),h.success&&h.data&&(s.selectedPoc=h.data)}if(h&&!h.success)throw new Error(h.message||"保存失败");console.log("Clearing yamlContent after save"),F(o,""),console.log("Reloading POCs"),await s.loadPocs(),console.log("savePoc completed:",{editMode:t(a),isCreating:t(l),yamlContentLength:t(o).length})}catch(h){console.error("保存失败:",h),F(a,i,!0),F(l,b,!0),F(o,E,!0),console.log("State rolled back due to error:",{editMode:t(a),isCreating:t(l),yamlContent:t(o).slice(0,50)+"..."});let $="保存失败，请重试";h instanceof Error&&(h.name==="ApiError"||h.message.includes("HTTP")?$=`API错误: ${h.message}`:h.message.includes("网络错误")||h.message.includes("fetch")?$="网络连接失败，请检查网络后重试":h.message.includes("登录过期")||h.message.includes("401")?$="登录已过期，请重新登录":h.message.includes("权限")?$="权限不足，无法执行此操作":$=`保存失败: ${h.message}`),Le.error($)}finally{F(v,!1)}}async function _e(){if(!s.selectedPoc||!t(Ae)())return;const i=s.selectedPoc.poc_id||s.selectedPoc.id?.toString();if(!i){console.error("Delete POC failed: No valid POC ID found",{poc_id:s.selectedPoc.poc_id,id:s.selectedPoc.id,selectedPoc:s.selectedPoc}),Le.error("删除失败: POC ID 无效");return}console.log("Deleting POC:",{pocId:i,poc_id:s.selectedPoc.poc_id,id:s.selectedPoc.id,name:s.selectedPoc.name});try{await Re.deletePoc(i),Le.success("POC 删除成功"),s.selectedPoc=null,await s.loadPocs()}catch(b){const E=b instanceof Error?b.message:"未知错误";Le.error(`删除失败: ${E}`)}}function k(i){try{const b=i.split(`
`);let E=!1,h=!1;for(const $ of b)$.trim().startsWith("id:")&&(E=!0),$.trim().startsWith("info:")&&(h=!0);return E&&h}catch{return!1}}function K(i){F(o,i,!0)}Ge(()=>{const i=w();if(t(f)?.getEditor){const b=t(f).getEditor();b&&setTimeout(()=>{try{b.layout(),console.log("Monaco Editor layout recalculated due to focusMode:",i)}catch(E){console.warn("Failed to layout editor on focusMode change",E)}},50)}});var re=vr(),we=d(re),x=c(d(we),2),y=d(x);m(y,()=>$a,(i,b)=>{b(i,{children:(E,h)=>{var $=ue(),G=_($);{var W=D=>{var V=Na(),z=_(V);fe(z,{variant:"outline",size:"sm",onclick:xe,get disabled(){return t(v)},children:(L,S)=>{j();var Q=R("取消");r(L,Q)},$$slots:{default:!0}});var M=c(z,2);fe(M,{size:"sm",onclick:me,get disabled(){return t(v)},children:(L,S)=>{j();var Q=R();J(()=>B(Q,t(v)?"保存中...":"保存")),r(L,Q)},$$slots:{default:!0}}),r(D,V)},ce=D=>{var V=Wa(),z=_(V);fe(z,{size:"sm",onclick:be,children:(S,Q)=>{var O=Ga(),P=_(O);st(P,{}),j(),r(S,O)},$$slots:{default:!0}});var M=c(z,2);{var L=S=>{fe(S,{variant:"outline",size:"sm",onclick:Pe,children:(Q,O)=>{j();var P=R("编辑");r(Q,P)},$$slots:{default:!0}})};le(M,S=>{s.selectedPoc&&t(ye)()&&S(L)})}r(D,V)};le(G,D=>{t(l)||t(a)?D(W):D(ce,!1)})}r(E,$)},$$slots:{default:!0}})});var X=c(y,2);{var ve=i=>{var b=ue(),E=_(b);m(E,()=>Ta,(h,$)=>{$(h,{children:(G,W)=>{var ce=Xa(),D=_(ce);{let z=T(()=>qe({variant:"destructive",size:"sm"}));m(D,()=>Pa,(M,L)=>{L(M,{get class(){return t(z)},children:(S,Q)=>{Tt(S,{})},$$slots:{default:!0}})})}var V=c(D,2);m(V,()=>Oa,(z,M)=>{M(z,{children:(L,S)=>{var Q=Ka(),O=_(Q);m(O,()=>za,(N,I)=>{I(N,{children:(pe,q)=>{var U=Ha(),A=_(U);m(A,()=>ya,(oe,H)=>{H(oe,{children:(ne,Ce)=>{j();var Z=R("确认删除 PoC?");r(ne,Z)},$$slots:{default:!0}})});var se=c(A,2);m(se,()=>Aa,(oe,H)=>{H(oe,{children:(ne,Ce)=>{j();var Z=R();J(()=>B(Z,`确定要删除 POC "${s.selectedPoc?.name??""}" 吗？此操作不可撤销。`)),r(ne,Z)},$$slots:{default:!0}})}),r(pe,U)},$$slots:{default:!0}})});var P=c(O,2);m(P,()=>Ca,(N,I)=>{I(N,{children:(pe,q)=>{var U=Ja(),A=_(U);m(A,()=>ba,(oe,H)=>{H(oe,{children:(ne,Ce)=>{j();var Z=R("取消");r(ne,Z)},$$slots:{default:!0}})});var se=c(A,2);{let oe=T(()=>qe({variant:"destructive"}));m(se,()=>xa,(H,ne)=>{ne(H,{get class(){return t(oe)},onclick:_e,children:(Ce,Z)=>{j();var je=R("确认删除");r(Ce,je)},$$slots:{default:!0}})})}r(pe,U)},$$slots:{default:!0}})}),r(L,Q)},$$slots:{default:!0}})}),r(G,ce)},$$slots:{default:!0}})}),r(i,b)};le(X,i=>{s.selectedPoc&&t(Ae)()&&i(ve)})}n(x),n(we);var ie=c(we,2);{var p=i=>{var b=sr(),E=d(b),h=d(E);{var $=M=>{};le(h,M=>{s.selectedPoc&&M($)})}var G=c(h,2),W=d(G),ce=d(W);m(ce,()=>Ke,(M,L)=>{L(M,{children:(S,Q)=>{var O=er(),P=_(O);{let I=T(()=>w()?"退出专注":"专注模式"),pe=T(()=>qe({variant:"outline",size:"sm"})+" pointer-events-auto");m(P,()=>Xe,(q,U)=>{U(q,{get onclick(){return C()},get"aria-label"(){return t(I)},get class(){return t(pe)},children:(A,se)=>{var oe=ue(),H=_(oe);{var ne=Z=>{ot(Z,{})},Ce=Z=>{lt(Z,{})};le(H,Z=>{w()?Z(ne):Z(Ce,!1)})}r(A,oe)},$$slots:{default:!0}})})}var N=c(P,2);m(N,()=>Ze,(I,pe)=>{pe(I,{children:(q,U)=>{var A=Za(),se=d(A,!0);n(A),J(()=>B(se,w()?"退出专注":"专注模式")),r(q,A)},$$slots:{default:!0}})}),r(S,O)},$$slots:{default:!0}})});var D=c(ce,2);{var V=M=>{var L=rr(),S=_(L);fe(S,{variant:"outline",size:"sm",onclick:Se,"aria-label":"复制 YAML",title:"复制 YAML",class:"pointer-events-auto",children:(P,N)=>{Ft(P,{})},$$slots:{default:!0}});var Q=c(S,2);fe(Q,{variant:"outline",size:"sm",onclick:Oe,"aria-label":"下载 YAML",title:"下载 YAML",class:"pointer-events-auto",children:(P,N)=>{jt(P,{})},$$slots:{default:!0}});var O=c(Q,2);m(O,()=>Ke,(P,N)=>{N(P,{children:(I,pe)=>{var q=ar(),U=_(q);{let se=T(()=>qe({variant:"outline",size:"sm"})+" pointer-events-auto");m(U,()=>Xe,(oe,H)=>{H(oe,{onclick:Te,get class(){return t(se)},children:(ne,Ce)=>{Yt(ne,{})},$$slots:{default:!0}})})}var A=c(U,2);m(A,()=>Ze,(se,oe)=>{oe(se,{children:(H,ne)=>{var Ce=tr();r(H,Ce)},$$slots:{default:!0}})}),r(I,q)},$$slots:{default:!0}})}),r(M,L)};le(D,M=>{t(l)||M(V)})}n(W);var z=c(W,2);{let M=T(()=>t(Y)()),L=T(()=>Lt.current==="dark"?"yaml-dark":"yaml-light"),S=T(()=>t(ee)());et(qt(z,{get value(){return t(M)},language:"yaml",get theme(){return t(L)},get readonly(){return t(S)},height:"100%",onchange:K}),Q=>F(f,Q,!0),()=>t(f))}n(G),n(E),n(b),r(i,b)},he=i=>{var b=ur(),E=d(b),h=d(E);m(h,()=>Ke,(G,W)=>{W(G,{children:(ce,D)=>{var V=lr(),z=_(V);{let L=T(()=>w()?"退出专注":"专注模式"),S=T(()=>qe({variant:"outline",size:"sm"}));m(z,()=>Xe,(Q,O)=>{O(Q,{get onclick(){return C()},get"aria-label"(){return t(L)},get class(){return t(S)},children:(P,N)=>{var I=ue(),pe=_(I);{var q=A=>{ot(A,{})},U=A=>{lt(A,{})};le(pe,A=>{w()?A(q):A(U,!1)})}r(P,I)},$$slots:{default:!0}})})}var M=c(z,2);m(M,()=>Ze,(L,S)=>{S(L,{children:(Q,O)=>{var P=or(),N=d(P,!0);n(P),J(()=>B(N,w()?"退出专注":"专注模式")),r(Q,P)},$$slots:{default:!0}})}),r(ce,V)},$$slots:{default:!0}})}),n(E);var $=c(E,2);m($,()=>La,(G,W)=>{W(G,{class:"h-full from-muted/50 from-30%",children:(ce,D)=>{var V=cr(),z=_(V);m(z,()=>ja,(L,S)=>{S(L,{children:(Q,O)=>{var P=ir(),N=_(P);m(N,()=>Da,(q,U)=>{U(q,{variant:"icon",children:(A,se)=>{Et(A,{})},$$slots:{default:!0}})});var I=c(N,2);m(I,()=>Qa,(q,U)=>{U(q,{children:(A,se)=>{j();var oe=R("No PoCs Yet");r(A,oe)},$$slots:{default:!0}})});var pe=c(I,2);m(pe,()=>Ua,(q,U)=>{U(q,{children:(A,se)=>{j();var oe=R('请选择左侧列表中的 PoC 查看详情，或点击"新建 PoC"创建新的 PoC');r(A,oe)},$$slots:{default:!0}})}),r(Q,P)},$$slots:{default:!0}})});var M=c(z,2);m(M,()=>Va,(L,S)=>{S(L,{children:(Q,O)=>{var P=dr(),N=d(P);fe(N,{onclick:be,children:(I,pe)=>{var q=nr(),U=_(q);st(U,{}),j(),r(I,q)},$$slots:{default:!0}}),n(P),r(Q,P)},$$slots:{default:!0}})}),r(ce,V)},$$slots:{default:!0}})}),n(b),r(i,b)};le(ie,i=>{s.selectedPoc||t(l)?i(p):i(he,!1)})}n(re),r(g,re),ae()}function gr(g,e,a){F(e,0),a()}var _r=u('<div class="mb-4 text-sm text-muted-foreground"> </div>'),mr=u('<button class="rounded bg-primary px-4 py-2 text-primary-foreground hover:bg-primary/90">重试</button>'),hr=u('<div class="flex items-center justify-center p-8"><div class="text-center"><div class="mb-2 text-destructive">数据加载失败</div> <div class="mb-4 text-sm text-muted-foreground"> </div> <!></div></div>'),pr=u('<div class="flex items-center justify-center p-8"><div class="text-center"><div class="mx-auto mb-2 h-6 w-6 animate-spin rounded-full border-2 border-primary border-t-transparent"></div> <div class="text-sm text-muted-foreground">正在加载数据...</div></div></div>'),$r=u('<div class="flex min-h-0 flex-1"><div><!></div> <div><!></div> <div><!></div></div>'),Pr=u('<div class="flex min-h-svh flex-1 flex-col"><!></div>');function Or(g,e){te(e,!0);let a=ke(!1),l=ke(null),o=ke(0);const v=3;let f=ke(!1);function w(){F(f,!t(f))}async function C(){if(nt.authenticated)try{F(l,null),await s.init(),F(a,!0),F(o,0)}catch(ee){if(console.error("Failed to initialize POC data:",ee),F(l,ee instanceof Error?ee.message:"数据加载失败",!0),ee instanceof Error&&ee.message.includes("401"))return;t(o)<v&&(Dt(o),setTimeout(()=>{C()},1e3*t(o)))}}Ge(()=>{It.url.pathname==="/pocs"&&nt.authenticated&&!t(a)&&C()});var Y=Pr(),$e=d(Y);{var ye=ee=>{var Me=hr(),Se=d(Me),Oe=c(d(Se),2),Te=d(Oe,!0);n(Oe);var Pe=c(Oe,2);{var xe=me=>{var _e=_r(),k=d(_e);n(_e),J(()=>B(k,`正在重试... (${t(o)??""}/3)`)),r(me,_e)},be=me=>{var _e=mr();_e.__click=[gr,o,C],r(me,_e)};le(Pe,me=>{t(o)<v?me(xe):me(be,!1)})}n(Se),n(Me),J(()=>B(Te,t(l))),r(ee,Me)},Ae=ee=>{var Me=ue(),Se=_(Me);{var Oe=Pe=>{var xe=pr();r(Pe,xe)},Te=Pe=>{var xe=$r(),be=d(xe),me=d(be);ia(me,{}),n(be);var _e=c(be,2),k=d(_e);ma(k,{}),n(_e);var K=c(_e,2),re=d(K);fr(re,{get focusMode(){return t(f)},onToggleFocus:w}),n(K),n(xe),J(()=>{Ne(be,1,Je(t(f)?"hidden":"hidden w-64 border-r xl:block")),Ne(_e,1,Je(t(f)?"hidden":"min-h-0 w-[350px]")),Ne(K,1,Je(t(f)?"min-h-0 min-w-0 flex-1":"hidden min-h-0 min-w-0 flex-1 border-l lg:block"))}),r(Pe,xe)};le(Se,Pe=>{t(a)?Pe(Te,!1):Pe(Oe)},!0)}r(ee,Me)};le($e,ee=>{t(l)?ee(ye):ee(Ae,!1)})}n(Y),r(g,Y),ae()}ft(["click"]);export{Or as component};
