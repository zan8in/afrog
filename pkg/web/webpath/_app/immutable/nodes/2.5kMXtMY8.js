import{bn as Ha,bo as Qo,bp as Uo,Z as L,j as e,W as c,p as sr,f as i,y as Ia,w as Ar,D as o,z as qa,A as ps,F as s,d as t,e as or,T as ao,a as ar,v as _r,q as N,g as d,k as E,bq as Ho,c as qo,a4 as Go,r as a,br as Vo,bs as Ko,al as Wo,bt as Jo,bu as Xo,bv as Yo,bw as Zo,bx as en,a6 as xa,ac as aa,aD as so,u as Kr,n as p,a1 as g,i as r,C as H,t as T,s as zs,_ as P,aB as Pr,aE as jr,a2 as tn,by as rn,a8 as xs,aG as Ie,b0 as an,a_ as sn,b7 as Sa,bg as $a,bi as Ts,l as Qa,bz as Gs,aI as on,bA as nn,bB as ln,aH as Vs,az as dn,aX as Ks,bC as Ws,bD as cn,bE as Ua,aM as vn,bF as un,bG as fn,bH as pn,m as oo,B as _n,bI as mn,bJ as gn,Q as no,P as lo,O as Is,aQ as Js,bK as $n,bL as hn,M as xn,o as bn,b as yn,U as Pn,V as Ya,bM as wn,bN as kn,bO as Sn,aL as zn,R as Tn,bP as In,bQ as Xs,bR as An}from"../chunks/DP9-rN22.js";import{a as bt,s as Ee,R as ca,P as Cn}from"../chunks/CFY-pZWZ.js";import{B as ee,b as Ln}from"../chunks/BQ24xIRK.js";import{B as za}from"../chunks/qSYZW6i7.js";import{T as io,d as co,e as Ea,R as Za,S as es,k as bs,a as ys,b as Ps,c as ws,j as ts,g as rs,h as as,f as ks,i as Fr,C as Mn}from"../chunks/rtbglWAU.js";import{I as sa}from"../chunks/mrCXMKbp.js";import{c as mr,g as jn}from"../chunks/D_N-Uuvj.js";import{a as ns,b as ls,c as is,d as ds,e as cs,f as vs,g as us,R as fs,B as Nn,A as En,i as Ys,T as va,h as ua}from"../chunks/DwEMkxvl.js";import{a as Ir}from"../chunks/rPupsha6.js";import{S as ba,a as fa,b as pa,c as Ta,d as ya}from"../chunks/BzdbhFAs.js";import{L as On}from"../chunks/C809bX2A.js";import{s as Bn}from"../chunks/DXvIg6xT.js";import{s as Fn}from"../chunks/C4E2jRvb.js";import{a as Zs}from"../chunks/Dcjaah1X.js";const vo="scn_user_config",Dn=Ha(["fixed","full"]).default("full"),Rn=Ha(["cli","manual"]).default("cli"),Qn=Ha(["npm","yarn","pnpm","bun"]).default("pnpm"),Un=Ha(["class","hex","rgb","hsl","oklch","var"]).default("oklch"),Hn=Ha(["default","scaled","mono","blue","green","amber","rose","purple","orange","teal","violet","red","yellow","neutral"]).default("mono"),eo=Qo({layout:Dn,installationType:Rn,packageManager:Qn,colorFormat:Un,activeTheme:Hn}).default({layout:"full",installationType:"cli",packageManager:"npm",colorFormat:"oklch",activeTheme:"mono"});function qn(b){const l=b.split(";"),f={};for(const $ of l){const[x,u]=$.split("=");f[x]=u}return f}function Gn(b){const f=qn(b)[vo];return f?eo.parse(JSON.parse(f)):eo.parse({})}class Vn{#e;constructor(l){this.#e=L(l)}get current(){return e(this.#e)}setConfig(l){c(this.#e,{...e(this.#e),...l}),document.cookie=`${vo}=${JSON.stringify(e(this.#e))}; path=/; max-age=31536000; SameSite=Lax;`,l.layout&&Kn(e(this.#e).layout)}}function Kn(b){typeof document>"u"||(document.documentElement.classList.remove("layout-fixed","layout-full"),document.documentElement.classList.add(`layout-${b}`))}const uo=new Uo("UserConfigContext"),Wn=({data:b})=>({...b,userConfig:Gn(document.cookie)}),mv=Object.freeze(Object.defineProperty({__proto__:null,load:Wn},Symbol.toStringTag,{value:"Module"}));var Jn=i("<div><!></div>");function ha(b,l){sr(l,!0);let f=Ar(l,["$$slots","$$events","$$legacy","class","children"]);var $=Jn();Ia($,u=>({"data-slot":"input-group",role:"group",class:u,...f}),[()=>mr("group/input-group relative flex w-full items-center rounded-md border border-input shadow-xs transition-[color,box-shadow] outline-none dark:bg-input/30","h-9 has-[>textarea]:h-auto","has-[>[data-align=inline-start]]:[&>input]:pl-2","has-[>[data-align=inline-end]]:[&>input]:pr-2","has-[>[data-align=block-start]]:h-auto has-[>[data-align=block-start]]:flex-col has-[>[data-align=block-start]]:[&>input]:pb-3","has-[>[data-align=block-end]]:h-auto has-[>[data-align=block-end]]:flex-col has-[>[data-align=block-end]]:[&>input]:pt-3","has-[[data-slot=input-group-control]:focus-visible]:border-ring has-[[data-slot=input-group-control]:focus-visible]:ring-[3px] has-[[data-slot=input-group-control]:focus-visible]:ring-ring/50","has-[[data-slot][aria-invalid=true]]:border-destructive has-[[data-slot][aria-invalid=true]]:ring-destructive/20 dark:has-[[data-slot][aria-invalid=true]]:ring-destructive/40",l.class)]);var x=o($);qa(x,()=>l.children??ps),s($),t(b,$),or()}const Xn=ao({base:"text-muted-foreground flex h-auto cursor-text select-none items-center justify-center gap-2 py-1.5 text-sm font-medium group-data-[disabled=true]/input-group:opacity-50 [&>kbd]:rounded-[calc(var(--radius)-5px)] [&>svg:not([class*='size-'])]:size-4",variants:{align:{"inline-start":"order-first pl-3 has-[>button]:ml-[-0.45rem] has-[>kbd]:ml-[-0.35rem]","inline-end":"order-last pr-3 has-[>button]:mr-[-0.45rem] has-[>kbd]:mr-[-0.35rem]","block-start":"[.border-b]:pb-3 order-first w-full justify-start px-3 pt-3 group-has-[>input]/input-group:pt-2.5","block-end":"[.border-t]:pt-3 order-last w-full justify-start px-3 pb-3 group-has-[>input]/input-group:pb-2.5"}},defaultVariants:{align:"inline-start"}});var Yn=i("<div><!></div>");function da(b,l){sr(l,!0);let f=ar(l,"align",3,"inline-start"),$=Ar(l,["$$slots","$$events","$$legacy","class","children","align"]);var x=Yn(),u=Q=>{Q.target.closest("button")||Q.currentTarget.parentElement?.querySelector("input")?.focus()};Ia(x,Q=>({role:"group","data-slot":"input-group-addon","data-align":f(),class:Q,onclick:u,...$}),[()=>mr(Xn({align:f()}),l.class)]);var A=o(x);qa(A,()=>l.children??ps),s(x),t(b,x),or()}const Zn=ao({base:"flex items-center gap-2 text-sm shadow-none",variants:{size:{xs:"h-6 gap-1 rounded-[calc(var(--radius)-5px)] px-2 has-[>svg]:px-2 [&>svg:not([class*='size-'])]:size-3.5",sm:"h-8 gap-1.5 rounded-md px-2.5 has-[>svg]:px-2.5","icon-xs":"size-6 rounded-[calc(var(--radius)-5px)] p-0 has-[>svg]:p-0","icon-sm":"size-8 p-0 has-[>svg]:p-0"}},defaultVariants:{size:"xs"}});function Gt(b,l){sr(l,!0);let f=ar(l,"type",3,"button"),$=ar(l,"variant",3,"ghost"),x=ar(l,"size",3,"xs"),u=Ar(l,["$$slots","$$events","$$legacy","class","children","type","variant","size"]);{let A=E(()=>mr(Zn({size:x()}),l.class));ee(b,_r({get type(){return f()},get"data-size"(){return x()},get variant(){return $()},get class(){return e(A)}},()=>u,{children:(Q,J)=>{var Ke=N(),Ue=d(Ke);qa(Ue,()=>l.children??ps),t(Q,Ke)},$$slots:{default:!0}}))}or()}function La(b,l){sr(l,!0);let f=ar(l,"value",15),$=Ar(l,["$$slots","$$events","$$legacy","class","value"]);{let x=E(()=>mr("flex-1 rounded-none border-0 bg-transparent shadow-none focus-visible:ring-0 dark:bg-transparent",l.class));sa(b,_r({"data-slot":"input-group-control",get class(){return e(x)}},()=>$,{get value(){return f()},set value(u){f(u)}}))}or()}var el=i("<span><!></span>");function tl(b,l){sr(l,!0);let f=Ar(l,["$$slots","$$events","$$legacy","class","children"]);var $=el();Ia($,u=>({class:u,...f}),[()=>mr("flex items-center gap-2 text-sm text-muted-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4",l.class)]);var x=o($);qa(x,()=>l.children??ps),s($),t(b,$),or()}var rl=i("<textarea></textarea>");function fo(b,l){sr(l,!0);let f=ar(l,"ref",15,null),$=ar(l,"value",15),x=ar(l,"data-slot",3,"textarea"),u=Ar(l,["$$slots","$$events","$$legacy","ref","value","class","data-slot"]);var A=rl();Ho(A),Ia(A,Q=>({"data-slot":x(),class:Q,...u}),[()=>mr("flex field-sizing-content min-h-16 w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:cursor-not-allowed disabled:opacity-50 aria-invalid:border-destructive aria-invalid:ring-destructive/20 md:text-sm dark:bg-input/30 dark:aria-invalid:ring-destructive/40",l.class)]),qo(A,Q=>f(Q),()=>f()),Go(A,$),t(b,A),or()}function al(b,l){sr(l,!0);let f=ar(l,"value",15),$=ar(l,"ref",15,null),x=Ar(l,["$$slots","$$events","$$legacy","class","value","ref"]);{let u=E(()=>mr("flex-1 resize-none rounded-none border-0 bg-transparent py-3 shadow-none focus-visible:ring-0 dark:bg-transparent",l.class));fo(b,_r({"data-slot":"input-group-control",get class(){return e(u)}},()=>x,{get ref(){return $()},set ref(A){$(A)},get value(){return f()},set value(A){f(A)}}))}or()}function to(b,l){sr(l,!0);let f=ar(l,"ref",15,null),$=ar(l,"checked",15,!1),x=Ar(l,["$$slots","$$events","$$legacy","ref","class","checked"]);var u=N(),A=d(u);{let Q=E(()=>mr("peer inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input dark:data-[state=unchecked]:bg-input/80",l.class));a(A,()=>Vo,(J,Ke)=>{Ke(J,_r({"data-slot":"switch",get class(){return e(Q)}},()=>x,{get ref(){return f()},set ref(Ue){f(Ue)},get checked(){return $()},set checked(Ue){$(Ue)},children:(Ue,Vt)=>{var lt=N(),kt=d(lt);{let dr=E(()=>mr("pointer-events-none block size-4 rounded-full bg-background ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0 dark:data-[state=checked]:bg-primary-foreground dark:data-[state=unchecked]:bg-foreground"));a(kt,()=>Ko,(Ft,Xe)=>{Xe(Ft,{"data-slot":"switch-thumb",get class(){return e(dr)}})})}t(Ue,lt)},$$slots:{default:!0}}))})}t(b,u),or()}function Ma(b,l){sr(l,!0);let f=ar(l,"ref",15,null),$=ar(l,"sideOffset",3,4),x=ar(l,"align",3,"center"),u=ar(l,"portalProps",19,()=>({to:".theme-container"})),A=Ar(l,["$$slots","$$events","$$legacy","ref","class","sideOffset","align","portalProps"]);var Q=N(),J=d(Q);a(J,()=>Wo,(Ke,Ue)=>{Ue(Ke,_r(u,{children:(Vt,lt)=>{var kt=N(),dr=d(kt);{let Ft=E(()=>mr("z-50 w-72 origin-(--bits-popover-content-transform-origin) rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-hidden data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-95",l.class));a(dr,()=>Jo,(Xe,Ye)=>{Ye(Xe,_r({"data-slot":"popover-content",get sideOffset(){return $()},get align(){return x()},get class(){return e(Ft)}},()=>A,{get ref(){return f()},set ref(Oe){f(Oe)}}))})}t(Vt,kt)},$$slots:{default:!0}}))}),t(b,Q),or()}function ja(b,l){sr(l,!0);let f=ar(l,"ref",15,null),$=Ar(l,["$$slots","$$events","$$legacy","ref","class"]);var x=N(),u=d(x);{let A=E(()=>mr("",l.class));a(u,()=>Xo,(Q,J)=>{J(Q,_r({"data-slot":"popover-trigger",get class(){return e(A)}},()=>$,{get ref(){return f()},set ref(Ke){f(Ke)}}))})}t(b,x),or()}const Na=Yo,ss=Zo;function Ss(b,l){sr(l,!0);let f=ar(l,"ref",15,null),$=ar(l,"data-slot",3,"separator"),x=Ar(l,["$$slots","$$events","$$legacy","ref","class","data-slot"]);var u=N(),A=d(u);{let Q=E(()=>mr("shrink-0 bg-border data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",l.class));a(A,()=>en,(J,Ke)=>{Ke(J,_r({get"data-slot"(){return $()},get class(){return e(Q)}},()=>x,{get ref(){return f()},set ref(Ue){f(Ue)}}))})}t(b,u),or()}class sl{#e=L(xa([]));get sets(){return e(this.#e)}set sets(l){c(this.#e,l,!0)}#t=L("idle");get setsStatus(){return e(this.#t)}set setsStatus(l){c(this.#t,l,!0)}#r=L(null);get setsError(){return e(this.#r)}set setsError(l){c(this.#r,l,!0)}#a=L(null);get selectedSetId(){return e(this.#a)}set selectedSetId(l){c(this.#a,l,!0)}#s=L(xa([]));get items(){return e(this.#s)}set items(l){c(this.#s,l,!0)}#o=L("idle");get itemsStatus(){return e(this.#o)}set itemsStatus(l){c(this.#o,l,!0)}#n=L(null);get itemsError(){return e(this.#n)}set itemsError(l){c(this.#n,l,!0)}#l=L("");get setQuery(){return e(this.#l)}set setQuery(l){c(this.#l,l,!0)}#i=L("");get itemQuery(){return e(this.#i)}set itemQuery(l){c(this.#i,l,!0)}#d=L("");get globalQuery(){return e(this.#d)}set globalQuery(l){c(this.#d,l,!0)}#c=L(xa(new aa));get selectedItems(){return e(this.#c)}set selectedItems(l){c(this.#c,l,!0)}#v=L(xa([]));get searchResults(){return e(this.#v)}set searchResults(l){c(this.#v,l,!0)}#u=L("");get importText(){return e(this.#u)}set importText(l){c(this.#u,l,!0)}get filteredItems(){const l=(this.itemQuery||"").trim().toLowerCase(),f=l?this.items.filter($=>$.toLowerCase().includes(l)):this.items;return Array.from(new aa(f))}get filteredSets(){const l=(this.setQuery||"").trim().toLowerCase();return l?this.sets.filter(f=>(f.name||f.id||"").toLowerCase().includes(l)):this.sets}async loadSets(){this.setsStatus="loading",this.setsError=null;try{const f=(await Ir.getAssetSets())?.data,$=f&&typeof f=="object"?f:null,x=Array.isArray(f)?f:Array.isArray($?.items)?$?.items:Array.isArray($?.sets)?$?.sets:[];this.sets=x,this.setsStatus="success"}catch(l){this.setsStatus="error",this.setsError=l instanceof Error?l.message:"加载资产集合失败"}}async selectSet(l){this.selectedSetId=l,this.itemQuery="",await this.loadItems(l)}async loadItems(l){this.itemsStatus="loading",this.itemsError=null,this.items=[],this.selectedItems=new aa;try{const $=(await Ir.getAssetSetItems(l))?.data,x=$&&typeof $=="object"?$:null,u=Array.isArray($)?$:Array.isArray(x?.items)?x?.items:[];this.items=u.filter(A=>typeof A=="string"),this.itemsStatus="success"}catch(f){this.itemsStatus="error",this.itemsError=f instanceof Error?f.message:"加载集合条目失败"}}toggleSelect(l){const f=new aa(this.selectedItems);f.has(l)?f.delete(l):f.add(l),this.selectedItems=f}clearSelection(){this.selectedItems=new aa}selectAllFiltered(){const l=new aa(this.selectedItems);for(const f of this.filteredItems)l.add(f);this.selectedItems=l}invertSelectionFiltered(){const l=new aa(this.selectedItems);for(const f of this.filteredItems)l.has(f)?l.delete(f):l.add(f);this.selectedItems=l}async importToSelected(l={dedupe:!0,normalize:!0}){if(!this.selectedSetId)throw new Error("未选择集合");const f=(this.importText||"").split(/\r?\n/).map(u=>u.trim()).filter(Boolean).join(`
`);if(!f)return{added:0,skipped:0};const $={content:f,options:{dedupe:l.dedupe,normalize:l.normalize}},x=await Ir.importIntoAssetSet(this.selectedSetId,$);return await this.loadItems(this.selectedSetId),this.importText="",x.data||{added:0,skipped:0}}async createSet(l,f){const $=(f?.content??"").split(/\r?\n/).map(Q=>Q.trim()).filter(Boolean).join(`
`),x={name:l,category:f?.category,tags:f?.tags,content:$,options:{dedup:!0,normalize:!0}},u=await Ir.createAssetSet(x);await this.loadSets();const A=u?.data?.id;return A&&await this.selectSet(A),u}async deleteSelectedSet(){this.selectedSetId&&(await Ir.deleteAssetSet(this.selectedSetId),this.selectedSetId=null,await this.loadSets(),this.items=[])}async search(l){this.globalQuery=l;const $=(await Ir.searchAssets(l))?.data,x=$&&typeof $=="object"?$:null,u=Array.isArray($)?$:Array.isArray(x?.items)?x?.items:[];this.searchResults=u.filter(A=>typeof A=="string")}}const ne=new sl;var ol=i("<!> <!> <!>",1),nl=i('<span class="text-xs text-muted-foreground"> </span>'),ll=i('<div class="flex items-center justify-between border-b px-4 py-3"><!> <div class="flex items-center gap-2"><!> <!></div></div>'),il=i('<div class="space-y-3 p-4"><div class="flex items-center justify-between gap-2"><div class="flex items-center gap-2"><!> <!></div> <div class="text-xs text-muted-foreground"> </div></div> <!> <div class="flex items-center gap-2"><!> <!></div></div>'),dl=i("<!> <!>",1),cl=i("<!> <!>",1),vl=i("<!> <!>",1),ul=i("<!> <!>",1),fl=i('<div class="p-3 text-xs text-muted-foreground">加载中...</div>'),pl=i('<div class="p-3 text-xs text-destructive"> </div>'),_l=i('<div class="p-3 text-xs text-muted-foreground">暂无集合</div>'),ml=i('<button><div class="truncate text-xs"> </div> <!></button>'),gl=i("<!> <!> <!>",1),$l=i('<div class="p-3 text-xs text-muted-foreground">加载中...</div>'),hl=i('<div class="p-3 text-xs text-destructive"> </div>'),xl=i('<div class="p-3 text-xs text-muted-foreground">暂无条目</div>'),bl=i('<label class="flex items-center gap-2 border-t px-3 py-1 text-sm"><input type="checkbox"/> <span class="truncate"> </span></label>'),yl=i("<!> <!> <!>",1),Pl=i('<div class="flex min-h-0 flex-1"><div class="flex w-64 flex-col border-r"><div class="flex items-center justify-between p-3"><div class="text-xs">集合</div> <div class="flex items-center gap-2"><!> <!></div></div> <!> <div class="space-y-2 border-t p-3"><!> <div class="flex items-center gap-2"></div></div></div> <div class="flex min-h-0 flex-1 flex-col"><div class="border-b p-3 text-xs"><div class="flex items-center justify-between gap-2"><div> </div> <div class="flex items-center gap-2"><!> <!> <!> <!></div></div></div> <!></div></div>'),wl=i('<span class="text-xs text-muted-foreground"> </span>'),kl=i('<div class="p-3 text-xs text-muted-foreground">暂无结果</div>'),Sl=i('<div class="truncate border-t px-3 py-1"> </div>'),zl=i('<div class="text-sm"></div>'),Tl=i("<!> <!> <!>",1),Il=i('<div class="space-y-3 p-4"><div class="flex items-center gap-2"><!> <!> <!> <!></div> <div class="rounded border"><!></div></div>'),Al=i('<div class="flex h-[var(--assets-height)] flex-col"><!> <!></div>');function Cl(b,l){sr(l,!0);let f=ar(l,"height",3,"60vh"),$=ar(l,"onAdd",3,()=>{}),x=L("import"),u=L(!1),A=L(!1),Q=L(null);const J=E(()=>(ne.importText||"").split(/\r?\n/)),Ke=E(()=>e(J).map($e=>$e.trim()).filter(Boolean)),Ue=E(()=>Array.from(new Set(e(Ke))));Kr(()=>{ne.loadSets()});function Vt(){if(e(A))return;const $e=Array.from(ne.selectedItems);if($e.length===0){c(Q,"请选择条目");return}c(A,!0);try{$()($e),c(Q,`已添加 ${$e.length} 条`),setTimeout(()=>c(Q,null),2e3)}finally{c(A,!1)}}async function lt(){const $e=await navigator.clipboard.readText().catch(()=>"");ne.importText=$e}function kt(){const $e=(ne.importText||"").split(/\r?\n/).map(Fe=>Fe.trim()).filter(Boolean),at=Array.from(new Set($e));ne.importText=at.join(`
`)}async function dr(){await ne.importToSelected({dedupe:!0,normalize:!0})}async function Ft(){const $e=prompt("新集合名称");$e&&(await ne.createSet($e,{content:ne.importText}),ne.importText="",c(x,"history"))}async function Xe(){await ne.deleteSelectedSet(),c(u,!1)}async function Ye(){const $e=(ne.globalQuery||"").trim();$e&&(await ne.search($e),c(x,"search"))}var Oe=Al(),Dt=o(Oe);a(Dt,()=>io,($e,at)=>{at($e,{get value(){return e(x)},set value(Fe){c(x,Fe,!0)},children:(Fe,Nt)=>{var vt=ll(),ut=o(vt);a(ut,()=>co,(yt,qt)=>{qt(yt,{children:(st,Wt)=>{var Jt=ol(),Nr=d(Jt);a(Nr,()=>Ea,(cr,Wr)=>{Wr(cr,{value:"import",children:(Hr,ft)=>{p();var Xt=g("导入");t(Hr,Xt)},$$slots:{default:!0}})});var Ur=r(Nr,2);a(Ur,()=>Ea,(cr,Wr)=>{Wr(cr,{value:"history",children:(Hr,ft)=>{p();var Xt=g("集合");t(Hr,Xt)},$$slots:{default:!0}})});var ea=r(Ur,2);a(ea,()=>Ea,(cr,Wr)=>{Wr(cr,{value:"search",children:(Hr,ft)=>{p();var Xt=g("搜索");t(Hr,Xt)},$$slots:{default:!0}})}),t(st,Jt)},$$slots:{default:!0}})});var Et=r(ut,2),Ze=o(Et);ee(Ze,{size:"sm",onclick:Vt,get disabled(){return e(A)},children:(yt,qt)=>{p();var st=g("添加到资产列表");t(yt,st)},$$slots:{default:!0}});var Ot=r(Ze,2);{var Kt=yt=>{var qt=nl(),st=o(qt,!0);s(qt),T(()=>P(st,e(Q))),t(yt,qt)};H(Ot,yt=>{e(Q)&&yt(Kt)})}s(Et),s(vt),t(Fe,vt)},$$slots:{default:!0}})});var gr=r(Dt,2);{var Ht=$e=>{var at=il(),Fe=o(at),Nt=o(Fe),vt=o(Nt);ee(vt,{size:"sm",variant:"ghost",onclick:lt,children:(st,Wt)=>{p();var Jt=g("从剪贴板导入");t(st,Jt)},$$slots:{default:!0}});var ut=r(vt,2);ee(ut,{size:"sm",variant:"ghost",onclick:kt,children:(st,Wt)=>{p();var Jt=g("去重与清理");t(st,Jt)},$$slots:{default:!0}}),s(Nt);var Et=r(Nt,2),Ze=o(Et);s(Et),s(Fe);var Ot=r(Fe,2);fo(Ot,{rows:12,class:"h-[260px] w-full resize-none",get value(){return ne.importText},set value(st){ne.importText=st}});var Kt=r(Ot,2),yt=o(Kt);{let st=E(()=>!ne.importText.trim());ee(yt,{size:"sm",onclick:Ft,get disabled(){return e(st)},children:(Wt,Jt)=>{p();var Nr=g("保存为新集合");t(Wt,Nr)},$$slots:{default:!0}})}var qt=r(yt,2);{let st=E(()=>!ne.selectedSetId||!ne.importText.trim());ee(qt,{size:"sm",variant:"outline",onclick:dr,get disabled(){return e(st)},children:(Wt,Jt)=>{p();var Nr=g("追加到当前集合");t(Wt,Nr)},$$slots:{default:!0}})}s(Kt),s(at),T(()=>P(Ze,`行数 ${e(J).length??""} · 非空 ${e(Ke).length??""} · 去重 ${e(Ue).length??""}`)),t($e,at)},jt=$e=>{var at=N(),Fe=d(at);{var Nt=ut=>{var Et=Pl(),Ze=o(Et),Ot=o(Ze),Kt=r(o(Ot),2),yt=o(Kt);ee(yt,{size:"sm",variant:"ghost",onclick:()=>ne.loadSets(),children:(At,wr)=>{p();var Ct=g("刷新");t(At,Ct)},$$slots:{default:!0}});var qt=r(yt,2);a(qt,()=>fs,(At,wr)=>{wr(At,{get open(){return e(u)},set open(Ct){c(u,Ct,!0)},children:(Ct,Er)=>{var $r=ul(),Cr=d($r);{let Zt=E(()=>!ne.selectedSetId);ee(Cr,{size:"sm",variant:"ghost",get disabled(){return e(Zt)},onclick:()=>c(u,!0),children:(er,hr)=>{p();var vr=g("删除");t(er,vr)},$$slots:{default:!0}})}var nr=r(Cr,2);a(nr,()=>ns,(Zt,er)=>{er(Zt,{children:(hr,vr)=>{var Lr=vl(),Rt=d(Lr);a(Rt,()=>ls,(zr,Mr)=>{Mr(zr,{children:(tr,xr)=>{var Dr=dl(),Rr=d(Dr);a(Rr,()=>is,(Qt,Lt)=>{Lt(Qt,{children:(ur,Jr)=>{p();var Or=g("确认删除");t(ur,Or)},$$slots:{default:!0}})});var qr=r(Rr,2);a(qr,()=>ds,(Qt,Lt)=>{Lt(Qt,{children:(ur,Jr)=>{p();var Or=g("删除后不可恢复，是否删除当前集合？");t(ur,Or)},$$slots:{default:!0}})}),t(tr,Dr)},$$slots:{default:!0}})});var kr=r(Rt,2);a(kr,()=>cs,(zr,Mr)=>{Mr(zr,{children:(tr,xr)=>{var Dr=cl(),Rr=d(Dr);a(Rr,()=>vs,(Qt,Lt)=>{Lt(Qt,{children:(ur,Jr)=>{p();var Or=g("取消");t(ur,Or)},$$slots:{default:!0}})});var qr=r(Rr,2);a(qr,()=>us,(Qt,Lt)=>{Lt(Qt,{onclick:Xe,children:(ur,Jr)=>{p();var Or=g("删除");t(ur,Or)},$$slots:{default:!0}})}),t(tr,Dr)},$$slots:{default:!0}})}),t(hr,Lr)},$$slots:{default:!0}})}),t(Ct,$r)},$$slots:{default:!0}})}),s(Kt),s(Ot);var st=r(Ot,2);a(st,()=>ya,(At,wr)=>{wr(At,{class:"flex-1",children:(Ct,Er)=>{var $r=gl(),Cr=d($r);a(Cr,()=>ba,(er,hr)=>{hr(er,{class:"h-full",children:(vr,Lr)=>{var Rt=N(),kr=d(Rt);{var zr=tr=>{var xr=fl();t(tr,xr)},Mr=tr=>{var xr=N(),Dr=d(xr);{var Rr=Qt=>{var Lt=pl(),ur=o(Lt,!0);s(Lt),T(()=>P(ur,ne.setsError)),t(Qt,Lt)},qr=Qt=>{var Lt=N(),ur=d(Lt);{var Jr=h=>{var Br=_l();t(h,Br)},Or=h=>{var Br=N(),Oa=d(Br);Pr(Oa,17,()=>ne.filteredSets,na=>na.id,(na,Gr)=>{var Xr=ml();Xr.__click=()=>ne.selectSet(e(Gr).id);var ta=o(Xr),Aa=o(ta,!0);s(ta);var Ba=r(ta,2);za(Ba,{variant:"outline",class:"h-5",children:(Fa,Ga)=>{p();var Va=g();T(()=>P(Va,e(Gr).line_count??0)),t(Fa,Va)},$$slots:{default:!0}}),s(Xr),T(()=>{jr(Xr,1,`flex w-full items-center justify-between border-t px-3 py-2 text-left ${ne.selectedSetId===e(Gr).id?"bg-muted":""}`),P(Aa,e(Gr).name)}),t(na,Xr)}),t(h,Br)};H(ur,h=>{ne.sets.length===0?h(Jr):h(Or,!1)},!0)}t(Qt,Lt)};H(Dr,Qt=>{ne.setsStatus==="error"?Qt(Rr):Qt(qr,!1)},!0)}t(tr,xr)};H(kr,tr=>{ne.setsStatus==="loading"?tr(zr):tr(Mr,!1)})}t(vr,Rt)},$$slots:{default:!0}})});var nr=r(Cr,2);a(nr,()=>fa,(er,hr)=>{hr(er,{orientation:"vertical",children:(vr,Lr)=>{var Rt=N(),kr=d(Rt);a(kr,()=>pa,(zr,Mr)=>{Mr(zr,{})}),t(vr,Rt)},$$slots:{default:!0}})});var Zt=r(nr,2);a(Zt,()=>Ta,(er,hr)=>{hr(er,{})}),t(Ct,$r)},$$slots:{default:!0}})});var Wt=r(st,2),Jt=o(Wt);sa(Jt,{placeholder:"搜索集合",class:"h-8",get value(){return ne.setQuery},set value(At){ne.setQuery=At}}),p(2),s(Wt),s(Ze);var Nr=r(Ze,2),Ur=o(Nr),ea=o(Ur),cr=o(ea),Wr=o(cr);s(cr);var Hr=r(cr,2),ft=o(Hr);sa(ft,{class:"h-8",placeholder:"筛选条目",get value(){return ne.itemQuery},set value(At){ne.itemQuery=At}});var Xt=r(ft,2);ee(Xt,{size:"sm",variant:"outline",onclick:()=>{ne.itemQuery=""},children:(At,wr)=>{p();var Ct=g("清空筛选");t(At,Ct)},$$slots:{default:!0}});var Yt=r(Xt,2);ee(Yt,{size:"sm",variant:"outline",onclick:()=>ne.selectAllFiltered(),children:(At,wr)=>{p();var Ct=g("全选");t(At,Ct)},$$slots:{default:!0}});var oa=r(Yt,2);ee(oa,{size:"sm",variant:"ghost",onclick:()=>ne.clearSelection(),children:(At,wr)=>{p();var Ct=g("清空选择");t(At,Ct)},$$slots:{default:!0}}),s(Hr),s(ea),s(Ur);var _a=r(Ur,2);a(_a,()=>ya,(At,wr)=>{wr(At,{class:"flex-1",children:(Ct,Er)=>{var $r=yl(),Cr=d($r);a(Cr,()=>ba,(er,hr)=>{hr(er,{class:"h-full",children:(vr,Lr)=>{var Rt=N(),kr=d(Rt);{var zr=tr=>{var xr=$l();t(tr,xr)},Mr=tr=>{var xr=N(),Dr=d(xr);{var Rr=Qt=>{var Lt=hl(),ur=o(Lt,!0);s(Lt),T(()=>P(ur,ne.itemsError)),t(Qt,Lt)},qr=Qt=>{var Lt=N(),ur=d(Lt);{var Jr=h=>{var Br=xl();t(h,Br)},Or=h=>{var Br=N(),Oa=d(Br);Pr(Oa,19,()=>ne.filteredItems,(na,Gr)=>na+":"+Gr,(na,Gr)=>{var Xr=bl(),ta=o(Xr);tn(ta),ta.__change=()=>ne.toggleSelect(e(Gr));var Aa=r(ta,2),Ba=o(Aa,!0);s(Aa),s(Xr),T(Fa=>{rn(ta,Fa),P(Ba,e(Gr))},[()=>ne.selectedItems.has(e(Gr))]),t(na,Xr)}),t(h,Br)};H(ur,h=>{ne.filteredItems.length===0?h(Jr):h(Or,!1)},!0)}t(Qt,Lt)};H(Dr,Qt=>{ne.itemsStatus==="error"?Qt(Rr):Qt(qr,!1)},!0)}t(tr,xr)};H(kr,tr=>{ne.itemsStatus==="loading"?tr(zr):tr(Mr,!1)})}t(vr,Rt)},$$slots:{default:!0}})});var nr=r(Cr,2);a(nr,()=>fa,(er,hr)=>{hr(er,{orientation:"vertical",children:(vr,Lr)=>{var Rt=N(),kr=d(Rt);a(kr,()=>pa,(zr,Mr)=>{Mr(zr,{})}),t(vr,Rt)},$$slots:{default:!0}})});var Zt=r(nr,2);a(Zt,()=>Ta,(er,hr)=>{hr(er,{})}),t(Ct,$r)},$$slots:{default:!0}})}),s(Nr),s(Et),T(()=>P(Wr,`条目 · ${ne.filteredItems.length??""}`)),t(ut,Et)},vt=ut=>{var Et=N(),Ze=d(Et);{var Ot=Kt=>{var yt=Il(),qt=o(yt),st=o(qt);sa(st,{class:"h-9",placeholder:"跨集合搜索（按地址匹配）",get value(){return ne.globalQuery},set value(ft){ne.globalQuery=ft}});var Wt=r(st,2);ee(Wt,{size:"sm",onclick:Ye,children:(ft,Xt)=>{p();var Yt=g("搜索");t(ft,Yt)},$$slots:{default:!0}});var Jt=r(Wt,2);ee(Jt,{size:"sm",onclick:()=>{if(!e(A)){c(A,!0);try{const ft=ne.searchResults;ft.length===0?c(Q,"暂无可添加条目"):($()(ft),c(Q,`已添加 ${ft.length} 条`),setTimeout(()=>c(Q,null),2e3))}finally{c(A,!1)}}},get disabled(){return e(A)},children:(ft,Xt)=>{p();var Yt=g("添加到资产列表");t(ft,Yt)},$$slots:{default:!0}});var Nr=r(Jt,2);{var Ur=ft=>{var Xt=wl(),Yt=o(Xt,!0);s(Xt),T(()=>P(Yt,e(Q))),t(ft,Xt)};H(Nr,ft=>{e(Q)&&ft(Ur)})}s(qt);var ea=r(qt,2),cr=o(ea);{var Wr=ft=>{var Xt=kl();t(ft,Xt)},Hr=ft=>{var Xt=N(),Yt=d(Xt);a(Yt,()=>ya,(oa,_a)=>{_a(oa,{class:"max-h-[45vh]",children:(At,wr)=>{var Ct=Tl(),Er=d(Ct);a(Er,()=>ba,(nr,Zt)=>{Zt(nr,{children:(er,hr)=>{var vr=zl();Pr(vr,23,()=>ne.searchResults,(Lr,Rt)=>Lr+":"+Rt,(Lr,Rt)=>{var kr=Sl(),zr=o(kr,!0);s(kr),T(()=>P(zr,e(Rt))),t(Lr,kr)}),s(vr),t(er,vr)},$$slots:{default:!0}})});var $r=r(Er,2);a($r,()=>fa,(nr,Zt)=>{Zt(nr,{orientation:"vertical",children:(er,hr)=>{var vr=N(),Lr=d(vr);a(Lr,()=>pa,(Rt,kr)=>{kr(Rt,{})}),t(er,vr)},$$slots:{default:!0}})});var Cr=r($r,2);a(Cr,()=>Ta,(nr,Zt)=>{Zt(nr,{})}),t(At,Ct)},$$slots:{default:!0}})}),t(ft,Xt)};H(cr,ft=>{ne.searchResults.length===0?ft(Wr):ft(Hr,!1)})}s(ea),s(yt),t(Kt,yt)};H(Ze,Kt=>{e(x)==="search"&&Kt(Ot)},!0)}t(ut,Et)};H(Fe,ut=>{e(x)==="history"?ut(Nt):ut(vt,!1)},!0)}t($e,at)};H(gr,$e=>{e(x)==="import"?$e(Ht):$e(jt,!1)})}s(Oe),T(()=>zs(Oe,`--assets-height: ${f()};`)),t(b,Oe),or()}so(["click","change"]);function Ll(b,l,f){c(l,!0);try{b.currentTarget?.setPointerCapture?.(b.pointerId)}catch{}b.preventDefault(),b.stopPropagation();const $=u=>f(u.clientY),x=()=>{c(l,!1),window.removeEventListener("pointermove",$),window.removeEventListener("pointerup",x)};window.addEventListener("pointermove",$),window.addEventListener("pointerup",x,{once:!0}),f(b.clientY)}var Ml=i('<div class="flex min-w-0 items-center gap-2"><div></div> <span class="max-w-[120px] truncate text-xs font-medium"> </span></div>'),jl=i('<div class="size-2 rounded-full bg-muted"></div> <span class="text-xs">Idle</span>',1),Nl=i('<span class="ml-0.5 size-1.5 animate-pulse rounded-full bg-destructive" title="后台任务发现高危漏洞"></span>'),El=i('<span class="relative flex h-1.5 w-1.5"><span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-primary opacity-75"></span> <span class="relative inline-flex h-1.5 w-1.5 rounded-full bg-primary"></span></span> <span class="text-[10px]"> </span> <!>',1),Ol=(b,l,f)=>l(e(f).id),Bl=i('<span class="font-bold text-destructive"> </span>'),Fl=i('<button class="flex w-full items-center justify-between rounded-sm px-2 py-1.5 text-left text-xs transition-colors hover:bg-accent hover:text-accent-foreground"><div class="flex min-w-0 flex-1 items-center gap-2"><div class="size-1.5 shrink-0 rounded-full bg-primary"></div> <div class="truncate font-medium"> </div></div> <div class="flex items-center gap-2 text-muted-foreground"><!> <span> </span></div></button>'),Dl=i('<div class="border-b bg-muted/30 p-2 text-xs font-medium text-muted-foreground">后台运行任务</div> <div class="max-h-[300px] overflow-y-auto p-1"></div>',1),Rl=i("<!> <!>",1),Ql=i('<div class="text-xs text-muted-foreground">加载中…</div>'),Ul=i('<div class="text-xs text-muted-foreground">未发现可用实例</div>'),Hl=i('<div class="text-xs text-muted-foreground"> </div>'),ql=i('<div class="flex items-start justify-between gap-2 rounded-md border p-2"><div class="space-y-1"><div class="text-sm"> </div> <div class="text-xs text-muted-foreground"> </div> <!></div> <div class="flex items-center gap-2"><!></div></div>'),Gl=i('<div class="space-y-3 p-4"><div class="text-sm font-medium">选择要强制关闭的实例</div> <div class="text-xs text-muted-foreground"> </div> <div class="flex items-center gap-2"><!> <!> <!></div> <div class="space-y-2"><!></div></div>'),Vl=i('<span class="flex items-center gap-1 font-bold text-destructive"><div class="size-1.5 rounded-full bg-destructive"></div> </span>'),Kl=i('<span class="flex items-center gap-1 font-bold text-orange-500"><div class="size-1.5 rounded-full bg-orange-500"></div> </span>'),Wl=i('<span class="flex items-center gap-1 text-yellow-500"><div class="size-1.5 rounded-full bg-yellow-500"></div> </span>'),Jl=i('<span class="flex items-center gap-1 text-sky-500"><div class="size-1.5 rounded-full bg-sky-500"></div> </span>'),Xl=i('<span class="text-muted-foreground/50">无漏洞发现</span>'),Yl=i('<div class="flex items-center gap-3 font-mono text-xs"><!> <!> <!> <!> <!></div> <div class="flex w-48 items-center gap-2"><div class="h-1.5 w-full overflow-hidden rounded-full bg-muted"><div class="h-full bg-primary transition-all duration-500 ease-out"></div></div> <div class="w-8 text-right font-mono text-[10px] text-muted-foreground"> </div></div>',1),Zl=i('<!> <span class="sr-only">展开面板</span>',1),ei=i('<span class="text-sm">任务</span>'),ti=i('<div class="flex items-center gap-1"><!></div>'),ri=(b,l,f)=>l(e(f).id),ai=(b,l,f)=>{b.stopPropagation(),l(e(f).id)},si=i('<div class="group relative"><button><div class="flex min-w-0 items-center gap-2"><div></div> <div class="max-w-[140px] min-w-0 truncate text-xs"> </div></div> <div class="flex items-center gap-1 transition-opacity group-hover:opacity-0"><div class="text-xs text-muted-foreground"> </div></div></button> <button class="hover:text-destructive-foreground absolute top-1/2 right-1 hidden h-6 w-6 -translate-y-1/2 items-center justify-center rounded-sm text-muted-foreground transition-colors group-hover:flex hover:bg-destructive" title="删除任务"><!></button></div>'),oi=i("<!> <!> <!>",1),ni=(b,l,f)=>l(e(f).id),li=i('<button><span></span> <span class="ms-2 text-[11px] tracking-wide text-muted-foreground"> </span></button>'),ii=i("<!> <!> <!>",1),di=i('<span data-slot="select-value" class="truncate"> </span>'),ci=i("<!> <!> <!> <!> <!> <!>",1),vi=i("<!> <!>",1),ui=i("<!> <!>",1),fi=i("<!> <!>",1),pi=i('<div class="flex h-full flex-col items-center justify-center py-10 text-muted-foreground opacity-50"><!> <p>暂无活动日志</p></div>'),_i=i('<span class="opacity-70">OOB</span> <span> </span>',1),mi=i('<div class="flex items-center gap-2"><div class="size-1 shrink-0 rounded-full bg-primary-foreground/40"></div> <span class="truncate"></span></div>'),gi=i('<div class="pl-3 text-[9px] opacity-50"> </div>'),$i=i('<div class="mt-3 border-t border-primary-foreground/20 pt-2"><div class="mb-1.5 flex items-center justify-between text-[10px] opacity-70"><span>目标列表</span> <span class="opacity-50"><!></span></div> <div class="flex flex-col gap-1.5 rounded-md bg-black/20 p-2 font-mono text-[10px] break-all opacity-90"><!> <!></div></div>'),hi=i('<div class="min-w-[260px] rounded-2xl rounded-tr-sm bg-primary p-4 text-sm leading-relaxed text-primary-foreground shadow-sm"><div class="mb-3 flex items-center gap-2 border-b border-primary-foreground/20 pb-2 font-bold"><!> <span>任务已启动</span></div> <div class="grid grid-cols-2 gap-x-6 gap-y-2 text-xs"><span class="opacity-70">目标数量</span> <span class="text-right font-mono font-bold"> </span> <span class="opacity-70">PoC 数量</span> <span class="text-right font-mono font-bold"> </span> <span class="opacity-70">预计扫描</span> <span class="text-right font-mono font-bold"> </span> <!></div> <!></div>'),xi=i('<div class="flex flex-col items-center rounded bg-black/20 p-1.5"><span class="text-[10px] opacity-70">CRITICAL</span> <span class="font-mono font-bold text-red-300"> </span></div>'),bi=i('<div class="flex flex-col items-center rounded bg-black/20 p-1.5"><span class="text-[10px] opacity-70">HIGH</span> <span class="font-mono font-bold text-orange-300"> </span></div>'),yi=i('<div class="flex flex-col items-center rounded bg-black/20 p-1.5"><span class="text-[10px] opacity-70">MEDIUM</span> <span class="font-mono font-bold text-yellow-300"> </span></div>'),Pi=i('<div class="flex flex-col items-center rounded bg-black/20 p-1.5"><span class="text-[10px] opacity-70">LOW</span> <span class="font-mono font-bold text-blue-300"> </span></div>'),wi=i('<div class="flex flex-col items-center rounded bg-black/20 p-1.5"><span class="text-[10px] opacity-70">INFO</span> <span class="font-mono font-bold text-gray-300"> </span></div>'),ki=i('<div class="py-1 text-center text-[10px] opacity-50">未发现漏洞</div>'),Si=i('<div class="mt-3 border-t border-primary-foreground/20 pt-2"><div class="mb-2 text-[10px] opacity-70">漏洞统计</div> <div class="grid grid-cols-3 gap-2 text-xs"><!> <!> <!> <!> <!></div> <!></div>'),zi=i('<div class="min-w-[260px] rounded-2xl rounded-tr-sm bg-primary p-4 text-sm leading-relaxed text-primary-foreground shadow-sm"><div class="mb-3 flex items-center gap-2 border-b border-primary-foreground/20 pb-2 font-bold"><!> <span>扫描已完成</span></div> <div class="grid grid-cols-2 gap-x-6 gap-y-2 text-xs"><span class="opacity-70">总耗时</span> <span class="text-right font-mono font-bold"> </span> <span class="opacity-70">总请求</span> <span class="text-right font-mono font-bold"> </span></div> <!></div>'),Ti=i('<div class="rounded-2xl rounded-tr-sm bg-primary px-4 py-2.5 text-sm leading-relaxed text-primary-foreground shadow-sm"><span class="break-all"></span></div>'),Ii=i('<div class="flex max-w-[65%] animate-in flex-col items-end gap-1 self-end duration-300 fade-in slide-in-from-bottom-2"><!> <span class="pr-1 font-mono text-[10px] text-muted-foreground opacity-70"> </span></div>'),Ai=i('<span class="select-none"> </span>'),Ci=i('<div class="flex max-w-[90%] animate-in flex-col items-start gap-1 self-start duration-300 fade-in slide-in-from-bottom-2"><div class="flex gap-3"><div class="mt-1 flex size-8 shrink-0 items-center justify-center rounded-full border border-primary/10 bg-primary/10 text-primary shadow-sm"><!></div> <div class="flex min-w-0 flex-col gap-1"><div class="min-w-[300px] overflow-hidden rounded-lg border bg-card text-card-foreground shadow-sm"><div class="flex items-center justify-between gap-3 border-b bg-muted/30 px-3 py-2"><div class="flex min-w-0 items-center gap-2"><!> <span class="truncate text-sm font-medium"><span></span></span></div> <!></div> <div class="bg-background p-3 font-mono text-xs break-all select-text"><div></div></div></div> <div class="flex items-center gap-2 pl-1 font-mono text-[10px] text-muted-foreground opacity-70"><!> <span> </span></div></div></div></div>'),Li=i('<span class="mr-1 font-bold">ERROR:</span>'),Mi=i('<div class="flex max-w-[85%] animate-in flex-col items-start gap-1 self-start duration-300 fade-in slide-in-from-bottom-2"><div><!> <span class="break-all"></span></div> <span class="pl-1 font-mono text-[10px] text-muted-foreground opacity-70"> </span></div>'),ji=i('<div class="flex flex-col gap-4 pb-4"><!></div>'),Ni=i("<!> <!> <!>",1),Ei=i('<div class="mt-0.5 text-[11px] leading-4 text-muted-foreground"> </div>'),Oi=i("<div> </div> <!>",1),Bi=i("<!> <!>",1),Fi=i('<div class="rounded-md border border-destructive/20 bg-destructive/10 px-2 py-1 text-xs text-destructive"> </div> <div class="flex items-center gap-2"><!></div>',1),Di=i('<div class="space-y-2"><div class="text-sm">确认暂停当前任务？</div> <!> <div class="flex items-center gap-2"><!> <!></div></div>'),Ri=i("<!> <!>",1),Qi=i('<!> <span class="sr-only">继续</span>',1),Ui=i("<!> <!>",1),Hi=i('<!> <span class="sr-only">停止</span>',1),qi=i('<div class="rounded-md border border-destructive/20 bg-destructive/10 px-2 py-1 text-xs text-destructive"> </div> <div class="flex items-center gap-2"><!></div>',1),Gi=i('<div class="space-y-2"><div class="text-sm">确认停止当前任务？</div> <!> <div class="flex items-center gap-2"><!> <!></div></div>'),Vi=i("<!> <!>",1),Ki=i("<!> <!>",1),Wi=i("<!> <!> <!> <!>",1),Ji=i("<!> <!>",1),Xi=b=>b.preventDefault(),Yi=(b,l,f)=>l(e(f)),Zi=i('<button><div class="truncate"> </div> <!></button>'),ed=i('<div class="relative w-64"><!> <!></div> <!>',1),td=i("<!> <!>",1),rd=i("<!> <!>",1),ad=i("<!> <!>",1),sd=i("<!> <!>",1),od=i("<!> <!> <!> <!> <!> <!>",1),nd=i("<!> <!>",1),ld=i("<!> <!>",1),id=i('<div class="pointer-events-auto fixed inset-x-0 bottom-0 z-[60]"><div class="container mx-auto max-w-[1400px] px-4"><div><div class="absolute top-0 right-0 left-0 z-10 h-3 cursor-[ns-resize] touch-none bg-transparent"><div class="mx-auto mt-0.5 h-1 w-14 rounded-full bg-muted-foreground/60"></div></div> <div class="flex h-full"><div><div><!> <!></div> <!></div> <div class="flex flex-1 flex-col"><div class="flex items-center justify-between border-b-0 px-4 py-2"><div class="flex items-center gap-2"><!> <!> <!></div> <div class="flex items-center gap-2"><span class="text-xs text-muted-foreground">跟随滚动</span> <!> <div class="ml-2 flex items-center gap-0.5 border-l pl-2"><!> <!></div></div></div> <!> <div class="flex flex-col gap-3 border-t-0 px-4 py-3"><!></div></div></div></div></div></div>'),dd=i("<!> <!>",1),cd=i('<span data-slot="select-value" class="truncate"> </span>'),vd=i('<span class="text-muted-foreground"> </span>'),ud=i("<!> <!>",1),fd=i("<!> <!>",1),pd=i("<!> <!>",1),_d=i("<!> <!>",1),md=i("<!> <!>",1),gd=i("<!> <!> <!> <!> <!>",1),$d=i("<!> 保存",1),hd=i("<!> <!> <!>",1),xd=i("<!> <!>",1),bd=i("<!> <!>",1),yd=i("<!> <!>",1),Pd=i("<!> <!>",1),wd=i("<!> <!>",1),kd=i("<!> <!>",1),Sd=i("<!> <!>",1),zd=i("<!> <!>",1),Td=i('<div class="grid grid-cols-[200px_1fr] items-center gap-3"><div class="flex items-center gap-2"><!> <label class="text-xs text-muted-foreground" for="perf-smart">智能并发 (--smart)</label></div></div> <div class="grid grid-cols-[140px_1fr] items-start gap-3"><div class="flex items-start gap-6"><div class="space-y-2"><div class="text-xs text-muted-foreground">每秒请求上限 (-rl)</div> <!></div> <div class="space-y-2"><div class="text-xs text-muted-foreground">并发上限 (-c)</div> <!></div></div></div> <div class="space-y-2"><label class="text-xs text-muted-foreground" for="perf-timeout">超时秒数 (--timeout)</label> <!></div> <div class="space-y-2"><label class="text-xs text-muted-foreground" for="perf-retries">重试次数 (--retries)</label> <!></div>',1),Id=i('<div class="flex items-center gap-2"><!> <!></div>'),Ad=i('<span data-slot="select-value"> </span>'),Cd=i("<!> <!>",1),Ld=i("<!> <!>",1),Md=i('<div class="grid gap-3 md:grid-cols-2"><div class="space-y-2"><label class="text-xs text-muted-foreground" for="http-proxy">代理 (--proxy)</label> <!></div> <div class="space-y-2 md:col-span-2"><div class="text-xs text-muted-foreground">附加头部 (-H)</div> <div class="flex flex-col gap-2"><!> <div><!></div></div></div> <div class="space-y-2"><label class="text-xs text-muted-foreground" for="http-sort">排序 (--sort)</label> <!></div></div>'),jd=i('<span data-slot="select-value"> </span>'),Nd=i("<!> <!> <!> <!> <!>",1),Ed=i("<!> <!>",1),Od=i("<!> <!>",1),Bd=i("<!> <!>",1),Fd=i("<!> <!>",1),Dd=i("<!> <!>",1),Rd=i('<div class="space-y-4"><div class="space-y-2"><div class="text-xs text-muted-foreground">适配器 (--oob)</div> <!></div> <div class="grid grid-cols-[140px_1fr] items-start gap-3"><div class="flex items-start gap-6"><div class="space-y-2"><div class="text-xs text-muted-foreground">OOB 请求速率 (-orl)</div> <!></div> <div class="space-y-2"><div class="text-xs text-muted-foreground">OOB 并发上限 (-oc)</div> <!></div></div></div></div>'),Qd=i('<!> <!> <!> <div class="mt-4 space-y-2"><div class="text-xs text-muted-foreground">命令预览（仅包含变更项）</div> <div class="rounded-md border bg-muted p-3 text-xs"> </div> <div class="flex items-center gap-2"><!></div></div>',1),Ud=i("<!> <!>",1),Hd=i("<!> <!>",1),qd=i('<div class="container mx-auto max-w-[1400px] px-4"><!> <div class="flex items-center justify-between gap-2 py-2"><!> <!></div> <!></div>'),Gd=i("<!> <!>",1),Vd=i("<!> <!>",1),Kd=i('<div class="px-3 py-2 text-xs text-muted-foreground">请输入关键词搜索</div>'),Wd=(b,l,f)=>l(e(f)),Jd=(b,l,f)=>{b.key==="Enter"&&l(e(f))},Xd=i('<div role="button" tabindex="0" class="flex w-full items-center justify-between border-t px-3 py-2"><div class="flex items-center gap-2"><!> <span class="truncate text-xs"> </span> <!></div> <div class="flex items-center gap-2"><span class="text-xs text-muted-foreground"> </span> <!></div></div>'),Yd=i('<div class="flex items-center justify-between border-b px-3 py-2"><div class="flex items-center gap-2"><span class="truncate text-xs"> </span> <!></div> <!></div>'),Zd=i('<div class="px-3 py-2 text-xs text-muted-foreground">未选择 PoC（默认扫描全部）</div>'),ec=i('<div class="container mx-auto max-w-[1400px] px-4"><!> <div class="grid grid-cols-2 gap-4 py-2"><div class="space-y-2"><div class="flex items-center gap-2"><!> <!> <!> <!> <!></div> <div class="max-h-[60vh] overflow-auto rounded border"><!></div> <div class="flex items-center justify-between py-2"><div class="text-xs text-muted-foreground"> </div> <div class="flex items-center gap-2"><!> <div class="text-xs"> </div> <!> <div class="flex items-center gap-1"><!> <!></div></div></div></div> <div class="space-y-2"><div class="flex items-center justify-between"><div class="text-sm"> </div> <!></div> <div class="max-h-[60vh] overflow-auto rounded border"><!></div></div></div></div>'),tc=i("<!> <!>",1),rc=i("<!> <!>",1),ac=i('<div class="container mx-auto max-w-[1400px] px-4"><!> <!></div>'),sc=i("<!> <!>",1),oc=i("<!> <!>",1),nc=i("<!> <!>",1),lc=i("<!> <!>",1),ic=i("<!> <!>",1),dc=i("<!> <!>",1),cc=i("<!> <!>",1),vc=i("<!> <!>",1),uc=i("<!> <!>",1),fc=i('<div class="pointer-events-none fixed right-0 bottom-0 left-0 z-50"><div class="container mx-auto max-w-[1400px] px-4"><div class="pointer-events-auto flex h-9 items-center justify-between rounded-t-md border bg-card px-1 text-card-foreground shadow-sm"><div class="flex min-w-0 flex-1 items-center gap-2 px-2"><!> <!> <!></div> <div class="flex items-center gap-6 px-4"><!></div> <div class="flex items-center gap-1 px-1"><!></div></div></div> <!> <!> <!> <!> <!> <!></div>');function pc(b,l){sr(l,!0);let f=E(()=>Ee.expanded),$=E(()=>Ee.panelSnap);const x=["critical","high","medium","low","info"];let u=E(()=>Ee.activeTask),A=E(()=>Ee.tasks),Q=E(()=>e(u)?Ee.logs[e(u).id]||[]:[]),J=L(""),Ke=L(void 0);Kr(()=>{if(e(u)?.id===e(Ke))return;c(Ke,e(u)?.id,!0);const n=(e(u)?.targets||[]).filter(Boolean);c(J,n.length>0?n.join(`
`):e(u)?.target||"",!0)}),Kr(()=>{ne.loadSets()});let Ue=L(""),Vt=L(null),lt=L(null),kt=L(null),dr=L(!1),Ft=L(!1),Xe=L(!1),Ye=L(0);const Oe=E(()=>{const n=(e(Ue)||"").trim().toLowerCase();return n?(ne.sets||[]).filter(v=>((v.name||v.id||"")+"").toLowerCase().includes(n)):[]});function Dt(n){Promise.resolve().then(()=>ne.loadItems(n.id)).then(()=>{c(J,(ne.items||[]).join(`
`),!0),c(Ft,!1),c(Ue,(n.name||n.id||"")+"")}).catch(()=>{})}Kr(()=>{const n=!!(e(Ue)||"").trim();c(Ft,!!e(Xe)&&n,!0),e(Ye)>=e(Oe).length&&c(Ye,0)}),Kr(()=>{if(!e(Ft)||!e(kt))return;const n=e(Ye);xs().then(()=>{e(kt)?.querySelector(`button[data-asset-set-index="${n}"]`)?.scrollIntoView({block:"nearest"})})});let gr=E(()=>(e(J)||"").split(/\r?\n/).map(n=>n.trim()).filter(Boolean).length),Ht=E(()=>(e(J)||"").split(/\r?\n/).map(n=>n.trim()).filter(Boolean)),jt=E(()=>e(Ht).length===0?"":e(Ht)[0]);function $e(){const n=(e(J)||"").split(/\r?\n/).map(k=>k.trim()).filter(Boolean),v=Array.from(new aa(n));c(J,v.join(`
`),!0)}function at(n){if(typeof n!="string")return;const v=n.toLowerCase().trim();return x.includes(v)?v:void 0}let Fe=L(!1);async function Nt(){if(e(Fe))return;const n=(e(J)||"").split(/\r?\n/).map(q=>q.trim()).filter(Boolean).join(`
`);if(!n){Ie.error("内容为空");return}const k=(prompt("新集合名称",e(jt)||"新集合")||"").trim();if(k){c(Fe,!0);try{await ne.createSet(k,{content:n}),c(Ue,k,!0),Ie.success(`已保存为新集合：${k}`)}catch{Ie.error("保存失败")}finally{c(Fe,!1)}}}let vt=E(()=>e(A).filter(n=>n.id!==e(u)?.id&&(n.status==="running"||n.status==="starting"))),ut=E(()=>e(vt).length),Et=E(()=>e(vt).some(n=>(n.severityStats?.critical??0)>0||(n.severityStats?.high??0)>0)),Ze=E(()=>e(u)?.severityStats?.critical??0),Ot=E(()=>e(u)?.severityStats?.high??0),Kt=E(()=>e(u)?.severityStats?.medium??0),yt=E(()=>e(u)?.severityStats?.low??0),qt=L(!0),st=L(null),Wt=L("all"),Jt=L("");function Nr(n){if(n.type!=="info")return!1;const v=n.text||"";return v.includes("开始")||v.includes("暂停")||v.includes("停止")||v.includes("选择")||v.includes("User")||v.includes("Loading")||v.includes("Scan Started")||v.includes("Scan Completed")||v.includes("Scan Created")||v.includes("Targets:")||v.includes("OOB:")||v.includes("使用 PoC")}let Ur=E(()=>(e(Q)||[]).filter(n=>n.type==="hit"?e(Wt)==="all"?!0:Ms(n)===e(Wt):!!(n.type==="error"||Nr(n))).filter(n=>{const v=e(Jt).trim();return v?[n.pocName||"",n.url||"",n.text||"",n.label||""].join(" ").toLowerCase().includes(v.toLowerCase()):!0}));Kr(()=>{const n=e(Ur).length;e(qt)&&e(st)&&n>=0&&xs().then(()=>{e(st).scrollTop=e(st).scrollHeight})});let ea=L(!1),cr=L(!1);function Wr(n){const v=window.innerHeight,k=Math.max(.3,Math.min(1,(v-n)/v));Ee.setPanelSnap(k)}function Hr(){Ee.setPanelExpanded(!0)}function ft(){Ee.setPanelExpanded(!1)}function Xt(){c(cr,!e(cr))}let Yt=L(!1),oa=L(!1),_a=L(!1),At=L(!1),wr=L(""),Ct=L(""),Er=L(!1),$r=L(!1),Cr=L(!1),nr=L(xa([])),Zt=L("");Kr(()=>{e($r)&&Rt()});async function er(){if(!e(oa)){c(oa,!0),c(wr,"");try{const n=String(e(u)?.serverTaskId||e(u)?.id||"");if(!n)throw new Error("未找到任务标识");const v=await Ir.pauseScan(n);if(!!v?.success&&!!v.data?.paused)e(u)&&Ee.pause(e(u).id),Ie.success("已暂停");else{const q=String(v?.message||"暂停失败");c(wr,q,!0),Ie.error(q)}}catch(n){const v=n instanceof Error?n.message:"暂停失败";c(wr,v,!0),Ie.error(v)}finally{c(oa,!1)}}}async function hr(){if(!e(_a)){c(_a,!0);try{const n=String(e(u)?.serverTaskId||e(u)?.id||"");if(!n)throw new Error("未找到任务标识");const v=await Ir.resumeScan(n);if(!!v?.success&&!!v.data?.resumed)e(u)&&Ee.resume(e(u).id),Ie.success("已继续");else{const q=String(v?.message||"继续失败");Ie.error(q)}}catch(n){const v=n instanceof Error?n.message:"继续失败";Ie.error(v)}finally{c(_a,!1)}}}async function vr(){if(!e(At)){c(At,!0),c(Ct,"");try{const n=String(e(u)?.serverTaskId||e(u)?.id||"");if(!n)throw new Error("未找到任务标识");const v=await Ir.stopScan(n);if(!!v?.success&&!!v.data?.stopped)e(u)&&Ee.cancel(e(u).id),Ie.success("已停止");else{const q=String(v?.message||"停止失败");c(Ct,q,!0),Ie.error(q)}}catch(n){const v=n instanceof Error?n.message:"停止失败";c(Ct,v,!0),Ie.error(v)}finally{c(At,!1)}}}async function Lr(n){c($r,!0)}async function Rt(){c(Cr,!0);try{const n=await Ir.listInstances();c(nr,Array.isArray(n?.data?.instances)?n.data.instances:[],!0);const v=String(e(u)?.serverInstanceId||""),k=e(nr).find(He=>He.instance_id===v),q=e(nr).find(He=>He.base_url===String(e(u)?.serverBaseUrl||""));c(Zt,String((k||q||e(nr)[0]||{instance_id:""}).instance_id||""),!0)}catch(n){Ie.error(n instanceof Error?n.message:"加载实例失败")}finally{c(Cr,!1)}}async function kr(){if(!e(Zt)){Ie.error("请选择实例");return}c(Er,!0);try{const n=String(e(u)?.serverTaskId||e(u)?.id||""),v=await Ir.listInstances(),q=(Array.isArray(v?.data?.instances)?v.data.instances:[]).find(ka=>ka.instance_id===e(Zt));if(!q){Ie.error("实例不存在或已关闭"),c(Er,!1);return}const He=Array.isArray(q.active_task_ids)?q.active_task_ids:[];if(!n||!He.includes(n)){Ie.error("所选实例不包含当前任务，请选择正确实例或刷新"),c(Er,!1);return}const lr=await Ir.forceStopInstance(e(Zt),{taskId:n,confirm:!0});!!lr?.success&&!!lr.data?.stopped?(e(u)&&Ee.cancel(e(u).id),c(wr,""),c(Ct,""),c($r,!1),Ie.success("已强制关闭实例")):Ie.error(String(lr?.message||"强制关闭失败"))}catch(n){Ie.error(n instanceof Error?n.message:"强制关闭失败")}finally{c(Er,!1)}}function zr(){const n=Ee.createTask();Ee.setActiveTask(n)}function Mr(n){Ee.setActiveTask(n)}function tr(n){return n.split(/\r?\n/).map(v=>v.trim()).filter(Boolean)}let xr=L(!1),Dr=L("敏感操作确认"),Rr=L("当前目标包含内网或启用 OOB，是否继续？"),qr,Qt=[],Lt=L(!1),ur=L(!1),Jr=L(!1),Or=L("performance"),h=L(xa(bt.mergeWithBaseline({})));Kr(()=>{bt.load();const n=bt.getActiveMerged();(!n.http.headers||n.http.headers.length===0)&&(n.http.headers=[""]),c(h,n,!0)});function Br(){c(h,bt.getActiveMerged(),!0),(!e(h).http.headers||e(h).http.headers.length===0)&&(e(h).http.headers=[""])}function Oa(n){bt.setActive(n),Br()}function na(){const n=bt.create("新策略");bt.setActive(n),Br();const v=bt.getActive();Ie.success(`已新建策略：${v?.name||n}`)}function Gr(){const n=bt.getActive();if(!n){Ie.error("请先选择策略");return}const v=bt.duplicate(n.id);if(v){bt.setActive(v),Br();const k=bt.getActive();Ie.success(`已复制策略为：${k?.name||v}`)}else Ie.error("复制失败")}function Xr(){const n=bt.getActive();if(!n){Ie.error("未选择策略");return}bt.remove(n.id),Br(),Ie.success(`已删除策略：${n.name}`)}function ta(){e(h).http.headers=(e(h).http.headers||[]).map(n=>(n||"").trim()).filter(n=>n.length>0),bt.saveActive(e(h)),(!e(h).http.headers||e(h).http.headers.length===0)&&(e(h).http.headers=[""]),Ie.success("策略已保存")}function Aa(){const n=e(A).find(v=>v.status==="running"||v.status==="starting"||v.status==="paused");n&&Ee.setActiveTask(n.id),Hr()}async function Ba(){if(c(xr,!1),qr)await qr();else{if(e(Yt))return;e(u)&&(c(Yt,!0),Ee.begin(e(u).id,Qt).then(()=>{setTimeout(()=>c(Yt,!1),150)}).catch(()=>{c(Yt,!1)}))}}const Fa=async()=>{if(!e(Yt)){try{const n=new AbortController,v=setTimeout(()=>n.abort(),2e3),k=await Ir.getServerInfo({signal:n.signal});if(clearTimeout(v),k.success&&k.data){const{memory_usage:q=0,cpu_usage:He=0,active_task_count:lr=0}=k.data;if(lr>=4){Ie.error(`当前并发任务数已达浏览器连接池上限 (${lr}/4)。为防止界面卡死，请等待现有任务完成后再试。`);return}const Zr=q>80||He>90,ka=lr>=5;if(Zr||ka){c(Dr,"系统负载过高"),c(Rr,`当前系统负载较高 (内存: ${q.toFixed(1)}%, 任务数: ${lr})。继续创建任务可能会导致扫描速度变慢或不稳定。是否确认继续？`),qr=async()=>{await Ga()},c(xr,!0);return}}}catch(n){const v=n instanceof Error?n.name:"",k=n instanceof Error?n.message:"";if(v==="AbortError"||k==="timeout"){c(Dr,"系统响应超时"),c(Rr,"获取系统状态超时 (超过2s)，当前系统负载可能极高。继续创建任务可能会导致严重卡顿。是否确认继续？"),qr=async()=>{await Ga()},c(xr,!0);return}console.error("Failed to check server status",n)}await Ga()}},Ga=async()=>{const n=tr(e(J)||"");if(n.length===0){Ie.error("请先输入资产目标"),c(dr,!0),setTimeout(()=>e(lt)?.focus(),50);return}bt.getActiveMerged(),c(Yt,!0);try{const v=(e(u)?.pocs||[]).slice();let k="";e(u)&&e(u).status==="idle"?k=e(u).id:k=Ee.tasks.find(He=>He.status==="idle")?.id||"";const q=k||Ee.createTask("New Scan");if(Ee.setActiveTask(q),v.length)for(const He of v)Ee.addTaskPoc(q,{id:He.id,name:He.name,severity:He.severity});Ee.begin(q,n,1e3).then(()=>setTimeout(()=>c(Yt,!1),120)).catch(()=>c(Yt,!1))}catch(v){c(Yt,!1),Ie.error(v instanceof Error?v.message:"创建任务失败")}};function Va(n){const v=(e(J)||"").split(/\r?\n/).map(q=>q.trim()).filter(Boolean),k=Array.from(new aa([...v,...n.map(q=>q.trim()).filter(Boolean)]));c(J,k.join(`
`),!0)}let _s=L(!1),Ka=L(""),ma=new aa,Pa=L(xa([])),la=L(1),Wa=L(100),Da=L(0),ms=E(()=>Math.max(1,Math.ceil((e(Da)||0)/(e(Wa)||100)))),Ja=L("100");function _o(){c(_s,!0)}async function gs(){try{const n=new dn;(e(Ka)||"").trim()&&n.set("q",e(Ka).trim()),n.set("page",String(e(la))),n.set("page_size",String(e(Wa)));const v=await Ir.get(`/pocs?${n.toString()}`);if(v?.success&&v?.data){const k=v.data,q=k&&typeof k=="object"?k:null,He=Array.isArray(q?.items)?q.items:Array.isArray(k)?k:[];c(Pa,He,!0),c(Da,typeof q?.total=="number"?q.total:He.length,!0)}else c(Pa,[],!0),c(Da,0)}catch{c(Pa,[],!0),c(Da,0)}}async function As(){c(la,1),await gs()}async function Cs(n){const v=Math.max(1,e(ms)),k=Math.max(1,Math.min(v,n));c(la,k,!0),await gs()}async function mo(){await Cs(e(la)-1)}async function go(){await Cs(e(la)+1)}async function Ls(){const n=parseInt((e(Ja)||"").trim(),10);Number.isNaN(n)||n<=0||(c(Wa,n,!0),c(Ja,String(n),!0),c(la,1),await gs())}function $s(n){const v=n?.poc_id||String(n?.id||"");v&&(ma.has(v)?ma.delete(v):ma.add(v))}function $o(){ma.clear();for(const n of e(Pa)||[]){const v=n?.poc_id||String(n?.id||"");v&&ma.add(v)}}function ho(){ma.clear()}let Ca=L(!1),ga=L(!1),wa=L("");function xo(n){c(wa,n,!0),c(Ca,!0)}async function bo(){if(!e(wa)){c(Ca,!1);return}if(e(ga))return;const n=Ee.tasks.find(v=>v.id===e(wa));if(n&&["running","starting","paused"].includes(n.status)){c(ga,!0);try{const v=String(n.serverTaskId||n.id||""),k=await Ir.stopScan(v);if(!(!!k?.success&&!!k.data?.stopped)){Ie.error(String(k?.message||"停止任务失败，无法删除")),c(ga,!1);return}Ee.cancel(n.id)}catch(v){Ie.error(String(v instanceof Error?v.message:"停止任务失败，无法删除")),c(ga,!1);return}}try{if(Ee.removeTask(e(wa)),e(u)&&e(u).id===e(wa)){const v=Ee.tasks[0]?.id;v&&Ee.setActiveTask(v)}Ie.success("任务已删除"),c(Ca,!1),c(wa,"")}catch(v){Ie.error(String(v instanceof Error?v.message:"删除失败"))}finally{c(ga,!1)}}function yo(){let n=e(u);if(!n){const q=tr(e(J)),He=Ee.createTask("POC 扫描",q);Ee.setActiveTask(He),n=Ee.activeTask}const v=e(Pa)||[];let k=0;for(const q of v){const He=q?.poc_id||String(q?.id||"");if(He&&ma.has(He)){const lr=q?.name||He,Zr=at(q?.severity);Ee.addTaskPoc(n.id,{id:He,name:lr,severity:Zr}),k++}}Ie.success(`已加入 ${k} 个 PoC`)}function Po(n){let v=e(u);if(!v){const lr=tr(e(J)),Zr=Ee.createTask("POC 扫描",lr);Ee.setActiveTask(Zr),v=Ee.activeTask}const k=n?.poc_id||String(n?.id||""),q=n?.name||k,He=at(n?.severity);Ee.addTaskPoc(v.id,{id:k,name:q,severity:He}),Ie.success("已加入 1 个 PoC")}function Ms(n){return at(n?.severity)??(n?.type==="info"?"info":void 0)}function Xa(n){const v=new Date(n),k=String(v.getMonth()+1).padStart(2,"0"),q=String(v.getDate()).padStart(2,"0"),He=String(v.getHours()).padStart(2,"0"),lr=String(v.getMinutes()).padStart(2,"0"),Zr=String(v.getSeconds()).padStart(2,"0");return`${k}-${q} ${He}:${lr}:${Zr}`}function wo(n){if(!n)return"0s";if(n<1e3)return`${n}ms`;const v=Math.floor(n/1e3);if(v<60)return`${v}s`;const k=Math.floor(v/60),q=v%60;return q===0?`${k}m`:`${k}m ${q}s`}const ko=["critical","high","medium","low","info"];function ra(n,v){if(!n||typeof n!="object")return 0;const k=n[v];return typeof k=="number"&&Number.isFinite(k)?k:0}function js(n,v){if(!n||typeof n!="object")return"";const k=n[v];return typeof k=="string"?k:""}function So(n,v){if(!n||typeof n!="object")return!1;const k=n[v];return typeof k=="boolean"?k:!1}function Ns(n,v){if(!n||typeof n!="object")return[];const k=n[v];return Array.isArray(k)?k.filter(q=>typeof q=="string"):[]}function Yr(n,v){if(!n||typeof n!="object")return 0;const k=n.severityStats;if(!k||typeof k!="object")return 0;const q=k[v];return typeof q=="number"&&Number.isFinite(q)?q:0}function zo(n){if(!n||typeof n!="object")return!1;const v=n.severityStats;return!!v&&typeof v=="object"}function To(n){for(const v of ko)if(Yr(n,v)>0)return!0;return!1}function Io(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Es(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Ao(n){const v=(e(Jt)||"").trim(),k=Es(n||"");return v?k.split(new RegExp(`(${Io(Es(v))})`,"gi")).map((He,lr)=>lr%2===1?`<mark class="bg-yellow-400 text-black font-bold px-0.5 rounded-[2px] shadow-sm">${He}</mark>`:He).join(""):k}function Ra(n,v){const k=q=>{n.innerHTML=Ao(q||"")};return k(v),{update(q){k(q)}}}function Co(n){const v=Ms(n),k=`${Xa(n.ts)} ${n.pocName||""} ${(v||"").toUpperCase()} ${n.label||""} ${n.url||n.text||""}`.trim();navigator.clipboard.writeText(k).then(()=>Ie.success("已复制日志")).catch(()=>Ie.error("复制失败"))}var Os=N(),Lo=d(Os);a(Lo,()=>Cn,(n,v)=>{v(n,{children:(k,q)=>{var He=fc(),lr=o(He),Zr=o(lr),ka=o(Zr),Bs=o(ka);{var Mo=We=>{var pt=Ml(),Le=o(pt);let ir;var _t=r(Le,2),St=o(_t,!0);s(_t),s(pt),T((fr,qe)=>{ir=jr(Le,1,"size-2 shrink-0 rounded-full",null,ir,fr),Qa(_t,"title",qe),P(St,e(u).serverTaskId||e(u).id)},[()=>({"!bg-destructive":e(u).status==="failed","!bg-accent":e(u).status==="paused","!bg-secondary":e(u).status==="completed","!bg-primary":e(u).status==="running","!bg-muted":e(u).status==="starting"||e(u).status==="idle"}),()=>String(e(u).serverTaskId||e(u).id||"")]),t(We,pt)},jo=We=>{var pt=jl();p(2),t(We,pt)};H(Bs,We=>{e(u)?We(Mo):We(jo,!1)})}var Fs=r(Bs,2);{var No=We=>{var pt=N(),Le=d(pt);a(Le,()=>Na,(ir,_t)=>{_t(ir,{children:(St,fr)=>{var qe=Rl(),et=d(qe);a(et,()=>ja,(Tr,it)=>{it(Tr,{children:(Bt,Ut)=>{za(Bt,{variant:"outline",class:"h-5 cursor-pointer gap-1.5 px-1.5 font-normal transition-colors hover:bg-accent/50",children:(ot,zt)=>{var mt=El(),Ge=r(d(mt),2),V=o(Ge);s(Ge);var G=r(Ge,2);{var Ve=X=>{var fe=Nl();t(X,fe)};H(G,X=>{e(Et)&&X(Ve)})}T(()=>P(V,`+${e(ut)??""} 后台`)),t(ot,mt)},$$slots:{default:!0}})},$$slots:{default:!0}})});var br=r(et,2);a(br,()=>Ma,(Tr,it)=>{it(Tr,{class:"w-72 p-0",align:"start",side:"top",sideOffset:8,children:(Bt,Ut)=>{var ot=Dl(),zt=r(d(ot),2);Pr(zt,21,()=>e(vt),mt=>mt.id,(mt,Ge)=>{var V=Fl();V.__click=[Ol,Mr,Ge];var G=o(V),Ve=r(o(G),2),X=o(Ve,!0);s(Ve),s(G);var fe=r(G,2),Pe=o(fe);{var tt=Je=>{var rt=Bl(),ke=o(rt,!0);s(rt),T(()=>P(ke,e(Ge).severityStats?.critical)),t(Je,rt)};H(Pe,Je=>{(e(Ge).severityStats?.critical||0)>0&&Je(tt)})}var _e=r(Pe,2),Pt=o(_e);s(_e),s(fe),s(V),T(()=>{P(X,e(Ge).serverTaskId||e(Ge).id),P(Pt,`${e(Ge).progress.percent??""}%`)}),t(mt,V)}),s(zt),t(Bt,ot)},$$slots:{default:!0}})}),t(St,qe)},$$slots:{default:!0}})}),t(We,pt)};H(Fs,We=>{e(ut)>0&&We(No)})}var Eo=r(Fs,2);a(Eo,()=>Za,(We,pt)=>{pt(We,{get open(){return e($r)},set open(Le){c($r,Le,!0)},children:(Le,ir)=>{var _t=N(),St=d(_t);a(St,()=>es,(fr,qe)=>{qe(fr,{side:"right",class:"w-[420px]",children:(et,br)=>{var Tr=Gl(),it=r(o(Tr),2),Bt=o(it);s(it);var Ut=r(it,2),ot=o(Ut);ee(ot,{size:"sm",variant:"outline",onclick:()=>Rt(),get disabled(){return e(Cr)},children:(X,fe)=>{p();var Pe=g("刷新");t(X,Pe)},$$slots:{default:!0}});var zt=r(ot,2);ee(zt,{size:"sm",variant:"secondary",onclick:()=>c($r,!1),get disabled(){return e(Er)},children:(X,fe)=>{p();var Pe=g("取消");t(X,Pe)},$$slots:{default:!0}});var mt=r(zt,2);{let X=E(()=>e(Er)||!e(Zt));ee(mt,{size:"sm",variant:"destructive",onclick:()=>kr(),get disabled(){return e(X)},children:(fe,Pe)=>{p();var tt=g("确认强制关闭");t(fe,tt)},$$slots:{default:!0}})}s(Ut);var Ge=r(Ut,2),V=o(Ge);{var G=X=>{var fe=Ql();t(X,fe)},Ve=X=>{var fe=N(),Pe=d(fe);{var tt=Pt=>{var Je=Ul();t(Pt,Je)},_e=Pt=>{var Je=N(),rt=d(Je);Pr(rt,17,()=>e(nr),ke=>ke.instance_id,(ke,Tt)=>{var le=ql(),ve=o(le),he=o(ve),dt=o(he,!0);s(he);var xe=r(he,2),be=o(xe,!0);s(xe);var nt=r(xe,2);{var Se=Me=>{var te=Hl(),me=o(te);s(te),T(()=>P(me,`PID ${e(Tt).pid??""}`)),t(Me,te)};H(nt,Me=>{e(Tt).pid&&Me(Se)})}s(ve);var ue=r(ve,2),pe=o(ue);{let Me=E(()=>e(Zt)===e(Tt).instance_id?"default":"outline");ee(pe,{size:"sm",get variant(){return e(Me)},onclick:()=>c(Zt,e(Tt).instance_id,!0),children:(te,me)=>{p();var Ae=g("选择");t(te,Ae)},$$slots:{default:!0}})}s(ue),s(le),T(()=>{P(dt,e(Tt).base_url),P(be,e(Tt).instance_id)}),t(ke,le)}),t(Pt,Je)};H(Pe,Pt=>{e(nr).length===0?Pt(tt):Pt(_e,!1)},!0)}t(X,fe)};H(V,X=>{e(Cr)?X(G):X(Ve,!1)})}s(Ge),s(Tr),T(()=>P(Bt,`任务 ${e(u)?.serverTaskId??""} · 来源 ${e(u)?.serverBaseUrl??""}`)),t(et,Tr)},$$slots:{default:!0}})}),t(Le,_t)},$$slots:{default:!0}})}),s(ka);var hs=r(ka,2),Oo=o(hs);{var Bo=We=>{var pt=Yl(),Le=d(pt),ir=o(Le);{var _t=V=>{var G=Vl(),Ve=r(o(G));s(G),T(()=>P(Ve,` CRIT:${e(Ze)??""}`)),t(V,G)};H(ir,V=>{e(Ze)>0&&V(_t)})}var St=r(ir,2);{var fr=V=>{var G=Kl(),Ve=r(o(G));s(G),T(()=>P(Ve,` HIGH:${e(Ot)??""}`)),t(V,G)};H(St,V=>{e(Ot)>0&&V(fr)})}var qe=r(St,2);{var et=V=>{var G=Wl(),Ve=r(o(G));s(G),T(()=>P(Ve,` MED:${e(Kt)??""}`)),t(V,G)};H(qe,V=>{e(Kt)>0&&V(et)})}var br=r(qe,2);{var Tr=V=>{var G=Jl(),Ve=r(o(G));s(G),T(()=>P(Ve,` LOW:${e(yt)??""}`)),t(V,G)};H(br,V=>{e(yt)>0&&V(Tr)})}var it=r(br,2);{var Bt=V=>{var G=Xl();t(V,G)};H(it,V=>{e(Ze)===0&&e(Ot)===0&&e(Kt)===0&&e(yt)===0&&V(Bt)})}s(Le);var Ut=r(Le,2),ot=o(Ut),zt=o(ot);s(ot);var mt=r(ot,2),Ge=o(mt);s(mt),s(Ut),T(()=>{zs(zt,`width: ${e(u).progress.percent}%`),P(Ge,`${e(u).progress.percent??""}%`)}),t(We,pt)};H(Oo,We=>{e(u)&&We(Bo)})}s(hs);var Ds=r(hs,2),Fo=o(Ds);ee(Fo,{variant:"ghost",size:"icon-sm","aria-label":"展开面板",onclick:Aa,children:(We,pt)=>{var Le=Zl(),ir=d(Le);an(ir,{class:"size-4"}),p(2),t(We,Le)},$$slots:{default:!0}}),s(Ds),s(Zr),s(lr);var Rs=r(lr,2);{var Do=We=>{var pt=id(),Le=o(pt),ir=o(Le);let _t;var St=o(ir);St.__pointerdown=[Ll,ea,Wr];var fr=r(St,2),qe=o(fr),et=o(qe),br=o(et);{var Tr=le=>{var ve=ei();t(le,ve)};H(br,le=>{e(cr)||le(Tr)})}var it=r(br,2);{var Bt=le=>{var ve=ti(),he=o(ve);ee(he,{size:"icon-sm",variant:"ghost",onclick:zr,"aria-label":"新建任务",children:(dt,xe)=>{$a(dt,{})},$$slots:{default:!0}}),s(ve),t(le,ve)},Ut=le=>{ee(le,{size:"icon-sm",variant:"ghost",onclick:zr,children:(ve,he)=>{$a(ve,{})},$$slots:{default:!0}})};H(it,le=>{e(cr)?le(Bt):le(Ut,!1)})}s(et);var ot=r(et,2);{var zt=le=>{var ve=N(),he=d(ve);a(he,()=>ya,(dt,xe)=>{xe(dt,{class:"flex-1 border-t",children:(be,nt)=>{var Se=oi(),ue=d(Se);a(ue,()=>ba,(te,me)=>{me(te,{class:"h-full w-full",children:(Ae,I)=>{var O=N(),de=d(O);Pr(de,19,()=>e(A),(B,_)=>`${B.id}-${_}`,(B,_)=>{var K=si(),m=o(K);m.__click=[ri,Mr,_];var re=o(m),ae=o(re);let wt;var gt=r(ae,2),ze=o(gt);s(gt),s(re);var Re=r(re,2),je=o(Re),ct=o(je);s(je),s(Re),s(m);var we=r(m,2);we.__click=[ai,xo,_];var De=o(we);Vs(De,{class:"size-3.5"}),s(we),s(K),T(j=>{jr(m,1,`flex w-full items-center justify-between border-t px-3 py-2 text-left first:border-t-0 ${e(u)&&e(_).id===e(u).id?"bg-muted":"hover:bg-muted/50"}`,"svelte-1k5an9e"),wt=jr(ae,1,"size-2 shrink-0 rounded-full",null,wt,j),P(ze,`${(e(_).serverTaskId||e(_).id)??""}${e(_).poc?` · ${e(_).poc.name}`:""}${` · 已选 ${e(_).pocs?.length||0} 个 PoC`}`),P(ct,`${e(_).progress.percent??""}%`)},[()=>({"!bg-destructive":e(_).status==="failed","!bg-accent":e(_).status==="paused","!bg-secondary":e(_).status==="completed","!bg-primary":e(_).status==="running","!bg-muted":e(_).status==="starting"||e(_).status==="idle"})]),t(B,K)}),t(Ae,O)},$$slots:{default:!0}})});var pe=r(ue,2);a(pe,()=>fa,(te,me)=>{me(te,{orientation:"vertical",children:(Ae,I)=>{var O=N(),de=d(O);a(de,()=>pa,(B,_)=>{_(B,{})}),t(Ae,O)},$$slots:{default:!0}})});var Me=r(pe,2);a(Me,()=>Ta,(te,me)=>{me(te,{})}),t(be,Se)},$$slots:{default:!0}})}),t(le,ve)},mt=le=>{var ve=N(),he=d(ve);a(he,()=>ya,(dt,xe)=>{xe(dt,{class:"flex-1 border-t",children:(be,nt)=>{var Se=ii(),ue=d(Se);a(ue,()=>ba,(te,me)=>{me(te,{class:"h-full w-full",children:(Ae,I)=>{var O=N(),de=d(O);Pr(de,19,()=>e(A),(B,_)=>`${B.id}-${_}`,(B,_,K)=>{var m=li();m.__click=[ni,Mr,_];var re=o(m);let ae;var wt=r(re,2),gt=o(wt);s(wt),s(m),T((ze,Re)=>{jr(m,1,`group flex w-full items-center justify-center border-t py-2 first:border-t-0 ${e(u)&&e(_).id===e(u).id?"bg-muted":"hover:bg-muted/50"}`,"svelte-1k5an9e"),Qa(m,"aria-label",ze),Qa(m,"title",`${e(_).serverTaskId||e(_).id} · ${e(_).progress.percent}%`),ae=jr(re,1,"block h-1.5 w-1.5 rounded-full",null,ae,Re),P(gt,`${e(_).progress.percent??""}%`)},[()=>`切换任务 ${String(e(K)+1)}`,()=>({"!bg-destructive":e(_).status==="failed","!bg-accent":e(_).status==="paused","!bg-secondary":e(_).status==="completed","!bg-primary":e(_).status==="running","!bg-muted":e(_).status==="starting"||e(_).status==="idle"})]),t(B,m)}),t(Ae,O)},$$slots:{default:!0}})});var pe=r(ue,2);a(pe,()=>fa,(te,me)=>{me(te,{orientation:"vertical",children:(Ae,I)=>{var O=N(),de=d(O);a(de,()=>pa,(B,_)=>{_(B,{})}),t(Ae,O)},$$slots:{default:!0}})});var Me=r(pe,2);a(Me,()=>Ta,(te,me)=>{me(te,{})}),t(be,Se)},$$slots:{default:!0}})}),t(le,ve)};H(ot,le=>{e(cr)?le(mt,!1):le(zt)})}s(qe);var Ge=r(qe,2),V=o(Ge),G=o(V),Ve=o(G);ee(Ve,{size:"icon-sm",variant:"ghost","aria-label":"日志与侧栏",onclick:Xt,children:(le,ve)=>{Gs(le,{})},$$slots:{default:!0}});var X=r(Ve,2);a(X,()=>ts,(le,ve)=>{ve(le,{type:"single",get value(){return e(Wt)},onValueChange:he=>{c(Wt,he,!0)},children:(he,dt)=>{var xe=vi(),be=d(xe);a(be,()=>rs,(Se,ue)=>{ue(Se,{size:"sm","aria-label":"严重级",children:(pe,Me)=>{var te=di(),me=o(te,!0);s(te),T(Ae=>P(me,Ae),[()=>e(Wt)==="all"?"ALL":e(Wt).toUpperCase()]),t(pe,te)},$$slots:{default:!0}})});var nt=r(be,2);a(nt,()=>as,(Se,ue)=>{ue(Se,{class:"min-w-40",children:(pe,Me)=>{var te=ci(),me=d(te);a(me,()=>Fr,(_,K)=>{K(_,{value:"all",children:(m,re)=>{p();var ae=g("ALL");t(m,ae)},$$slots:{default:!0}})});var Ae=r(me,2);a(Ae,()=>Fr,(_,K)=>{K(_,{value:"critical",children:(m,re)=>{p();var ae=g("CRITICAL");t(m,ae)},$$slots:{default:!0}})});var I=r(Ae,2);a(I,()=>Fr,(_,K)=>{K(_,{value:"high",children:(m,re)=>{p();var ae=g("HIGH");t(m,ae)},$$slots:{default:!0}})});var O=r(I,2);a(O,()=>Fr,(_,K)=>{K(_,{value:"medium",children:(m,re)=>{p();var ae=g("MEDIUM");t(m,ae)},$$slots:{default:!0}})});var de=r(O,2);a(de,()=>Fr,(_,K)=>{K(_,{value:"low",children:(m,re)=>{p();var ae=g("LOW");t(m,ae)},$$slots:{default:!0}})});var B=r(de,2);a(B,()=>Fr,(_,K)=>{K(_,{value:"info",children:(m,re)=>{p();var ae=g("INFO");t(m,ae)},$$slots:{default:!0}})}),t(pe,te)},$$slots:{default:!0}})}),t(he,xe)},$$slots:{default:!0}})});var fe=r(X,2);sa(fe,{class:"h-8 w-48",placeholder:"搜索日志",get value(){return e(Jt)},set value(le){c(Jt,le,!0)}}),s(G);var Pe=r(G,2),tt=r(o(Pe),2);to(tt,{get checked(){return e(qt)},set checked(le){c(qt,le,!0)}});var _e=r(tt,2),Pt=o(_e);a(Pt,()=>ca,(le,ve)=>{ve(le,{children:(he,dt)=>{var xe=ui(),be=d(xe);a(be,()=>va,(Se,ue)=>{ue(Se,{children:(pe,Me)=>{{let te=E(()=>e($)>=.9?"还原":"最大化");ee(pe,{variant:"ghost",size:"icon-sm",class:"h-7 w-7 text-muted-foreground hover:text-foreground",get"aria-label"(){return e(te)},onclick:()=>Ee.setPanelSnap(e($)>=.9?.33:1),children:(me,Ae)=>{var I=N(),O=d(I);{var de=_=>{on(_,{class:"size-4"})},B=_=>{nn(_,{class:"size-3.5"})};H(O,_=>{e($)>=.9?_(de):_(B,!1)})}t(me,I)},$$slots:{default:!0}})}},$$slots:{default:!0}})});var nt=r(be,2);a(nt,()=>ua,(Se,ue)=>{ue(Se,{children:(pe,Me)=>{p();var te=g();T(()=>P(te,e($)>=.9?"还原":"最大化")),t(pe,te)},$$slots:{default:!0}})}),t(he,xe)},$$slots:{default:!0}})});var Je=r(Pt,2);a(Je,()=>ca,(le,ve)=>{ve(le,{children:(he,dt)=>{var xe=fi(),be=d(xe);a(be,()=>va,(Se,ue)=>{ue(Se,{children:(pe,Me)=>{ee(pe,{variant:"ghost",size:"icon-sm",class:"h-7 w-7 text-muted-foreground hover:text-foreground","aria-label":"最小化",onclick:ft,children:(te,me)=>{Sa(te,{class:"size-4"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var nt=r(be,2);a(nt,()=>ua,(Se,ue)=>{ue(Se,{children:(pe,Me)=>{p();var te=g("最小化");t(pe,te)},$$slots:{default:!0}})}),t(he,xe)},$$slots:{default:!0}})}),s(_e),s(Pe),s(V);var rt=r(V,2);a(rt,()=>ya,(le,ve)=>{ve(le,{class:"flex-1 overflow-hidden",children:(he,dt)=>{var xe=Ni(),be=d(xe);a(be,()=>ba,(ue,pe)=>{pe(ue,{class:"h-full w-full px-4 py-4",get ref(){return e(st)},set ref(Me){c(st,Me,!0)},children:(Me,te)=>{var me=ji(),Ae=o(me);{var I=de=>{var B=pi(),_=o(B);Gs(_,{class:"mb-2 size-10 opacity-20"}),p(2),s(B),t(de,B)},O=de=>{var B=N(),_=d(B);Pr(_,19,()=>e(Ur),(K,m)=>`${K.ts}-${m}`,(K,m)=>{var re=N(),ae=d(re);{var wt=ze=>{var Re=Ii(),je=o(Re);{var ct=F=>{var C=hi(),ye=o(C),M=o(ye);Ws(M,{class:"size-4"}),p(2),s(ye);var D=r(ye,2),ce=r(o(D),2),y=o(ce,!0);s(ce);var w=r(ce,4),z=o(w,!0);s(w);var W=r(w,4),S=o(W,!0);s(W);var Y=r(W,2);{var Z=se=>{var oe=_i(),ge=r(d(oe),2),ie=o(ge,!0);s(ge),T(($t,ht)=>{jr(ge,1,$t,"svelte-1k5an9e"),P(ie,ht)},[()=>`text-right font-mono font-bold ${So(e(m).data,"oob_enabled")?"text-green-300":"text-yellow-300"}`,()=>js(e(m).data,"oob_status")]),t(se,oe)};H(Y,se=>{js(e(m).data,"oob_status")&&se(Z)})}s(D);var R=r(D,2);{var U=se=>{var oe=$i(),ge=o(oe),ie=r(o(ge),2),$t=o(ie);{var ht=Be=>{var Te=g("显示前 5 条");t(Be,Te)},Mt=Be=>{var Te=g();T(Ne=>P(Te,`共 ${Ne??""} 条`),[()=>ra(e(m).data,"total_targets")]),t(Be,Te)};H($t,Be=>{ra(e(m).data,"total_targets")>5?Be(ht):Be(Mt,!1)})}s(ie),s(ge);var pr=r(ge,2),rr=o(pr);Pr(rr,19,()=>Ns(e(m).data,"targets").slice(0,5),(Be,Te)=>`${Be}-${Te}`,(Be,Te,Ne,Sr)=>{var xt=mi(),Qe=r(o(xt),2);Ua(Qe,(Ce,yr)=>Ra?.(Ce,yr),()=>e(Te)),s(xt),t(Be,xt)});var It=r(rr,2);{var Vr=Be=>{var Te=gi(),Ne=o(Te);s(Te),T(Sr=>P(Ne,`... 还有 ${Sr??""} 个目标`),[()=>ra(e(m).data,"total_targets")-5]),t(Be,Te)};H(It,Be=>{ra(e(m).data,"total_targets")>5&&Be(Vr)})}s(pr),s(oe),t(se,oe)};H(R,se=>{Ns(e(m).data,"targets").length>0&&se(U)})}s(C),T((se,oe,ge)=>{P(y,se),P(z,oe),P(S,ge)},[()=>ra(e(m).data,"total_targets"),()=>ra(e(m).data,"total_pocs"),()=>ra(e(m).data,"total_scans")]),t(F,C)},we=F=>{var C=N(),ye=d(C);{var M=ce=>{var y=zi(),w=o(y),z=o(w);un(z,{class:"size-4"}),p(2),s(w);var W=r(w,2),S=r(o(W),2),Y=o(S,!0);s(S);var Z=r(S,4),R=o(Z);s(Z),s(W);var U=r(W,2);{var se=oe=>{var ge=Si(),ie=r(o(ge),2),$t=o(ie);{var ht=Qe=>{var Ce=xi(),yr=r(o(Ce),2),Qr=o(yr,!0);s(yr),s(Ce),T(ia=>P(Qr,ia),[()=>Yr(e(m).data,"critical")]),t(Qe,Ce)};H($t,Qe=>{Yr(e(m).data,"critical")>0&&Qe(ht)})}var Mt=r($t,2);{var pr=Qe=>{var Ce=bi(),yr=r(o(Ce),2),Qr=o(yr,!0);s(yr),s(Ce),T(ia=>P(Qr,ia),[()=>Yr(e(m).data,"high")]),t(Qe,Ce)};H(Mt,Qe=>{Yr(e(m).data,"high")>0&&Qe(pr)})}var rr=r(Mt,2);{var It=Qe=>{var Ce=yi(),yr=r(o(Ce),2),Qr=o(yr,!0);s(yr),s(Ce),T(ia=>P(Qr,ia),[()=>Yr(e(m).data,"medium")]),t(Qe,Ce)};H(rr,Qe=>{Yr(e(m).data,"medium")>0&&Qe(It)})}var Vr=r(rr,2);{var Be=Qe=>{var Ce=Pi(),yr=r(o(Ce),2),Qr=o(yr,!0);s(yr),s(Ce),T(ia=>P(Qr,ia),[()=>Yr(e(m).data,"low")]),t(Qe,Ce)};H(Vr,Qe=>{Yr(e(m).data,"low")>0&&Qe(Be)})}var Te=r(Vr,2);{var Ne=Qe=>{var Ce=wi(),yr=r(o(Ce),2),Qr=o(yr,!0);s(yr),s(Ce),T(ia=>P(Qr,ia),[()=>Yr(e(m).data,"info")]),t(Qe,Ce)};H(Te,Qe=>{Yr(e(m).data,"info")>0&&Qe(Ne)})}s(ie);var Sr=r(ie,2);{var xt=Qe=>{var Ce=ki();t(Qe,Ce)};H(Sr,Qe=>{To(e(m).data)||Qe(xt)})}s(ge),t(oe,ge)};H(U,oe=>{zo(e(m).data)&&oe(se)})}s(y),T((oe,ge,ie)=>{P(Y,oe),P(R,`${ge??""} / ${ie??""}`)},[()=>wo(ra(e(m).data,"duration")),()=>ra(e(m).data,"finished"),()=>ra(e(m).data,"total")]),t(ce,y)},D=ce=>{var y=Ti(),w=o(y);Ua(w,(z,W)=>Ra?.(z,W),()=>e(m).text),s(y),t(ce,y)};H(ye,ce=>{e(m).text==="Scan Completed"?ce(M):ce(D,!1)},!0)}t(F,C)};H(je,F=>{e(m).text==="Scan Started"?F(ct):F(we,!1)})}var De=r(je,2),j=o(De,!0);s(De),s(Re),T(F=>P(j,F),[()=>Xa(e(m).ts)]),t(ze,Re)},gt=ze=>{var Re=N(),je=d(Re);{var ct=De=>{var j=Ci(),F=o(j),C=o(F),ye=o(C);cn(ye,{class:"size-5"}),s(C);var M=r(C,2),D=o(M),ce=o(D),y=o(ce),w=o(y);{let ie=E(()=>`h-5 rounded-sm px-1.5 text-[10px] font-bold tracking-wider uppercase ${jn(e(m).severity||"")}`);za(w,{variant:"secondary",get class(){return e(ie)},children:($t,ht)=>{p();var Mt=g();T(()=>P(Mt,e(m).severity)),t($t,Mt)},$$slots:{default:!0}})}var z=r(w,2),W=o(z);Ua(W,(ie,$t)=>Ra?.(ie,$t),()=>e(m).pocName||""),s(z),s(y);var S=r(y,2);ee(S,{variant:"ghost",size:"icon-sm",class:"h-6 w-6 shrink-0",onclick:()=>Co(e(m)),children:(ie,$t)=>{vn(ie,{class:"size-3"})},$$slots:{default:!0}}),s(ce);var Y=r(ce,2),Z=o(Y);Ua(Z,(ie,$t)=>Ra?.(ie,$t),()=>e(m).url||e(m).text||""),s(Y),s(D);var R=r(D,2),U=o(R);{var se=ie=>{var $t=Ai(),ht=o($t);s($t),T(()=>P(ht,`#${e(m).seq??""}`)),t(ie,$t)};H(U,ie=>{e(m).seq&&ie(se)})}var oe=r(U,2),ge=o(oe,!0);s(oe),s(R),s(M),s(F),s(j),T(ie=>{Qa(z,"title",e(m).pocName||""),P(ge,ie)},[()=>Xa(e(m).ts)]),t(De,j)},we=De=>{var j=Mi(),F=o(j),C=o(F);{var ye=y=>{var w=Li();t(y,w)};H(C,y=>{e(m).type==="error"&&y(ye)})}var M=r(C,2);Ua(M,(y,w)=>Ra?.(y,w),()=>e(m).text),s(F);var D=r(F,2),ce=o(D,!0);s(D),s(j),T(y=>{jr(F,1,`rounded-2xl rounded-tl-sm px-4 py-2.5 text-sm leading-relaxed shadow-sm ${e(m).type==="error"?"border border-destructive/20 bg-destructive/10 text-destructive":"bg-muted text-foreground/90"}`,"svelte-1k5an9e"),P(ce,y)},[()=>Xa(e(m).ts)]),t(De,j)};H(je,De=>{e(m).type==="hit"?De(ct):De(we,!1)},!0)}t(ze,Re)};H(ae,ze=>{Nr(e(m))?ze(wt):ze(gt,!1)})}t(K,re)}),t(de,B)};H(Ae,de=>{e(Ur).length===0?de(I):de(O,!1)})}s(me),t(Me,me)},$$slots:{default:!0}})});var nt=r(be,2);a(nt,()=>fa,(ue,pe)=>{pe(ue,{orientation:"vertical",children:(Me,te)=>{var me=N(),Ae=d(me);a(Ae,()=>pa,(I,O)=>{O(I,{})}),t(Me,me)},$$slots:{default:!0}})});var Se=r(nt,2);a(Se,()=>Ta,(ue,pe)=>{pe(ue,{})}),t(he,xe)},$$slots:{default:!0}})});var ke=r(rt,2),Tt=o(ke);a(Tt,()=>Na,(le,ve)=>{ve(le,{get open(){return e(dr)},set open(he){c(dr,he,!0)},children:(he,dt)=>{var xe=ld(),be=d(xe);a(be,()=>ja,(Se,ue)=>{ue(Se,{children:(pe,Me)=>{var te=N(),me=d(te);a(me,()=>ha,(Ae,I)=>{I(Ae,{class:"flex-1",children:(O,de)=>{var B=Ji(),_=d(B);a(_,()=>da,(m,re)=>{re(m,{align:"block-start",class:"py-1",children:(ae,wt)=>{var gt=Oi(),ze=d(gt),Re=o(ze,!0);s(ze);var je=r(ze,2);{var ct=we=>{var De=Ei(),j=o(De);s(De),T(()=>P(j,`…（共 ${e(Ht).length??""} 条）`)),t(we,De)};H(je,we=>{e(Ht).length>1&&we(ct)})}T(()=>{jr(ze,1,`truncate text-sm leading-4 ${e(jt)?"text-foreground":"text-muted-foreground"}`,"svelte-1k5an9e"),P(Re,e(jt)||"输入资产或从地址库选择...")}),t(ae,gt)},$$slots:{default:!0}})});var K=r(_,2);a(K,()=>da,(m,re)=>{re(m,{align:"inline-end",onclick:ae=>{ae.stopPropagation()},children:(ae,wt)=>{var gt=Wi(),ze=d(gt);a(ze,()=>Gt,(j,F)=>{F(j,{variant:"ghost","aria-label":"打开 PoC 选择器",onpointerdown:C=>C.stopPropagation(),onmousedown:C=>C.stopPropagation(),onclick:C=>{C.stopPropagation(),_o()},children:(C,ye)=>{p();var M=g();T(()=>P(M,(e(u)?.pocs?.length||0)>0?`已选${e(u)?.pocs?.length}个`:"全部 PoCs")),t(C,M)},$$slots:{default:!0}})});var Re=r(ze,2);a(Re,()=>Gt,(j,F)=>{F(j,{variant:"ghost","aria-label":"打开扫描策略",onpointerdown:C=>C.stopPropagation(),onmousedown:C=>C.stopPropagation(),onclick:C=>{C.stopPropagation(),c(Lt,!0)},children:(C,ye)=>{p();var M=g();T(D=>P(M,D),[()=>bt.getActive()?.name||"选择策略"]),t(C,M)},$$slots:{default:!0}})});var je=r(Re,2);{var ct=j=>{var F=N(),C=d(F);a(C,()=>ca,(ye,M)=>{M(ye,{children:(D,ce)=>{var y=Bi(),w=d(y);{const W=(S,Y)=>{let Z=()=>Y?.().props;var R=N(),U=d(R);{let se=E(()=>e(Yt)||e(Ht).length===0);a(U,()=>Gt,(oe,ge)=>{ge(oe,_r(Z,{variant:"outline",class:"cursor-pointer rounded-md",size:"icon-sm",get disabled(){return e(se)},"aria-label":"开始",onpointerdown:ie=>ie.stopPropagation(),onmousedown:ie=>ie.stopPropagation(),onclick:ie=>{ie.stopPropagation(),Fa()},children:(ie,$t)=>{fn(ie,{})},$$slots:{default:!0}}))})}t(S,R)};a(w,()=>va,(S,Y)=>{Y(S,{child:W,$$slots:{child:!0}})})}var z=r(w,2);a(z,()=>ua,(W,S)=>{S(W,{side:"top",align:"center",children:(Y,Z)=>{p();var R=g("开始");t(Y,R)},$$slots:{default:!0}})}),t(D,y)},$$slots:{default:!0}})}),t(j,F)};H(je,j=>{(!e(u)||["idle","completed","failed","cancelled"].includes(e(u).status))&&j(ct)})}var we=r(je,2);{var De=j=>{var F=Ki(),C=d(F);{var ye=y=>{var w=N(),z=d(w);a(z,()=>Na,(W,S)=>{S(W,{children:(Y,Z)=>{var R=Ri(),U=d(R);{const oe=(ge,ie)=>{let $t=()=>ie?.().props;var ht=N(),Mt=d(ht);a(Mt,()=>Gt,(pr,rr)=>{rr(pr,_r($t,{variant:"outline",class:"rounded-md",size:"icon-sm","aria-label":"暂停",get disabled(){return e(oa)},onpointerdown:It=>It.stopPropagation(),onmousedown:It=>It.stopPropagation(),children:(It,Vr)=>{pn(It,{})},$$slots:{default:!0}}))}),t(ge,ht)};a(U,()=>ja,(ge,ie)=>{ie(ge,{child:oe,$$slots:{child:!0}})})}var se=r(U,2);a(se,()=>Ma,(oe,ge)=>{ge(oe,{align:"center",sideOffset:6,class:"w-64 p-3",children:(ie,$t)=>{var ht=Di(),Mt=r(o(ht),2);{var pr=Be=>{var Te=Fi(),Ne=d(Te),Sr=o(Ne,!0);s(Ne);var xt=r(Ne,2),Qe=o(xt);ee(Qe,{size:"sm",variant:"destructive",get disabled(){return e(Er)},onclick:Ce=>{Ce.stopPropagation(),Lr()},children:(Ce,yr)=>{p();var Qr=g("强制关闭");t(Ce,Qr)},$$slots:{default:!0}}),s(xt),T(()=>P(Sr,e(wr))),t(Be,Te)};H(Mt,Be=>{e(wr)&&Be(pr)})}var rr=r(Mt,2),It=o(rr);{const Be=(Te,Ne)=>{let Sr=()=>Ne?.().props;ee(Te,_r(Sr,{size:"sm",variant:"destructive",get disabled(){return e(oa)},onclick:xt=>{Sr()?.onclick?.(xt),er()},children:(xt,Qe)=>{p();var Ce=g("确认暂停");t(xt,Ce)},$$slots:{default:!0}}))};a(It,()=>ss,(Te,Ne)=>{Ne(Te,{child:Be,$$slots:{child:!0}})})}var Vr=r(It,2);{const Be=(Te,Ne)=>{ee(Te,_r(()=>Ne?.().props,{size:"sm",variant:"secondary",children:(xt,Qe)=>{p();var Ce=g("取消");t(xt,Ce)},$$slots:{default:!0}}))};a(Vr,()=>ss,(Te,Ne)=>{Ne(Te,{child:Be,$$slots:{child:!0}})})}s(rr),s(ht),t(ie,ht)},$$slots:{default:!0}})}),t(Y,R)},$$slots:{default:!0}})}),t(y,w)},M=y=>{var w=N(),z=d(w);{var W=S=>{var Y=N(),Z=d(Y);a(Z,()=>ca,(R,U)=>{U(R,{children:(se,oe)=>{var ge=Ui(),ie=d(ge);{const ht=(Mt,pr)=>{let rr=()=>pr?.().props;var It=N(),Vr=d(It);a(Vr,()=>Gt,(Be,Te)=>{Te(Be,_r(rr,{variant:"outline",class:"rounded-md",size:"icon-sm","aria-label":"继续",get disabled(){return e(_a)},onpointerdown:Ne=>Ne.stopPropagation(),onmousedown:Ne=>Ne.stopPropagation(),onclick:Ne=>{Ne.stopPropagation(),hr(),Ie.success("已继续")},children:(Ne,Sr)=>{var xt=Qi(),Qe=d(xt);Ws(Qe,{}),p(2),t(Ne,xt)},$$slots:{default:!0}}))}),t(Mt,It)};a(ie,()=>va,(Mt,pr)=>{pr(Mt,{child:ht,$$slots:{child:!0}})})}var $t=r(ie,2);a($t,()=>ua,(ht,Mt)=>{Mt(ht,{side:"top",align:"center",children:(pr,rr)=>{p();var It=g("继续");t(pr,It)},$$slots:{default:!0}})}),t(se,ge)},$$slots:{default:!0}})}),t(S,Y)};H(z,S=>{e(u).status==="paused"&&S(W)},!0)}t(y,w)};H(C,y=>{e(u).status==="running"||e(u).status==="starting"?y(ye):y(M,!1)})}var D=r(C,2);{var ce=y=>{var w=N(),z=d(w);a(z,()=>Na,(W,S)=>{S(W,{children:(Y,Z)=>{var R=Vi(),U=d(R);{const oe=(ge,ie)=>{let $t=()=>ie?.().props;var ht=N(),Mt=d(ht);a(Mt,()=>Gt,(pr,rr)=>{rr(pr,_r($t,{variant:"destructive",class:"rounded-md",size:"icon-sm","aria-label":"停止",get disabled(){return e(At)},onpointerdown:It=>It.stopPropagation(),onmousedown:It=>It.stopPropagation(),children:(It,Vr)=>{var Be=Hi(),Te=d(Be);Ks(Te,{}),p(2),t(It,Be)},$$slots:{default:!0}}))}),t(ge,ht)};a(U,()=>ja,(ge,ie)=>{ie(ge,{child:oe,$$slots:{child:!0}})})}var se=r(U,2);a(se,()=>Ma,(oe,ge)=>{ge(oe,{align:"center",sideOffset:6,class:"w-64 p-3",children:(ie,$t)=>{var ht=Gi(),Mt=r(o(ht),2);{var pr=Be=>{var Te=qi(),Ne=d(Te),Sr=o(Ne,!0);s(Ne);var xt=r(Ne,2),Qe=o(xt);ee(Qe,{size:"sm",variant:"destructive",get disabled(){return e(Er)},onclick:Ce=>{Ce.stopPropagation(),Lr()},children:(Ce,yr)=>{p();var Qr=g("强制关闭");t(Ce,Qr)},$$slots:{default:!0}}),s(xt),T(()=>P(Sr,e(Ct))),t(Be,Te)};H(Mt,Be=>{e(Ct)&&Be(pr)})}var rr=r(Mt,2),It=o(rr);{const Be=(Te,Ne)=>{let Sr=()=>Ne?.().props;ee(Te,_r(Sr,{size:"sm",variant:"destructive",get disabled(){return e(At)},onclick:xt=>{Sr()?.onclick?.(xt),vr()},children:(xt,Qe)=>{p();var Ce=g("确认停止");t(xt,Ce)},$$slots:{default:!0}}))};a(It,()=>ss,(Te,Ne)=>{Ne(Te,{child:Be,$$slots:{child:!0}})})}var Vr=r(It,2);{const Be=(Te,Ne)=>{ee(Te,_r(()=>Ne?.().props,{size:"sm",variant:"secondary",onclick:xt=>{xt.stopPropagation()},children:(xt,Qe)=>{p();var Ce=g("取消");t(xt,Ce)},$$slots:{default:!0}}))};a(Vr,()=>ss,(Te,Ne)=>{Ne(Te,{child:Be,$$slots:{child:!0}})})}s(rr),s(ht),t(ie,ht)},$$slots:{default:!0}})}),t(Y,R)},$$slots:{default:!0}})}),t(y,w)};H(D,y=>{(e(u).status==="running"||e(u).status==="paused"||e(u).status==="starting")&&y(ce)})}t(j,F)};H(we,j=>{e(u)&&j(De)})}t(ae,gt)},$$slots:{default:!0}})}),t(O,B)},$$slots:{default:!0}})}),t(pe,te)},$$slots:{default:!0}})});var nt=r(be,2);a(nt,()=>Ma,(Se,ue)=>{ue(Se,{side:"top",align:"start",class:" w-[min(720px,90vw)] p-3",preventScroll:!0,trapFocus:!1,onOpenAutoFocus:async pe=>{pe.preventDefault(),await xs(),e(Vt)?.focus()},onCloseAutoFocus:pe=>{pe.preventDefault()},children:(pe,Me)=>{var te=N(),me=d(te);a(me,()=>ha,(Ae,I)=>{I(Ae,{class:"max-h-[45vh] overflow-auto",style:"scrollbar-gutter: stable; overscroll-behavior: contain; -webkit-overflow-scrolling: touch",children:(O,de)=>{var B=nd(),_=d(B);a(_,()=>da,(m,re)=>{re(m,{align:"block-start",class:"sticky top-0 z-10 border-b bg-popover",children:(ae,wt)=>{var gt=od(),ze=d(gt);a(ze,()=>Na,(j,F)=>{F(j,{get open(){return e(Ft)},set open(C){c(Ft,C,!0)},children:(C,ye)=>{var M=ed(),D=d(M),ce=o(D);sa(ce,{class:"h-8 w-64",placeholder:"搜索地址库文件名",onfocus:()=>{c(Xe,!0),c(Ye,0)},onblur:()=>{setTimeout(()=>c(Xe,!1),120)},onkeydown:z=>{const W=z.key;e(Oe).length&&(W==="ArrowDown"?(c(Ye,(e(Ye)+1)%e(Oe).length),z.preventDefault()):W==="ArrowUp"?(c(Ye,(e(Ye)-1+e(Oe).length)%e(Oe).length),z.preventDefault()):W==="Enter"?(Dt(e(Oe)[e(Ye)]),z.preventDefault()):W==="Escape"&&c(Ft,!1))},get value(){return e(Ue)},set value(z){c(Ue,z,!0)},get ref(){return e(lt)},set ref(z){c(lt,z,!0)}});var y=r(ce,2);a(y,()=>ja,(z,W)=>{W(z,{class:"pointer-events-none absolute top-full left-0 h-[1px] w-full opacity-0","aria-hidden":"true"})}),s(D);var w=r(D,2);a(w,()=>Ma,(z,W)=>{W(z,{side:"bottom",align:"start",sideOffset:6,trapFocus:!1,onOpenAutoFocus:S=>S.preventDefault(),onCloseAutoFocus:S=>S.preventDefault(),interactOutsideBehavior:"ignore",escapeKeydownBehavior:"ignore",class:"z-50 max-h-[40vh] min-w-[16rem] overflow-auto rounded-md border bg-popover p-1 text-popover-foreground shadow-md outline-hidden",get ref(){return e(kt)},set ref(S){c(kt,S,!0)},children:(S,Y)=>{var Z=N(),R=d(Z);Pr(R,19,()=>e(Oe),U=>U.id,(U,se,oe)=>{var ge=Zi();ge.__pointerdown=[Xi],ge.__click=[Yi,Dt,se];var ie=o(ge),$t=o(ie,!0);s(ie);var ht=r(ie,2);za(ht,{variant:"outline",class:"h-5",children:(Mt,pr)=>{p();var rr=g();T(()=>P(rr,e(se).line_count??0)),t(Mt,rr)},$$slots:{default:!0}}),s(ge),T(()=>{Qa(ge,"data-asset-set-index",e(oe)),jr(ge,1,`flex w-full items-center justify-between rounded px-2 py-1 text-sm ${e(Ye)===e(oe)?"bg-muted":"hover:bg-muted/50"}`,"svelte-1k5an9e"),P($t,e(se).name||e(se).id)}),t(U,ge)}),t(S,Z)},$$slots:{default:!0}})}),t(C,M)},$$slots:{default:!0}})});var Re=r(ze,2);a(Re,()=>ca,(j,F)=>{F(j,{children:(C,ye)=>{var M=td(),D=d(M);a(D,()=>va,(y,w)=>{w(y,{children:(z,W)=>{var S=N(),Y=d(S);a(Y,()=>Gt,(Z,R)=>{R(Z,{size:"icon-sm",variant:"ghost","aria-label":"去重与清理",onclick:$e,children:(U,se)=>{ln(U,{})},$$slots:{default:!0}})}),t(z,S)},$$slots:{default:!0}})});var ce=r(D,2);a(ce,()=>ua,(y,w)=>{w(y,{children:(z,W)=>{p();var S=g("去重与清理");t(z,S)},$$slots:{default:!0}})}),t(C,M)},$$slots:{default:!0}})});var je=r(Re,2);a(je,()=>ca,(j,F)=>{F(j,{children:(C,ye)=>{var M=rd(),D=d(M);a(D,()=>va,(y,w)=>{w(y,{children:(z,W)=>{var S=N(),Y=d(S);{let Z=E(()=>!e(J).trim());a(Y,()=>Gt,(R,U)=>{U(R,{size:"icon-sm",variant:"ghost","aria-label":"清空",get disabled(){return e(Z)},onclick:()=>c(J,""),children:(se,oe)=>{Vs(se,{})},$$slots:{default:!0}})})}t(z,S)},$$slots:{default:!0}})});var ce=r(D,2);a(ce,()=>ua,(y,w)=>{w(y,{children:(z,W)=>{p();var S=g("清空");t(z,S)},$$slots:{default:!0}})}),t(C,M)},$$slots:{default:!0}})});var ct=r(je,2);a(ct,()=>ca,(j,F)=>{F(j,{children:(C,ye)=>{var M=ad(),D=d(M);a(D,()=>va,(y,w)=>{w(y,{children:(z,W)=>{var S=N(),Y=d(S);{let Z=E(()=>!e(J).trim()||e(Fe));a(Y,()=>Gt,(R,U)=>{U(R,{variant:"outline",size:"sm","aria-label":"保存为新集合",get disabled(){return e(Z)},onclick:Nt,children:(se,oe)=>{p();var ge=g("保存为新集合");t(se,ge)},$$slots:{default:!0}})})}t(z,S)},$$slots:{default:!0}})});var ce=r(D,2);a(ce,()=>ua,(y,w)=>{w(y,{children:(z,W)=>{p();var S=g("保存为新集合");t(z,S)},$$slots:{default:!0}})}),t(C,M)},$$slots:{default:!0}})});var we=r(ct,2);a(we,()=>ca,(j,F)=>{F(j,{children:(C,ye)=>{var M=sd(),D=d(M);a(D,()=>va,(y,w)=>{w(y,{children:(z,W)=>{var S=N(),Y=d(S);a(Y,()=>Gt,(Z,R)=>{R(Z,{variant:"ghost",size:"sm","aria-label":"资产地址库",onclick:U=>{U.stopPropagation(),c(ur,!0),c(dr,!1)},children:(U,se)=>{p();var oe=g("资产地址库");t(U,oe)},$$slots:{default:!0}})}),t(z,S)},$$slots:{default:!0}})});var ce=r(D,2);a(ce,()=>ua,(y,w)=>{w(y,{children:(z,W)=>{p();var S=g("打开资产地址库");t(z,S)},$$slots:{default:!0}})}),t(C,M)},$$slots:{default:!0}})});var De=r(we,2);a(De,()=>tl,(j,F)=>{F(j,{class:"ms-auto",children:(C,ye)=>{p();var M=g();T(()=>P(M,`资产列表 · ${e(gr)??""} 条`)),t(C,M)},$$slots:{default:!0}})}),t(ae,gt)},$$slots:{default:!0}})});var K=r(_,2);a(K,()=>al,(m,re)=>{re(m,{rows:10,class:"h-[200px] w-full resize-none overflow-auto",style:"scrollbar-gutter: stable",get value(){return e(J)},set value(ae){c(J,ae,!0)},get ref(){return e(Vt)},set ref(ae){c(Vt,ae,!0)}})}),t(O,B)},$$slots:{default:!0}})}),t(pe,te)},$$slots:{default:!0}})}),t(he,xe)},$$slots:{default:!0}})}),s(ke),s(Ge),s(fr),s(ir),s(Le),s(pt),T(le=>{_t=jr(ir,1,"relative overflow-hidden rounded-t-lg border bg-background shadow-lg",null,_t,le),zs(ir,`height: ${e($)*100}vh`),jr(qe,1,`flex flex-col border-r ${e(cr)?"w-20":"w-72"}`,"svelte-1k5an9e"),jr(et,1,`flex items-center ${e(cr)?"justify-center":"justify-between"} p-2`,"svelte-1k5an9e")},[()=>({"select-none":e(ea)})]),t(We,pt)};H(Rs,We=>{e(f)&&We(Do)})}var Qs=r(Rs,2);a(Qs,()=>Za,(We,pt)=>{pt(We,{get open(){return e(Lt)},set open(Le){c(Lt,Le,!0)},children:(Le,ir)=>{var _t=Gd(),St=d(_t);a(St,()=>bs,(qe,et)=>{et(qe,{})});var fr=r(St,2);a(fr,()=>es,(qe,et)=>{et(qe,{side:"bottom",class:"",children:(br,Tr)=>{var it=qd(),Bt=o(it);a(Bt,()=>ys,(Ge,V)=>{V(Ge,{children:(G,Ve)=>{var X=dd(),fe=d(X);a(fe,()=>Ps,(tt,_e)=>{_e(tt,{children:(Pt,Je)=>{p();var rt=g("扫描策略");t(Pt,rt)},$$slots:{default:!0}})});var Pe=r(fe,2);a(Pe,()=>ws,(tt,_e)=>{_e(tt,{children:(Pt,Je)=>{p();var rt=g("仅本次扫描的参数组合，支持保存为策略");t(Pt,rt)},$$slots:{default:!0}})}),t(G,X)},$$slots:{default:!0}})});var Ut=r(Bt,2),ot=o(Ut);a(ot,()=>Nn,(Ge,V)=>{V(Ge,{"aria-label":"策略管理",children:(G,Ve)=>{var X=gd(),fe=d(X);{let Je=E(()=>bt.activeId??void 0);a(fe,()=>ts,(rt,ke)=>{ke(rt,{type:"single",get value(){return e(Je)},onValueChange:Tt=>Oa(Tt),children:(Tt,le)=>{var ve=ud(),he=d(ve);a(he,()=>rs,(xe,be)=>{be(xe,{size:"sm","aria-label":"选择扫描策略",children:(nt,Se)=>{var ue=cd(),pe=o(ue,!0);s(ue),T(Me=>P(pe,Me),[()=>bt.getActive()?.name??bt.activeId]),t(nt,ue)},$$slots:{default:!0}})});var dt=r(he,2);a(dt,()=>as,(xe,be)=>{be(xe,{class:"min-w-40",children:(nt,Se)=>{var ue=N(),pe=d(ue);Pr(pe,17,()=>bt.strategies,Me=>Me.id,(Me,te)=>{var me=N(),Ae=d(me);a(Ae,()=>Fr,(I,O)=>{O(I,{get value(){return e(te).id},children:(de,B)=>{var _=vd(),K=o(_,!0);s(_),T(()=>P(K,e(te).name)),t(de,_)},$$slots:{default:!0}})}),t(Me,me)}),t(nt,ue)},$$slots:{default:!0}})}),t(Tt,ve)},$$slots:{default:!0}})})}var Pe=r(fe,2);ee(Pe,{size:"sm",variant:"outline",onclick:na,children:(Je,rt)=>{p();var ke=g("新建策略");t(Je,ke)},$$slots:{default:!0}});var tt=r(Pe,2);ee(tt,{size:"sm",variant:"outline",onclick:Gr,children:(Je,rt)=>{p();var ke=g("复制");t(Je,ke)},$$slots:{default:!0}});var _e=r(tt,2);ee(_e,{size:"sm",variant:"outline",onclick:()=>{const Je=bt.getActive();if(!Je){Ie.error("未选择策略");return}const ke=(prompt("重命名为",Je.name)||"").trim();ke&&(bt.rename(Je.id,ke),Ie.success(`已重命名为：${ke}`))},children:(Je,rt)=>{p();var ke=g("重命名");t(Je,ke)},$$slots:{default:!0}});var Pt=r(_e,2);a(Pt,()=>fs,(Je,rt)=>{rt(Je,{get open(){return e(Jr)},set open(ke){c(Jr,ke,!0)},children:(ke,Tt)=>{var le=md(),ve=d(le);{let dt=E(()=>Ln({variant:"destructive",size:"sm"}));a(ve,()=>En,(xe,be)=>{be(xe,{get class(){return e(dt)},children:(nt,Se)=>{p();var ue=g("删除");t(nt,ue)},$$slots:{default:!0}})})}var he=r(ve,2);a(he,()=>ns,(dt,xe)=>{xe(dt,{children:(be,nt)=>{var Se=_d(),ue=d(Se);a(ue,()=>ls,(Me,te)=>{te(Me,{children:(me,Ae)=>{var I=fd(),O=d(I);a(O,()=>is,(B,_)=>{_(B,{children:(K,m)=>{p();var re=g("确认删除策略?");t(K,re)},$$slots:{default:!0}})});var de=r(O,2);a(de,()=>ds,(B,_)=>{_(B,{children:(K,m)=>{p();var re=g();T(ae=>P(re,`此操作不可恢复，将删除当前策略 "${ae??""}"`),[()=>bt.getActive()?.name]),t(K,re)},$$slots:{default:!0}})}),t(me,I)},$$slots:{default:!0}})});var pe=r(ue,2);a(pe,()=>cs,(Me,te)=>{te(Me,{children:(me,Ae)=>{var I=pd(),O=d(I);a(O,()=>vs,(B,_)=>{_(B,{children:(K,m)=>{p();var re=g("取消");t(K,re)},$$slots:{default:!0}})});var de=r(O,2);a(de,()=>us,(B,_)=>{_(B,{onclick:()=>{Xr(),c(Jr,!1)},children:(K,m)=>{p();var re=g("删除");t(K,re)},$$slots:{default:!0}})}),t(me,I)},$$slots:{default:!0}})}),t(be,Se)},$$slots:{default:!0}})}),t(ke,le)},$$slots:{default:!0}})}),t(G,X)},$$slots:{default:!0}})});var zt=r(ot,2);ee(zt,{size:"sm",variant:"default",onclick:ta,children:(Ge,V)=>{var G=$d(),Ve=d(G);sn(Ve,{class:"mr-1 size-4"}),p(),t(Ge,G)},$$slots:{default:!0}}),s(Ut);var mt=r(Ut,2);a(mt,()=>io,(Ge,V)=>{V(Ge,{get value(){return e(Or)},onValueChange:G=>c(Or,G,!0),children:(G,Ve)=>{var X=Hd(),fe=d(X);a(fe,()=>co,(tt,_e)=>{_e(tt,{class:"grid grid-cols-3 gap-2",children:(Pt,Je)=>{var rt=hd(),ke=d(rt);a(ke,()=>Ea,(ve,he)=>{he(ve,{value:"performance",children:(dt,xe)=>{p();var be=g("性能与稳定性");t(dt,be)},$$slots:{default:!0}})});var Tt=r(ke,2);a(Tt,()=>Ea,(ve,he)=>{he(ve,{value:"http",children:(dt,xe)=>{p();var be=g("HTTP 与请求");t(dt,be)},$$slots:{default:!0}})});var le=r(Tt,2);a(le,()=>Ea,(ve,he)=>{he(ve,{value:"oob",children:(dt,xe)=>{p();var be=g("OOB");t(dt,be)},$$slots:{default:!0}})}),t(Pt,rt)},$$slots:{default:!0}})});var Pe=r(fe,2);a(Pe,()=>ya,(tt,_e)=>{_e(tt,{class:"mt-2 h-[60vh]",children:(Pt,Je)=>{var rt=Ud(),ke=d(rt);a(ke,()=>ba,(le,ve)=>{ve(le,{class:"h-full w-full",children:(he,dt)=>{var xe=Qd(),be=d(xe);a(be,()=>ks,(Ae,I)=>{I(Ae,{value:"performance",class:"space-y-4",children:(O,de)=>{var B=Td(),_=d(B),K=o(_),m=o(K);to(m,{id:"perf-smart",get checked(){return e(h).performance.smart},onCheckedChange:j=>e(h).performance.smart=j}),p(2),s(K),s(_);var re=r(_,2),ae=o(re),wt=o(ae),gt=r(o(wt),2);a(gt,()=>ha,(j,F)=>{F(j,{class:"w-[160px]",get"data-disabled"(){return e(h).performance.smart},children:(C,ye)=>{var M=bd(),D=d(M);a(D,()=>La,(y,w)=>{w(y,{id:"perf-rl",type:"number",min:"1",get disabled(){return e(h).performance.smart},get value(){return e(h).performance.rateLimit},set value(z){e(h).performance.rateLimit=z}})});var ce=r(D,2);a(ce,()=>da,(y,w)=>{w(y,{align:"inline-end",children:(z,W)=>{var S=xd(),Y=d(S);a(Y,()=>Gt,(R,U)=>{U(R,{size:"icon-sm",variant:"ghost","aria-label":"减少",get disabled(){return e(h).performance.smart},onclick:()=>e(h).performance.rateLimit=Math.max(1,Number(e(h).performance.rateLimit||0)-1),children:(se,oe)=>{Sa(se,{})},$$slots:{default:!0}})});var Z=r(Y,2);a(Z,()=>Gt,(R,U)=>{U(R,{size:"icon-sm",variant:"ghost","aria-label":"增加",get disabled(){return e(h).performance.smart},onclick:()=>e(h).performance.rateLimit=Math.max(1,Number(e(h).performance.rateLimit||0)+1),children:(se,oe)=>{$a(se,{})},$$slots:{default:!0}})}),t(z,S)},$$slots:{default:!0}})}),t(C,M)},$$slots:{default:!0}})}),s(wt);var ze=r(wt,2),Re=r(o(ze),2);a(Re,()=>ha,(j,F)=>{F(j,{class:"w-[160px]",get"data-disabled"(){return e(h).performance.smart},children:(C,ye)=>{var M=Pd(),D=d(M);a(D,()=>La,(y,w)=>{w(y,{id:"perf-c",type:"number",min:"1",get disabled(){return e(h).performance.smart},get value(){return e(h).performance.concurrency},set value(z){e(h).performance.concurrency=z}})});var ce=r(D,2);a(ce,()=>da,(y,w)=>{w(y,{align:"inline-end",children:(z,W)=>{var S=yd(),Y=d(S);a(Y,()=>Gt,(R,U)=>{U(R,{size:"icon-sm",variant:"ghost","aria-label":"减少",get disabled(){return e(h).performance.smart},onclick:()=>e(h).performance.concurrency=Math.max(1,Number(e(h).performance.concurrency||0)-1),children:(se,oe)=>{Sa(se,{})},$$slots:{default:!0}})});var Z=r(Y,2);a(Z,()=>Gt,(R,U)=>{U(R,{size:"icon-sm",variant:"ghost","aria-label":"增加",get disabled(){return e(h).performance.smart},onclick:()=>e(h).performance.concurrency=Math.max(1,Number(e(h).performance.concurrency||0)+1),children:(se,oe)=>{$a(se,{})},$$slots:{default:!0}})}),t(z,S)},$$slots:{default:!0}})}),t(C,M)},$$slots:{default:!0}})}),s(ze),s(ae),s(re);var je=r(re,2),ct=r(o(je),2);a(ct,()=>ha,(j,F)=>{F(j,{class:"w-[160px]",children:(C,ye)=>{var M=kd(),D=d(M);a(D,()=>La,(y,w)=>{w(y,{id:"perf-timeout",type:"number",min:"1",get value(){return e(h).performance.timeout},set value(z){e(h).performance.timeout=z}})});var ce=r(D,2);a(ce,()=>da,(y,w)=>{w(y,{align:"inline-end",children:(z,W)=>{var S=wd(),Y=d(S);a(Y,()=>Gt,(R,U)=>{U(R,{size:"icon-sm",variant:"ghost","aria-label":"减少",onclick:()=>e(h).performance.timeout=Math.max(1,Number(e(h).performance.timeout||0)-1),children:(se,oe)=>{Sa(se,{})},$$slots:{default:!0}})});var Z=r(Y,2);a(Z,()=>Gt,(R,U)=>{U(R,{size:"icon-sm",variant:"ghost","aria-label":"增加",onclick:()=>e(h).performance.timeout=Math.max(1,Number(e(h).performance.timeout||0)+1),children:(se,oe)=>{$a(se,{})},$$slots:{default:!0}})}),t(z,S)},$$slots:{default:!0}})}),t(C,M)},$$slots:{default:!0}})}),s(je);var we=r(je,2),De=r(o(we),2);a(De,()=>ha,(j,F)=>{F(j,{class:"w-[160px]",children:(C,ye)=>{var M=zd(),D=d(M);a(D,()=>La,(y,w)=>{w(y,{id:"perf-retries",type:"number",min:"0",get value(){return e(h).performance.retries},set value(z){e(h).performance.retries=z}})});var ce=r(D,2);a(ce,()=>da,(y,w)=>{w(y,{align:"inline-end",children:(z,W)=>{var S=Sd(),Y=d(S);a(Y,()=>Gt,(R,U)=>{U(R,{size:"icon-sm",variant:"ghost","aria-label":"减少",onclick:()=>e(h).performance.retries=Math.max(0,Number(e(h).performance.retries||0)-1),children:(se,oe)=>{Sa(se,{})},$$slots:{default:!0}})});var Z=r(Y,2);a(Z,()=>Gt,(R,U)=>{U(R,{size:"icon-sm",variant:"ghost","aria-label":"增加",onclick:()=>e(h).performance.retries=Math.max(0,Number(e(h).performance.retries||0)+1),children:(se,oe)=>{$a(se,{})},$$slots:{default:!0}})}),t(z,S)},$$slots:{default:!0}})}),t(C,M)},$$slots:{default:!0}})}),s(we),t(O,B)},$$slots:{default:!0}})});var nt=r(be,2);a(nt,()=>ks,(Ae,I)=>{I(Ae,{value:"http",class:"space-y-4",children:(O,de)=>{var B=Md(),_=o(B),K=r(o(_),2);sa(K,{id:"http-proxy",placeholder:"http://127.0.0.1:1080",get value(){return e(h).http.proxy},set value(je){e(h).http.proxy=je}}),s(_);var m=r(_,2),re=r(o(m),2),ae=o(re);Pr(ae,17,()=>e(h).http.headers??[],Ts,(je,ct,we)=>{var De=Id(),j=o(De);sa(j,{class:"flex-1",placeholder:"Header: Value",get title(){return e(ct)},get value(){return e(h).http.headers[we]},set value(C){e(h).http.headers[we]=C}});var F=r(j,2);ee(F,{size:"sm",variant:"outline",onclick:()=>e(h).http.headers=(e(h).http.headers||[]).filter((C,ye)=>ye!==we),children:(C,ye)=>{p();var M=g("删除");t(C,M)},$$slots:{default:!0}}),s(De),t(je,De)});var wt=r(ae,2),gt=o(wt);ee(gt,{size:"sm",variant:"outline",onclick:()=>e(h).http.headers=[...e(h).http.headers||[],""],children:(je,ct)=>{p();var we=g("新增头部");t(je,we)},$$slots:{default:!0}}),s(wt),s(re),s(m);var ze=r(m,2),Re=r(o(ze),2);{let je=E(()=>e(h).http.sort??"");a(Re,()=>ts,(ct,we)=>{we(ct,{type:"single",get value(){return e(je)},onValueChange:De=>e(h).http.sort=De,children:(De,j)=>{var F=Ld(),C=d(F);a(C,()=>rs,(M,D)=>{D(M,{size:"sm",id:"http-sort",children:(ce,y)=>{var w=Ad(),z=o(w,!0);s(w),T(()=>P(z,e(h).http.sort==="a-z"?"按字母顺序":"默认严重级")),t(ce,w)},$$slots:{default:!0}})});var ye=r(C,2);a(ye,()=>as,(M,D)=>{D(M,{class:"min-w-40",children:(ce,y)=>{var w=Cd(),z=d(w);a(z,()=>Fr,(S,Y)=>{Y(S,{value:"",children:(Z,R)=>{p();var U=g("默认严重级");t(Z,U)},$$slots:{default:!0}})});var W=r(z,2);a(W,()=>Fr,(S,Y)=>{Y(S,{value:"a-z",children:(Z,R)=>{p();var U=g("按字母顺序");t(Z,U)},$$slots:{default:!0}})}),t(ce,w)},$$slots:{default:!0}})}),t(De,F)},$$slots:{default:!0}})})}s(ze),s(B),t(O,B)},$$slots:{default:!0}})});var Se=r(nt,2);a(Se,()=>ks,(Ae,I)=>{I(Ae,{value:"oob",class:"space-y-4",children:(O,de)=>{var B=Rd(),_=o(B),K=r(o(_),2);{let Re=E(()=>e(h).oob.adapter??"");a(K,()=>ts,(je,ct)=>{ct(je,{type:"single",get value(){return e(Re)},onValueChange:we=>e(h).oob.adapter=we,children:(we,De)=>{var j=Ed(),F=d(j);a(F,()=>rs,(ye,M)=>{M(ye,{size:"sm",children:(D,ce)=>{var y=jd(),w=o(y,!0);s(y),T(()=>P(w,e(h).oob.adapter||"请选择适配器")),t(D,y)},$$slots:{default:!0}})});var C=r(F,2);a(C,()=>as,(ye,M)=>{M(ye,{class:"min-w-40",children:(D,ce)=>{var y=Nd(),w=d(y);a(w,()=>Fr,(Z,R)=>{R(Z,{value:"ceye",children:(U,se)=>{p();var oe=g("ceye");t(U,oe)},$$slots:{default:!0}})});var z=r(w,2);a(z,()=>Fr,(Z,R)=>{R(Z,{value:"dnslogcn",children:(U,se)=>{p();var oe=g("dnslogcn");t(U,oe)},$$slots:{default:!0}})});var W=r(z,2);a(W,()=>Fr,(Z,R)=>{R(Z,{value:"alphalog",children:(U,se)=>{p();var oe=g("alphalog");t(U,oe)},$$slots:{default:!0}})});var S=r(W,2);a(S,()=>Fr,(Z,R)=>{R(Z,{value:"xray",children:(U,se)=>{p();var oe=g("xray");t(U,oe)},$$slots:{default:!0}})});var Y=r(S,2);a(Y,()=>Fr,(Z,R)=>{R(Z,{value:"revsuit",children:(U,se)=>{p();var oe=g("revsuit");t(U,oe)},$$slots:{default:!0}})}),t(D,y)},$$slots:{default:!0}})}),t(we,j)},$$slots:{default:!0}})})}s(_);var m=r(_,2),re=o(m),ae=o(re),wt=r(o(ae),2);{let Re=E(()=>!e(h).oob.adapter);a(wt,()=>ha,(je,ct)=>{ct(je,{class:"w-[160px]",get"data-disabled"(){return e(Re)},children:(we,De)=>{var j=Bd(),F=d(j);{let ye=E(()=>!e(h).oob.adapter);a(F,()=>La,(M,D)=>{D(M,{id:"oob-rl",type:"number",min:"1",get disabled(){return e(ye)},get value(){return e(h).oob.rateLimit},set value(ce){e(h).oob.rateLimit=ce}})})}var C=r(F,2);a(C,()=>da,(ye,M)=>{M(ye,{align:"inline-end",children:(D,ce)=>{var y=Od(),w=d(y);{let W=E(()=>!e(h).oob.adapter);a(w,()=>Gt,(S,Y)=>{Y(S,{size:"icon-sm",variant:"ghost","aria-label":"减少",get disabled(){return e(W)},onclick:()=>e(h).oob.rateLimit=Math.max(1,Number(e(h).oob.rateLimit||0)-1),children:(Z,R)=>{Sa(Z,{})},$$slots:{default:!0}})})}var z=r(w,2);{let W=E(()=>!e(h).oob.adapter);a(z,()=>Gt,(S,Y)=>{Y(S,{size:"icon-sm",variant:"ghost","aria-label":"增加",get disabled(){return e(W)},onclick:()=>e(h).oob.rateLimit=Math.max(1,Number(e(h).oob.rateLimit||0)+1),children:(Z,R)=>{$a(Z,{})},$$slots:{default:!0}})})}t(D,y)},$$slots:{default:!0}})}),t(we,j)},$$slots:{default:!0}})})}s(ae);var gt=r(ae,2),ze=r(o(gt),2);{let Re=E(()=>!e(h).oob.adapter);a(ze,()=>ha,(je,ct)=>{ct(je,{class:"w-[160px]",get"data-disabled"(){return e(Re)},children:(we,De)=>{var j=Dd(),F=d(j);{let ye=E(()=>!e(h).oob.adapter);a(F,()=>La,(M,D)=>{D(M,{id:"oob-c",type:"number",min:"1",get disabled(){return e(ye)},get value(){return e(h).oob.concurrency},set value(ce){e(h).oob.concurrency=ce}})})}var C=r(F,2);a(C,()=>da,(ye,M)=>{M(ye,{align:"inline-end",children:(D,ce)=>{var y=Fd(),w=d(y);{let W=E(()=>!e(h).oob.adapter);a(w,()=>Gt,(S,Y)=>{Y(S,{size:"icon-sm",variant:"ghost","aria-label":"减少",get disabled(){return e(W)},onclick:()=>e(h).oob.concurrency=Math.max(1,Number(e(h).oob.concurrency||0)-1),children:(Z,R)=>{Sa(Z,{})},$$slots:{default:!0}})})}var z=r(w,2);{let W=E(()=>!e(h).oob.adapter);a(z,()=>Gt,(S,Y)=>{Y(S,{size:"icon-sm",variant:"ghost","aria-label":"增加",get disabled(){return e(W)},onclick:()=>e(h).oob.concurrency=Math.max(1,Number(e(h).oob.concurrency||0)+1),children:(Z,R)=>{$a(Z,{})},$$slots:{default:!0}})})}t(D,y)},$$slots:{default:!0}})}),t(we,j)},$$slots:{default:!0}})})}s(gt),s(re),s(m),s(B),t(O,B)},$$slots:{default:!0}})});var ue=r(Se,2),pe=r(o(ue),2),Me=o(pe,!0);s(pe);var te=r(pe,2),me=o(te);ee(me,{size:"sm",onclick:()=>navigator.clipboard?.writeText(bt.toCommandString(bt.diffAgainstBaseline(e(h)))),children:(Ae,I)=>{p();var O=g("复制命令");t(Ae,O)},$$slots:{default:!0}}),s(te),s(ue),T(Ae=>P(Me,Ae),[()=>bt.toCommandString(bt.diffAgainstBaseline(e(h)))]),t(he,xe)},$$slots:{default:!0}})});var Tt=r(ke,2);a(Tt,()=>fa,(le,ve)=>{ve(le,{orientation:"vertical",children:(he,dt)=>{var xe=N(),be=d(xe);a(be,()=>pa,(nt,Se)=>{Se(nt,{})}),t(he,xe)},$$slots:{default:!0}})}),t(Pt,rt)},$$slots:{default:!0}})}),t(G,X)},$$slots:{default:!0}})}),s(it),t(br,it)},$$slots:{default:!0}})}),t(Le,_t)},$$slots:{default:!0}})});var Us=r(Qs,2);a(Us,()=>Za,(We,pt)=>{pt(We,{get open(){return e(_s)},set open(Le){c(_s,Le,!0)},children:(Le,ir)=>{var _t=tc(),St=d(_t);a(St,()=>bs,(qe,et)=>{et(qe,{})});var fr=r(St,2);a(fr,()=>es,(qe,et)=>{et(qe,{side:"bottom",class:"",children:(br,Tr)=>{var it=ec(),Bt=o(it);a(Bt,()=>ys,(I,O)=>{O(I,{children:(de,B)=>{var _=Vd(),K=d(_);a(K,()=>Ps,(re,ae)=>{ae(re,{children:(wt,gt)=>{p();var ze=g("选择 PoC");t(wt,ze)},$$slots:{default:!0}})});var m=r(K,2);a(m,()=>ws,(re,ae)=>{ae(re,{children:(wt,gt)=>{p();var ze=g("左侧搜索选择，右侧为已选；右侧为空=默认扫描全部");t(wt,ze)},$$slots:{default:!0}})}),t(de,_)},$$slots:{default:!0}})});var Ut=r(Bt,2),ot=o(Ut),zt=o(ot),mt=o(zt);sa(mt,{class:"flex-1",placeholder:"搜索 PoC",onkeydown:I=>{I.key==="Enter"&&As()},get value(){return e(Ka)},set value(I){c(Ka,I,!0)}});var Ge=r(mt,2);ee(Ge,{size:"sm",variant:"outline",onclick:As,children:(I,O)=>{p();var de=g("搜索");t(I,de)},$$slots:{default:!0}});var V=r(Ge,2);ee(V,{size:"sm",variant:"ghost",onclick:$o,children:(I,O)=>{p();var de=g("全选");t(I,de)},$$slots:{default:!0}});var G=r(V,2);ee(G,{size:"sm",variant:"ghost",onclick:ho,children:(I,O)=>{p();var de=g("取消全选");t(I,de)},$$slots:{default:!0}});var Ve=r(G,2);ee(Ve,{size:"sm",onclick:yo,children:(I,O)=>{p();var de=g("追加所选");t(I,de)},$$slots:{default:!0}}),s(zt);var X=r(zt,2),fe=o(X);{var Pe=I=>{var O=Kd();t(I,O)},tt=I=>{var O=N(),de=d(O);Pr(de,19,()=>e(Pa),(B,_)=>B.poc_id||String(B.id??_),(B,_)=>{var K=Xd();K.__click=[Wd,$s,_],K.__keydown=[Jd,$s,_];var m=o(K),re=o(m);{let we=E(()=>ma.has(e(_)?.poc_id||String(e(_)?.id||"")));Mn(re,{get checked(){return e(we)},onclick:De=>{De.stopPropagation(),$s(e(_))}})}var ae=r(re,2),wt=o(ae,!0);s(ae);var gt=r(ae,2);za(gt,{variant:"outline",children:(we,De)=>{p();var j=g();T(F=>P(j,F),[()=>(e(_).severity||"").toString().toUpperCase()]),t(we,j)},$$slots:{default:!0}}),s(m);var ze=r(m,2),Re=o(ze),je=o(Re,!0);s(Re);var ct=r(Re,2);ee(ct,{variant:"outline",size:"sm",onclick:()=>Po(e(_)),children:(we,De)=>{p();var j=g("追加");t(we,j)},$$slots:{default:!0}}),s(ze),s(K),T(()=>{P(wt,e(_).name),P(je,e(_).poc_id)}),t(B,K)}),t(I,O)};H(fe,I=>{(e(Pa)?.length||0)===0?I(Pe):I(tt,!1)})}s(X);var _e=r(X,2),Pt=o(_e),Je=o(Pt);s(Pt);var rt=r(Pt,2),ke=o(rt);{let I=E(()=>e(la)<=1);ee(ke,{size:"sm",variant:"ghost",onclick:mo,get disabled(){return e(I)},children:(O,de)=>{p();var B=g("上一页");t(O,B)},$$slots:{default:!0}})}var Tt=r(ke,2),le=o(Tt);s(Tt);var ve=r(Tt,2);{let I=E(()=>e(la)>=e(ms));ee(ve,{size:"sm",variant:"ghost",onclick:go,get disabled(){return e(I)},children:(O,de)=>{p();var B=g("下一页");t(O,B)},$$slots:{default:!0}})}var he=r(ve,2),dt=o(he);sa(dt,{class:"h-8 w-20",placeholder:"每页",onkeydown:I=>{I.key==="Enter"&&Ls()},get value(){return e(Ja)},set value(I){c(Ja,I,!0)}});var xe=r(dt,2);ee(xe,{size:"sm",variant:"outline",onclick:Ls,children:(I,O)=>{p();var de=g("应用");t(I,de)},$$slots:{default:!0}}),s(he),s(rt),s(_e),s(ot);var be=r(ot,2),nt=o(be),Se=o(nt),ue=o(Se);s(Se);var pe=r(Se,2);ee(pe,{size:"sm",variant:"outline",onclick:()=>e(u)&&Ee.clearTaskPocs(e(u).id),children:(I,O)=>{p();var de=g("清空");t(I,de)},$$slots:{default:!0}}),s(nt);var Me=r(nt,2),te=o(Me);{var me=I=>{var O=N(),de=d(O);Pr(de,19,()=>e(u).pocs,(B,_)=>B.id||_,(B,_)=>{var K=Yd(),m=o(K),re=o(m),ae=o(re,!0);s(re);var wt=r(re,2);za(wt,{variant:"outline",children:(ze,Re)=>{p();var je=g();T(ct=>P(je,ct),[()=>(e(_).severity||"").toString().toUpperCase()]),t(ze,je)},$$slots:{default:!0}}),s(m);var gt=r(m,2);ee(gt,{variant:"ghost",size:"icon-sm","aria-label":"移除",onclick:()=>e(u)&&Ee.removeTaskPoc(e(u).id,e(_).id),children:(ze,Re)=>{Ks(ze,{class:"size-3"})},$$slots:{default:!0}}),s(K),T(()=>P(ae,e(_).name)),t(B,K)}),t(I,O)},Ae=I=>{var O=Zd();t(I,O)};H(te,I=>{e(u)?.pocs&&e(u).pocs.length>0?I(me):I(Ae,!1)})}s(Me),s(be),s(Ut),s(it),T(()=>{P(Je,`共 ${e(Da)??""} 条 · 每页 ${e(Wa)??""}`),P(le,`第 ${e(la)??""} / 共 ${e(ms)??""} 页`),P(ue,`已选 ${(e(u)?.pocs?.length||0)??""} 个PoC（右侧为空=默认扫描全部）`)}),t(br,it)},$$slots:{default:!0}})}),t(Le,_t)},$$slots:{default:!0}})});var Hs=r(Us,2);a(Hs,()=>Za,(We,pt)=>{pt(We,{get open(){return e(ur)},set open(Le){c(ur,Le,!0)},children:(Le,ir)=>{var _t=sc(),St=d(_t);a(St,()=>bs,(qe,et)=>{et(qe,{})});var fr=r(St,2);a(fr,()=>es,(qe,et)=>{et(qe,{side:"bottom",class:"",children:(br,Tr)=>{var it=ac(),Bt=o(it);a(Bt,()=>ys,(ot,zt)=>{zt(ot,{children:(mt,Ge)=>{var V=rc(),G=d(V);a(G,()=>Ps,(X,fe)=>{fe(X,{children:(Pe,tt)=>{p();var _e=g("资产地址库");t(Pe,_e)},$$slots:{default:!0}})});var Ve=r(G,2);a(Ve,()=>ws,(X,fe)=>{fe(X,{children:(Pe,tt)=>{p();var _e=g("导入与复用历史资产");t(Pe,_e)},$$slots:{default:!0}})}),t(mt,V)},$$slots:{default:!0}})});var Ut=r(Bt,2);Cl(Ut,{height:"60vh",onAdd:Va}),s(it),t(br,it)},$$slots:{default:!0}})}),t(Le,_t)},$$slots:{default:!0}})});var qs=r(Hs,2);a(qs,()=>fs,(We,pt)=>{pt(We,{get open(){return e(xr)},set open(Le){c(xr,Le,!0)},children:(Le,ir)=>{var _t=ic(),St=d(_t);a(St,()=>Ys,(qe,et)=>{et(qe,{})});var fr=r(St,2);a(fr,()=>ns,(qe,et)=>{et(qe,{children:(br,Tr)=>{var it=lc(),Bt=d(it);a(Bt,()=>ls,(ot,zt)=>{zt(ot,{children:(mt,Ge)=>{var V=oc(),G=d(V);a(G,()=>is,(X,fe)=>{fe(X,{children:(Pe,tt)=>{p();var _e=g();T(()=>P(_e,e(Dr))),t(Pe,_e)},$$slots:{default:!0}})});var Ve=r(G,2);a(Ve,()=>ds,(X,fe)=>{fe(X,{children:(Pe,tt)=>{p();var _e=g();T(()=>P(_e,e(Rr))),t(Pe,_e)},$$slots:{default:!0}})}),t(mt,V)},$$slots:{default:!0}})});var Ut=r(Bt,2);a(Ut,()=>cs,(ot,zt)=>{zt(ot,{children:(mt,Ge)=>{var V=nc(),G=d(V);a(G,()=>vs,(X,fe)=>{fe(X,{onclick:()=>{c(xr,!1)},children:(Pe,tt)=>{p();var _e=g("取消");t(Pe,_e)},$$slots:{default:!0}})});var Ve=r(G,2);a(Ve,()=>us,(X,fe)=>{fe(X,{onclick:()=>{Ba()},children:(Pe,tt)=>{p();var _e=g("继续");t(Pe,_e)},$$slots:{default:!0}})}),t(mt,V)},$$slots:{default:!0}})}),t(br,it)},$$slots:{default:!0}})}),t(Le,_t)},$$slots:{default:!0}})});var Ro=r(qs,2);a(Ro,()=>fs,(We,pt)=>{pt(We,{get open(){return e(Ca)},set open(Le){c(Ca,Le,!0)},children:(Le,ir)=>{var _t=uc(),St=d(_t);a(St,()=>Ys,(qe,et)=>{et(qe,{})});var fr=r(St,2);a(fr,()=>ns,(qe,et)=>{et(qe,{children:(br,Tr)=>{var it=vc(),Bt=d(it);a(Bt,()=>ls,(ot,zt)=>{zt(ot,{children:(mt,Ge)=>{var V=dc(),G=d(V);a(G,()=>is,(X,fe)=>{fe(X,{children:(Pe,tt)=>{p();var _e=g("确认删除任务?");t(Pe,_e)},$$slots:{default:!0}})});var Ve=r(G,2);a(Ve,()=>ds,(X,fe)=>{fe(X,{children:(Pe,tt)=>{p();var _e=g("删除后将清理该任务的事件流、日志与命中记录。");t(Pe,_e)},$$slots:{default:!0}})}),t(mt,V)},$$slots:{default:!0}})});var Ut=r(Bt,2);a(Ut,()=>cs,(ot,zt)=>{zt(ot,{children:(mt,Ge)=>{var V=cc(),G=d(V);a(G,()=>vs,(X,fe)=>{fe(X,{get disabled(){return e(ga)},onclick:()=>{c(Ca,!1),c(wa,"")},children:(Pe,tt)=>{p();var _e=g("取消");t(Pe,_e)},$$slots:{default:!0}})});var Ve=r(G,2);a(Ve,()=>us,(X,fe)=>{fe(X,{get disabled(){return e(ga)},onclick:bo,children:(Pe,tt)=>{var _e=N(),Pt=d(_e);{var Je=ke=>{var Tt=g("正在停止...");t(ke,Tt)},rt=ke=>{var Tt=g("删除");t(ke,Tt)};H(Pt,ke=>{e(ga)?ke(Je):ke(rt,!1)})}t(Pe,_e)},$$slots:{default:!0}})}),t(mt,V)},$$slots:{default:!0}})}),t(br,it)},$$slots:{default:!0}})}),t(Le,_t)},$$slots:{default:!0}})}),s(He),t(k,He)},$$slots:{default:!0}})}),t(b,Os),or()}so(["click","pointerdown","keydown"]);var _c=i("<nav></nav>");function mc(b,l){sr(l,!0);let f=Ar(l,["$$slots","$$events","$$legacy","items","class"]);var $=_c();Ia($,x=>({class:x,...f}),[()=>mr("items-center gap-0.5",l.class)]),Pr($,21,()=>l.items,x=>x.href,(x,u)=>{{let A=E(()=>mr(oo.url.pathname===e(u).href&&"text-primary"));ee(x,{get href(){return e(u).href},variant:"ghost",size:"sm",get class(){return e(A)},children:(Q,J)=>{p();var Ke=g();T(()=>P(Ke,e(u).title)),t(Q,Ke)},$$slots:{default:!0}})}}),s($),t(b,$),or()}var gc=_n('<svg><path fill="currentColor" d="M409.132 114.573c-19.608-33.596-46.205-60.194-79.798-79.8-33.598-19.607-70.277-29.408-110.063-29.408-39.781 0-76.472 9.804-110.063 29.408-33.596 19.605-60.192 46.204-79.8 79.8C9.803 148.168 0 184.854 0 224.63c0 47.78 13.94 90.745 41.827 128.906 27.884 38.164 63.906 64.572 108.063 79.227 5.14.954 8.945.283 11.419-1.996 2.475-2.282 3.711-5.14 3.711-8.562 0-.571-.049-5.708-.144-15.417a2549.81 2549.81 0 01-.144-25.406l-6.567 1.136c-4.187.767-9.469 1.092-15.846 1-6.374-.089-12.991-.757-19.842-1.999-6.854-1.231-13.229-4.086-19.13-8.559-5.898-4.473-10.085-10.328-12.56-17.556l-2.855-6.57c-1.903-4.374-4.899-9.233-8.992-14.559-4.093-5.331-8.232-8.945-12.419-10.848l-1.999-1.431c-1.332-.951-2.568-2.098-3.711-3.429-1.142-1.331-1.997-2.663-2.568-3.997-.572-1.335-.098-2.43 1.427-3.289 1.525-.859 4.281-1.276 8.28-1.276l5.708.853c3.807.763 8.516 3.042 14.133 6.851 5.614 3.806 10.229 8.754 13.846 14.842 4.38 7.806 9.657 13.754 15.846 17.847 6.184 4.093 12.419 6.136 18.699 6.136 6.28 0 11.704-.476 16.274-1.423 4.565-.952 8.848-2.383 12.847-4.285 1.713-12.758 6.377-22.559 13.988-29.41-10.848-1.14-20.601-2.857-29.264-5.14-8.658-2.286-17.605-5.996-26.835-11.14-9.235-5.137-16.896-11.516-22.985-19.126-6.09-7.614-11.088-17.61-14.987-29.979-3.901-12.374-5.852-26.648-5.852-42.826 0-23.035 7.52-42.637 22.557-58.817-7.044-17.318-6.379-36.732 1.997-58.24 5.52-1.715 13.706-.428 24.554 3.853 10.85 4.283 18.794 7.952 23.84 10.994 5.046 3.041 9.089 5.618 12.135 7.708 17.705-4.947 35.976-7.421 54.818-7.421s37.117 2.474 54.823 7.421l10.849-6.849c7.419-4.57 16.18-8.758 26.262-12.565 10.088-3.805 17.802-4.853 23.134-3.138 8.562 21.509 9.325 40.922 2.279 58.24 15.036 16.18 22.559 35.787 22.559 58.817 0 16.178-1.958 30.497-5.853 42.966-3.9 12.471-8.941 22.457-15.125 29.979-6.191 7.521-13.901 13.85-23.131 18.986-9.232 5.14-18.182 8.85-26.84 11.136-8.662 2.286-18.415 4.004-29.263 5.146 9.894 8.562 14.842 22.077 14.842 40.539v60.237c0 3.422 1.19 6.279 3.572 8.562 2.379 2.279 6.136 2.95 11.276 1.995 44.163-14.653 80.185-41.062 108.068-79.226 27.88-38.161 41.825-81.126 41.825-128.906-.01-39.771-9.818-76.454-29.414-110.049z"></path></svg>');function $c(b,l){let f=Ar(l,["$$slots","$$events","$$legacy"]);var $=gc();Ia($,()=>({viewBox:"0 0 438.549 438.549",...f})),t(b,$)}const os=6900;var hc=i('<!> <span class="w-8 text-xs text-muted-foreground tabular-nums"> </span>',1);function xc(b,l){sr(l,!0);async function f(){try{return(await(await fetch("https://ungh.cc/repos/zan8in/afrog")).json()).repo?.stars??os}catch(x){return console.error(x),os}}let $=L(xa(os));Kr(()=>{f().then(x=>{c($,x,!0)}).catch(x=>{console.error(x),c($,os,!0)})}),ee(b,{get href(){return Bn.links.github},target:"_blank",rel:"noreferrer",size:"sm",variant:"ghost",class:"h-8 shadow-none",children:(x,u)=>{var A=hc(),Q=d(A);$c(Q,{});var J=r(Q,2),Ke=o(J,!0);s(J),T(Ue=>P(Ke,Ue),[()=>e($)>=1e3?`${(e($)/1e3).toFixed(1)}k`:e($).toLocaleString()]),t(x,A)},$$slots:{default:!0}}),or()}var bc=i('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-4.5"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M12 3l0 18"></path><path d="M12 9l4.65 -4.65"></path><path d="M12 14.3l7.37 -7.37"></path><path d="M12 19.6l8.85 -8.85"></path></svg> <span class="sr-only">Toggle theme</span>',1);function yc(b){ee(b,{variant:"ghost",size:"icon",class:"group/toggle extend-touch-target size-8",get onclick(){return mn},title:"Toggle theme",children:(l,f)=>{var $=bc();p(2),t(l,$)},$$slots:{default:!0}})}function Pc(){return[{title:"Introduction",href:"/docs",items:[]},{title:"Installation",href:"/docs/installation",items:[]},{title:"components.json",href:"/docs/components-json",items:[]},{title:"Theming",href:"/docs/theming",items:[]},{title:"Dark Mode",href:"/docs/dark-mode",items:[]},{title:"CLI",href:"/docs/cli",items:[]},{title:"JavaScript",href:"/docs/javascript",items:[]},{title:"Figma",href:"/docs/figma",items:[]},{title:"Changelog",href:"/docs/changelog",items:[]},{title:"Legacy Docs",href:"/docs/legacy",items:[]}]}const ro=["SvelteKit","Vite","Astro","Manual Installation"];function wc(){return[].sort((l,f)=>{const $=ro.indexOf(l.title),x=ro.indexOf(f.title);return $-x})}function kc(){return[]}function Sc(){return[{title:"Svelte",href:"/docs/dark-mode/svelte",items:[]},{title:"Astro",href:"/docs/dark-mode/astro",items:[]}]}function zc(){return[{title:"Registry",href:"/docs/registry",items:[]},{title:"Getting Started",href:"/docs/registry/getting-started",items:[]},{title:"FAQ",href:"/docs/registry/faq",items:[]},{title:"Examples",href:"/docs/registry/examples",items:[]},{title:"registry.json",href:"/docs/registry/registry-json",items:[]},{title:"registry-item.json",href:"/docs/registry/registry-item-json",items:[]}]}function Tc(){return[]}const Ic=Pc(),Ac=Tc(),Cc=kc(),Lc=wc(),Mc=Sc(),jc=zc(),Nc=[],po=gn(no,b=>[{title:b("nav_reports"),href:"/reports"},{title:b("nav_pocs"),href:"/pocs"},{title:b("nav_docs"),href:"/docs"}]);function Ec(){return[...Ic,...Ac,...Cc,...Lc.filter(b=>b.title!=="Installation"),...Mc.filter(b=>b.title!=="Dark Mode"),...jc].map((b,l)=>({...b,index:l}))}Ec();var Oc=i("<a> </a>"),Bc=i('<div class="relative flex h-8 w-4 items-center justify-center"><div class="relative size-4"><span></span> <span></span></div> <span class="sr-only">Toggle Menu</span></div> <span class="flex h-8 items-center text-lg leading-none font-medium"> </span>',1),Fc=i('<div class="flex flex-col gap-4"><div class="text-sm font-medium text-muted-foreground"> </div> <div class="flex flex-col gap-3"></div></div>'),Dc=i('<div class="flex flex-col gap-12 overflow-auto px-6 py-6"><div class="flex flex-col gap-4"><div class="text-sm font-medium text-muted-foreground"> </div> <div class="flex flex-col gap-3"><!> <!></div></div> <div class="flex flex-col gap-8"></div></div>'),Rc=i("<!> <!>",1);function Qc(b,l){sr(l,!0);const[f,$]=lo(),x=()=>Is(no,"$t",f),u=()=>Is(po,"$mainNavItems",f),A=(Vt,lt)=>{let kt=()=>lt?.().href,dr=()=>lt?.().content,Ft=()=>lt?.().class,Xe=()=>$n(lt?.(),["href","content","class"]);var Ye=Oc(),Oe=()=>{c(J,!1)};Ia(Ye,gr=>({href:kt(),onclick:Oe,class:gr,...Xe()}),[()=>mr("text-2xl font-medium",Ft())]);var Dt=o(Ye,!0);s(Ye),T(()=>P(Dt,dr())),t(Vt,Ye)};let Q=Ar(l,["$$slots","$$events","$$legacy","class"]),J=L(!1);var Ke=N(),Ue=d(Ke);a(Ue,()=>Na,(Vt,lt)=>{lt(Vt,{get open(){return e(J)},set open(kt){c(J,kt,!0)},children:(kt,dr)=>{var Ft=Rc(),Xe=d(Ft);{const Oe=(Dt,gr)=>{let Ht=()=>gr?.().props;{let jt=E(()=>mr("extend-touch-target h-8 touch-manipulation items-center justify-start gap-2.5 !p-0 hover:bg-transparent focus-visible:bg-transparent focus-visible:ring-0 active:bg-transparent dark:hover:bg-transparent",l.class));ee(Dt,_r(Ht,()=>Q,{variant:"ghost",get class(){return e(jt)},children:($e,at)=>{var Fe=Bc(),Nt=d(Fe),vt=o(Nt),ut=o(vt),Et=r(ut,2);s(vt),p(2),s(Nt);var Ze=r(Nt,2),Ot=o(Ze,!0);s(Ze),T((Kt,yt,qt)=>{jr(ut,1,Kt),jr(Et,1,yt),P(Ot,qt)},[()=>Js(mr("absolute left-0 block h-0.5 w-4 bg-foreground transition-all duration-100",e(J)?"top-[0.4rem] -rotate-45":"top-1")),()=>Js(mr("absolute left-0 block h-0.5 w-4 bg-foreground transition-all duration-100",e(J)?"top-[0.4rem] rotate-45":"top-2.5")),()=>x()("nav_menu")]),t($e,Fe)},$$slots:{default:!0}}))}};a(Xe,()=>ja,(Dt,gr)=>{gr(Dt,{child:Oe,$$slots:{child:!0}})})}var Ye=r(Xe,2);a(Ye,()=>Ma,(Oe,Dt)=>{Dt(Oe,{class:"no-scrollbar h-(--bits-popover-content-available-height) w-(--bits-popover-content-available-width) overflow-y-auto rounded-none border-none bg-background/90 p-0 shadow-none backdrop-blur duration-100",align:"start",side:"bottom",alignOffset:-16,sideOffset:14,preventScroll:!0,children:(gr,Ht)=>{var jt=Dc(),$e=o(jt),at=o($e),Fe=o(at,!0);s(at);var Nt=r(at,2),vt=o(Nt);{let Ze=E(()=>({href:"/",content:x()("nav_home")}));A(vt,()=>e(Ze))}var ut=r(vt,2);Pr(ut,1,u,Ts,(Ze,Ot)=>{A(Ze,()=>({href:e(Ot).href,content:e(Ot).title}))}),s(Nt),s($e);var Et=r($e,2);Pr(Et,21,()=>Nc,Ze=>Ze.title,(Ze,Ot)=>{var Kt=Fc(),yt=o(Kt),qt=o(yt,!0);s(yt);var st=r(yt,2);Pr(st,21,()=>e(Ot).items,Ts,(Wt,Jt)=>{A(Wt,()=>({href:e(Jt).href,content:e(Jt).title}))}),s(st),s(Kt),T(()=>P(qt,e(Ot).title)),t(Ze,Kt)}),s(Et),s(jt),T(Ze=>P(Fe,Ze),[()=>x()("nav_menu")]),t(gr,jt)},$$slots:{default:!0}})}),t(kt,Ft)},$$slots:{default:!0}})}),t(b,Ke),or(),$()}var Uc=i('<span class="sr-only">Toggle layout</span> <!>',1);function Hc(b,l){sr(l,!0);let f=Ar(l,["$$slots","$$events","$$legacy","class"]);const $=uo.get();{let x=E(()=>mr("size-8",l.class));ee(b,_r({variant:"ghost",size:"icon",get class(){return e(x)},onclick:()=>{$.setConfig({layout:$.current.layout==="full"?"fixed":"full"})}},()=>f,{title:"Toggle layout",children:(u,A)=>{var Q=Uc(),J=r(d(Q),2);hn(J,{}),t(u,Q)},$$slots:{default:!0}}))}or()}function qc(b,l){sr(l,!0);let f=L(void 0);Kr(()=>xn.subscribe(Q=>{c(f,Q??"zh",!0)}));const $=E(()=>e(f)==="zh"?"en":"zh"),x=E(()=>e($)==="en"?"EN":"中");function u(){const A=e($);if(Fn(A),typeof window<"u")try{localStorage.setItem("lang",A),document?.documentElement?.setAttribute("lang",A)}catch{}}ee(b,{variant:"ghost",size:"icon",class:"group/toggle extend-touch-target size-8",onclick:u,title:"Switch language",children:(A,Q)=>{p();var J=g();T(()=>P(J,e(x))),t(A,J)},$$slots:{default:!0}}),or()}var Gc=i("<!> <span> </span>",1),Vc=i('<div class="flex flex-col gap-1 text-xs"><p> </p> <p> </p></div>'),Kc=i("<!> <!>",1);function Wc(b,l){sr(l,!1);let f=Ya(0),$=Ya(0),x,u=Ya(!0),A=Ya(!1),Q=!0,J=0;function Ke(){return e(A)?Math.min(3e3*Math.pow(1.5,J),3e4):e(f)>50?2e3:5e3}async function Ue(){if(!Q)return;const Xe=new AbortController,Ye=setTimeout(()=>Xe.abort(),5e3);try{const Oe=await Ir.getServerInfo({signal:Xe.signal});clearTimeout(Ye),Oe.success&&Oe.data&&(c(f,Oe.data.cpu_usage||0),c($,Oe.data.memory_usage||0),c(u,!1),c(A,!1),J=0)}catch(Oe){Oe instanceof Error&&(Oe.name==="AbortError"||Oe.message==="timeout")||console.error("Failed to fetch server status",Oe),c(A,!0),J++}finally{Q&&(x=setTimeout(Ue,Ke()))}}function Vt(){Q=document.visibilityState==="visible",Q?(x&&clearTimeout(x),Ue()):x&&clearTimeout(x)}bn(()=>{Q=document.visibilityState==="visible",document.addEventListener("visibilitychange",Vt),Ue()}),yn(()=>{typeof document<"u"&&document.removeEventListener("visibilitychange",Vt),x&&clearTimeout(x)});function lt(Xe){return Xe<50?"border-transparent bg-green-500 text-white hover:bg-green-600":Xe<75?"border-transparent bg-yellow-500 text-white hover:bg-yellow-600":Xe<90?"border-transparent bg-orange-500 text-white hover:bg-orange-600":"border-transparent bg-red-500 text-white hover:bg-red-600"}Pn();var kt=N(),dr=d(kt);{var Ft=Xe=>{ca(Xe,{children:(Ye,Oe)=>{var Dt=Kc(),gr=d(Dt);va(gr,{children:(jt,$e)=>{{let at=kn(()=>lt(e(f)));za(jt,{variant:"outline",get class(){return`gap-1 transition-colors ${e(at)??""}`},children:(Fe,Nt)=>{var vt=Gc(),ut=d(vt);wn(ut,{class:"h-3.5 w-3.5"});var Et=r(ut,2),Ze=o(Et);s(Et),T(Ot=>P(Ze,`${Ot??""}%`),[()=>e(f).toFixed(1)]),t(Fe,vt)},$$slots:{default:!0}})}},$$slots:{default:!0}});var Ht=r(gr,2);ua(Ht,{children:(jt,$e)=>{var at=Vc(),Fe=o(at),Nt=o(Fe);s(Fe);var vt=r(Fe,2),ut=o(vt);s(vt),s(at),T((Et,Ze)=>{P(Nt,`CPU Usage: ${Et??""}%`),P(ut,`Memory Usage: ${Ze??""}%`)},[()=>e(f).toFixed(1),()=>e($).toFixed(1)]),t(jt,at)},$$slots:{default:!0}}),t(Ye,Dt)},$$slots:{default:!0}})};H(dr,Xe=>{!e(u)&&!e(A)&&Xe(Ft)})}t(b,kt),or()}var Jc=i('<!> <span class="sr-only">afrog security</span>',1),Xc=i('<header class="sticky top-0 z-50 w-full bg-background"><div class="container-wrapper px-6 3xl:fixed:px-0"><div class="flex h-(--header-height) items-center gap-2 **:data-[slot=separator]:!h-4 3xl:fixed:container"><!> <!> <!> <div class="ml-auto flex items-center gap-2 md:flex-1 md:justify-end"><div class="w-full flex-1 items-center gap-2 md:flex md:w-auto md:flex-none"><div class="hidden md:block"><!></div> <!></div> <!> <!> <!> <!> <!> <!></div></div></div></header>');function Yc(b){const[l,f]=lo(),$=()=>Is(po,"$mainNavItems",l);var x=Xc(),u=o(x),A=o(u),Q=o(A);Qc(Q,{class:"flex lg:hidden"});var J=r(Q,2);ee(J,{href:"/",variant:"ghost",size:"icon",class:"hidden size-8 lg:flex",children:(Ht,jt)=>{var $e=Jc(),at=d($e);On(at,{class:"size-5"}),p(2),t(Ht,$e)},$$slots:{default:!0}});var Ke=r(J,2);mc(Ke,{get items(){return $()},class:"hidden lg:flex"});var Ue=r(Ke,2),Vt=o(Ue),lt=o(Vt),kt=o(lt);Wc(kt,{}),s(lt);var dr=r(lt,2);qc(dr,{}),s(Vt);var Ft=r(Vt,2);Ss(Ft,{orientation:"vertical",class:"ml-2 hidden lg:block"});var Xe=r(Ft,2);xc(Xe,{});var Ye=r(Xe,2);Ss(Ye,{orientation:"vertical",class:"hidden 3xl:flex"});var Oe=r(Ye,2);Hc(Oe,{class:"hidden 3xl:flex"});var Dt=r(Oe,2);Ss(Dt,{orientation:"vertical"});var gr=r(Dt,2);yc(gr),s(Ue),s(A),s(u),s(x),t(b,x),f()}function Zc(b,l){sr(l,!0);let f=Ar(l,["$$slots","$$events","$$legacy"]);Sn(b,_r({get theme(){return zn.current},class:"toaster group",style:"--normal-bg: var(--color-popover); --normal-text: var(--color-popover-foreground); --normal-border: var(--color-border);"},()=>f)),or()}var ev=i("<!> <!> <!> <!>",1),tv=i('<!> <!> <div class="relative z-10 flex h-svh flex-col overflow-hidden bg-background theme-container"><!> <!> <!></div>',1);function gv(b,l){sr(l,!0),Kr(()=>{const{pathname:lt}=oo.url;console.log("pathname",lt),console.log("auth.authenticated",Zs.authenticated),lt!=="/login"&&(Zs.authenticated||Tn("/login",{replaceState:!0}))});const f=uo.set(new Vn(l.data.userConfig)),$={light:"#ffffff",dark:"#09090b"},x=E(()=>[`layout-${f.current.layout}`,`theme-${f.current.activeTheme}`]);In.pre(()=>f.current.activeTheme,()=>{Xs(f.current.activeTheme)}),Kr(()=>{f.current.activeTheme!=="mono"&&(f.setConfig({activeTheme:"mono"}),Xs("mono"))});var u=tv(),A=d(u);{let lt=E(()=>["dark",...e(x)]),kt=E(()=>["light",...e(x)]);An(A,{defaultMode:"system",disableTransitions:!0,get defaultTheme(){return f.current.activeTheme},get themeColors(){return $},get darkClassNames(){return e(lt)},get lightClassNames(){return e(kt)}})}var Q=r(A,2);Zc(Q,{position:"top-center"});var J=r(Q,2),Ke=o(J);Yc(Ke);var Ue=r(Ke,2);a(Ue,()=>ya,(lt,kt)=>{kt(lt,{class:"flex flex-1",children:(dr,Ft)=>{var Xe=ev(),Ye=d(Xe);a(Ye,()=>ba,(Ht,jt)=>{jt(Ht,{class:"flex flex-1 flex-col",children:($e,at)=>{var Fe=N(),Nt=d(Fe);qa(Nt,()=>l.children),t($e,Fe)},$$slots:{default:!0}})});var Oe=r(Ye,2);a(Oe,()=>fa,(Ht,jt)=>{jt(Ht,{orientation:"vertical",children:($e,at)=>{var Fe=N(),Nt=d(Fe);a(Nt,()=>pa,(vt,ut)=>{ut(vt,{})}),t($e,Fe)},$$slots:{default:!0}})});var Dt=r(Oe,2);a(Dt,()=>fa,(Ht,jt)=>{jt(Ht,{orientation:"horizontal",children:($e,at)=>{var Fe=N(),Nt=d(Fe);a(Nt,()=>pa,(vt,ut)=>{ut(vt,{})}),t($e,Fe)},$$slots:{default:!0}})});var gr=r(Dt,2);a(gr,()=>Ta,(Ht,jt)=>{jt(Ht,{})}),t(dr,Xe)},$$slots:{default:!0}})});var Vt=r(Ue,2);pc(Vt,{}),s(J),t(b,u),or()}export{gv as component,mv as universal};
