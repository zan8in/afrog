import{p as G,a as oe,x as de,g as _,Y as p,az as dt,_ as Me,w as le,d as r,e as H,ak as ot,aA as ct,f as u,C as je,D as Ye,i as c,aB as ut,v as Fe,j as t,k as T,aC as vt,aD as ft,aE as gt,a2 as Ce,a9 as qe,V as A,aF as mt,K as d,aG as _t,L as n,n as O,a5 as M,t as W,a3 as D,ah as Ue,ap as Be,aH as Xe,y as ee,aI as lt,ar as ht,W as it,aJ as pt,aK as $t,aL as Pt,aM as yt,c as He,aN as xt,aO as bt,aP as wt,aQ as Ct,u as Ge,aR as Ze,aS as Ee,aT as kt,aU as zt,av as St,aV as Ot,aW as At,aX as Et,m as Mt,aY as Tt}from"../chunks/D4cyIAOc.js";import{B as Oe,L as et}from"../chunks/CbWnNXBI.js";import{c as ye,B as re,g as Lt,b as Ve}from"../chunks/DGXkGyla.js";import{I as jt}from"../chunks/D5JYckiF.js";import{a as Re}from"../chunks/IBoLXy8H.js";import{M as Yt}from"../chunks/CZrxqf2I.js";import{R as Ft}from"../chunks/iwSb8Ohb.js";import{a as tt}from"../chunks/BbW0iGtY.js";function It(f,e){G(e,!0);let a=oe(e,"ref",15,null),l=le(e,["$$slots","$$events","$$legacy","ref"]);var o=de(),v=_(o);p(v,()=>dt,(g,C)=>{C(g,Me({"data-slot":"tooltip-trigger"},()=>l,{get ref(){return a()},set ref(k){a(k)}}))}),r(f,o),H()}var Dt=u("<div></div>"),Rt=u("<!> <!>",1);function Qt(f,e){G(e,!0);let a=oe(e,"ref",15,null),l=oe(e,"sideOffset",3,0),o=oe(e,"side",3,"top"),v=le(e,["$$slots","$$events","$$legacy","ref","class","sideOffset","side","children","arrowClasses"]);var g=de(),C=_(g);p(C,()=>ot,(k,E)=>{E(k,{children:($e,K)=>{var ge=de(),Pe=_(ge);{let ke=T(()=>ye("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-(--bits-tooltip-content-transform-origin) z-50 w-fit text-balance rounded-md px-3 py-1.5 text-xs",e.class));p(Pe,()=>ct,(ze,ce)=>{ce(ze,Me({"data-slot":"tooltip-content",get sideOffset(){return l()},get side(){return o()},get class(){return t(ke)}},()=>v,{get ref(){return a()},set ref(ue){a(ue)},children:(ue,xe)=>{var me=Rt(),ie=_(me);je(ie,()=>e.children??Ye);var Se=c(ie,2);{const Te=(z,V)=>{let te=()=>V?.().props;var be=Dt();Fe(be,y=>({class:y,...te()}),[()=>ye("bg-primary z-50 size-2.5 rotate-45 rounded-[2px]","data-[side=top]:translate-x-1/2 data-[side=top]:translate-y-[calc(-50%_+_2px)]","data-[side=bottom]:-translate-x-1/2 data-[side=bottom]:-translate-y-[calc(-50%_+_1px)]","data-[side=right]:translate-x-[calc(50%_+_2px)] data-[side=right]:translate-y-1/2","data-[side=left]:-translate-y-[calc(50%_-_3px)]",e.arrowClasses)]),r(z,be)};p(Se,()=>ut,(z,V)=>{V(z,{child:Te,$$slots:{child:!0}})})}r(ue,me)},$$slots:{default:!0}}))})}r($e,ge)},$$slots:{default:!0}})}),r(f,g),H()}function at(f,e){G(e,!0);let a=oe(e,"ref",15,null),l=oe(e,"open",15,!1),o=le(e,["$$slots","$$events","$$legacy","ref","open"]);var v=de(),g=_(v);p(g,()=>vt,(C,k)=>{k(C,Me({"data-slot":"collapsible"},()=>o,{get ref(){return a()},set ref(E){a(E)},get open(){return l()},set open(E){l(E)}}))}),r(f,v),H()}function st(f,e){G(e,!0);let a=oe(e,"ref",15,null),l=le(e,["$$slots","$$events","$$legacy","ref"]);var o=de(),v=_(o);p(v,()=>ft,(g,C)=>{C(g,Me({"data-slot":"collapsible-trigger"},()=>l,{get ref(){return a()},set ref(k){a(k)}}))}),r(f,o),H()}function rt(f,e){G(e,!0);let a=oe(e,"ref",15,null),l=le(e,["$$slots","$$events","$$legacy","ref"]);var o=de(),v=_(o);p(v,()=>gt,(g,C)=>{C(g,Me({"data-slot":"collapsible-content"},()=>l,{get ref(){return a()},set ref(k){a(k)}}))}),r(f,o),H()}class Ut{#e=Ce(qe({source:"all",severity:[],tags:[],author:[],timeRange:"all",favorites:!1,searchQuery:""}));get filters(){return t(this.#e)}set filters(e){A(this.#e,e,!0)}#t=Ce(qe([]));get pocs(){return t(this.#t)}set pocs(e){A(this.#t,e,!0)}#a=Ce(qe({total:0,builtin:0,curated:0,my:0,bySeverity:{critical:0,high:0,medium:0,low:0,info:0},topTags:[],topAuthors:[]}));get stats(){return t(this.#a)}set stats(e){A(this.#a,e,!0)}#s=Ce(null);get selectedPoc(){return t(this.#s)}set selectedPoc(e){A(this.#s,e,!0)}#r=Ce(!1);get loading(){return t(this.#r)}set loading(e){A(this.#r,e,!0)}#o=Ce(!1);get sidebarCollapsed(){return t(this.#o)}set sidebarCollapsed(e){A(this.#o,e,!0)}#l=Ce(qe({page:1,pageSize:10,total:0}));get pagination(){return t(this.#l)}set pagination(e){A(this.#l,e,!0)}async loadPocs(){this.loading=!0;try{const e=new mt;this.filters.source!=="all"&&e.append("source",this.filters.source),this.filters.severity.length>0&&e.append("severity",this.filters.severity.join(",")),this.filters.tags.length>0&&e.append("tags",this.filters.tags.join(",")),this.filters.author.length>0&&e.append("author",this.filters.author.join(",")),this.filters.timeRange!=="all"&&e.append("time_range",this.filters.timeRange),this.filters.favorites&&e.append("favorites","true"),this.filters.searchQuery&&e.append("q",this.filters.searchQuery),e.append("page",this.pagination.page.toString()),e.append("page_size",this.pagination.pageSize.toString());const a=await Re.get(`/pocs?${e.toString()}`);a.success&&a.data?a.data.items?(this.pocs=a.data.items,this.pagination.total=a.data.total||0):Array.isArray(a.data)?(this.pocs=a.data,this.pagination.total=a.data.length):(this.pocs=[],this.pagination.total=0):(this.pocs=[],this.pagination.total=0)}catch(e){console.error("Failed to load POCs:",e),this.pocs=[],this.pagination.total=0}finally{this.loading=!1}}async loadStats(){try{const e=await Re.loadPocsStats();if(e.success&&e.data){const a=e.data;this.stats={total:a?.total??0,builtin:a?.by_source?.builtin??0,curated:a?.by_source?.curated??0,my:a?.by_source?.my??0,bySeverity:{critical:a?.by_severity?.critical??0,high:a?.by_severity?.high??0,medium:a?.by_severity?.medium??0,low:a?.by_severity?.low??0,info:a?.by_severity?.info??0},topTags:a?.top_tags??[],topAuthors:a?.top_authors??[]}}}catch(e){console.error("Failed to load POC stats:",e)}}async searchPocs(e){this.filters.searchQuery=e,this.pagination.page=1,await Promise.all([this.loadPocs(),this.loadStats()])}async updateFilters(e){this.filters={...this.filters,...e},this.pagination.page=1,await Promise.all([this.loadPocs(),this.loadStats()])}async selectPoc(e){if(this.selectedPoc=e,e&&!e.yaml_content){const a=e.poc_id||e.id?.toString();a?await this.loadPocContent(a):console.warn("POC has no valid ID:",e)}}async loadPocContent(e){try{const a=await Re.getPocYamlContent(e);if(a.success&&a.data&&this.selectedPoc){this.selectedPoc.yaml_content=a.data;const l=this.pocs.findIndex(o=>o.poc_id&&o.poc_id===e||o.id&&o.id.toString()===e);l!==-1&&(this.pocs[l].yaml_content=a.data)}}catch(a){console.error("Failed to load POC content:",a)}}async deletePoc(e){try{(await Re.delete(`/pocs/${e}`)).success&&(this.pocs=this.pocs.filter(l=>l.poc_id!==e),this.selectedPoc?.poc_id===e&&(this.selectedPoc=null),await this.loadStats())}catch(a){console.error("Failed to delete POC:",a)}}async syncCuratedPocs(){try{(await Re.post("/pocs/curated/sync")).success&&await Promise.all([this.loadPocs(),this.loadStats()])}catch(e){console.error("Failed to sync Curated POCs:",e)}}toggleSidebar(){this.sidebarCollapsed=!this.sidebarCollapsed}async goToPage(e){this.pagination.page=e,await Promise.all([this.loadPocs(),this.loadStats()])}async changePageSize(e){this.pagination.pageSize=e,this.pagination.page=1,await Promise.all([this.loadPocs(),this.loadStats()])}async init(){await Promise.all([this.loadPocs(),this.loadStats()])}}const s=new Ut;var qt=u('<span class="text-sm">全部 PoCs</span> <!>',1),Bt=u('<span class="text-sm">公共 PoCs</span> <!>',1),Vt=u('<span class="text-sm">精选 PoCs</span> <!>',1),Nt=u('<span class="text-sm">我的 PoCs</span> <!>',1),Wt=u('<span class="text-sm capitalize"> </span> <!>',1),Gt=u('<div class="flex items-center gap-2"><!></div> <!>',1),Ht=u('<span class="text-sm w-full truncate"> </span> <!>',1),Kt=u('<div class="space-y-2"><!> <!> <!></div>'),Jt=u('<div class="text-sm text-muted-foreground p-2">暂无标签数据</div>'),Xt=u('<div class="p-4 border-b"><!> <!></div>'),Zt=u('<div class="flex items-center gap-2"><!></div> <!>',1),ea=u('<span class="text-sm w-full truncate"> </span> <!>',1),ta=u('<div class="space-y-2"><!> <!> <!></div>'),aa=u('<div class="p-4 border-b"><!> <!></div>'),sa=u('<div class="w-64 h-full bg-card border-r flex flex-col"><div class="p-4 border-b"><h2 class="font-semibold text-lg">POC 管理</h2></div> <div class="flex-1 overflow-y-auto"><div class="p-4 border-b"><div class="relative"><!> <!></div></div> <div class="p-4 border-b"><div class="space-y-2"><!> <!> <!> <!></div></div> <div class="p-4 border-b"><div class="space-y-2"></div></div> <!> <!></div> <div class="p-4 border-t"><!></div></div>');function ra(f,e){G(e,!0);let a=oe(e,"stats",19,()=>s.stats);oe(e,"loading",19,()=>s.loading);let l=qe({tags:!1,authors:!1});function o(y){const P=[...s.filters.severity];P.includes(y)?s.updateFilters({severity:P.filter(Q=>Q!==y)}):s.updateFilters({severity:[...P,y]})}function v(y){const P=[...s.filters.tags];P.includes(y)?s.updateFilters({tags:P.filter(Q=>Q!==y)}):s.updateFilters({tags:[...P,y]})}function g(y){const P=[...s.filters.author];P.includes(y)?s.updateFilters({author:P.filter(Q=>Q!==y)}):s.updateFilters({author:[...P,y]})}function C(){s.updateFilters({source:"all",severity:[],tags:[],author:[],timeRange:"all",favorites:!1,searchQuery:""})}const k=["critical","high","medium","low","info"];var E=sa(),$e=c(d(E),2),K=d($e),ge=d(K),Pe=d(ge);_t(Pe,{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"});var ke=c(Pe,2);jt(ke,{placeholder:"搜索 PoC 名称、ID、标签",class:"pl-9",onkeydown:y=>{y.key==="Enter"&&s.searchPocs(s.filters.searchQuery)},get value(){return s.filters.searchQuery},set value(y){s.filters.searchQuery=y}}),n(ge),n(K);var ze=c(K,2),ce=d(ze),ue=d(ce);{let y=T(()=>s.filters.source==="all"?"bg-muted":"");re(ue,{get class(){return`w-full flex items-center justify-between p-2 rounded-md hover:bg-muted transition-colors text-left no-underline ${t(y)??""}`},onclick:()=>s.updateFilters({source:"all"}),variant:"ghost",children:(P,Q)=>{var ae=qt(),Z=c(_(ae),2);Oe(Z,{variant:"secondary",children:(i,$)=>{O();var h=M();W(()=>D(h,a().total)),r(i,h)},$$slots:{default:!0}}),r(P,ae)},$$slots:{default:!0}})}var xe=c(ue,2);{let y=T(()=>s.filters.source==="builtin"?"bg-muted":"");re(xe,{get class(){return`w-full flex items-center justify-between p-2 rounded-md un hover:bg-muted transition-colors text-left no-underline ${t(y)??""}`},onclick:()=>s.updateFilters({source:"builtin"}),variant:"ghost",children:(P,Q)=>{var ae=Bt(),Z=c(_(ae),2);Oe(Z,{variant:"secondary",children:(i,$)=>{O();var h=M();W(()=>D(h,a().builtin)),r(i,h)},$$slots:{default:!0}}),r(P,ae)},$$slots:{default:!0}})}var me=c(xe,2);{let y=T(()=>s.filters.source==="curated"?"bg-muted":"");re(me,{get class(){return`w-full flex items-center justify-between p-2 rounded-md un hover:bg-muted transition-colors text-left no-underline ${t(y)??""}`},onclick:()=>s.updateFilters({source:"curated"}),variant:"ghost",children:(P,Q)=>{var ae=Vt(),Z=c(_(ae),2);Oe(Z,{variant:"secondary",children:(i,$)=>{O();var h=M();W(()=>D(h,a().curated)),r(i,h)},$$slots:{default:!0}}),r(P,ae)},$$slots:{default:!0}})}var ie=c(me,2);{let y=T(()=>s.filters.source==="my"?"bg-muted":"");re(ie,{get class(){return`w-full flex items-center justify-between p-2 rounded-md hover:bg-muted transition-colors text-left no-underline ${t(y)??""}`},onclick:()=>s.updateFilters({source:"my"}),variant:"ghost",children:(P,Q)=>{var ae=Nt(),Z=c(_(ae),2);Oe(Z,{variant:"secondary",children:(i,$)=>{O();var h=M();W(()=>D(h,a().my)),r(i,h)},$$slots:{default:!0}}),r(P,ae)},$$slots:{default:!0}})}n(ce),n(ze);var Se=c(ze,2),Te=d(Se);Ue(Te,21,()=>k,Be,(y,P)=>{{let Q=T(()=>s.filters.severity.includes(t(P))?"bg-muted":"");re(y,{get class(){return`w-full flex items-center justify-between p-2 rounded-md hover:bg-muted transition-colors text-left no-underline ${t(Q)??""}`},onclick:()=>o(t(P)),variant:"ghost",children:(ae,Z)=>{var i=Wt(),$=_(i),h=d($,!0);n($);var m=c($,2);Oe(m,{variant:"secondary",children:(x,ne)=>{O();var L=M();W(()=>D(L,a().bySeverity[t(P)])),r(x,L)},$$slots:{default:!0}}),W(()=>D(h,t(P))),r(ae,i)},$$slots:{default:!0}})}}),n(Te),n(Se);var z=c(Se,2);p(z,()=>at,(y,P)=>{P(y,{open:!0,children:(Q,ae)=>{var Z=Xt(),i=d(Z);p(i,()=>st,(h,m)=>{m(h,{class:"flex items-center justify-between w-full mb-3",children:(x,ne)=>{var L=Gt(),J=_(L),U=d(J);et(U,{class:"font-medium",children:(b,j)=>{O();var w=M("按标签分类");r(b,w)},$$slots:{default:!0}}),n(J);var Y=c(J,2);{let b=T(()=>`w-4 h-4 transition-transform ${l.tags?"rotate-180":""}`);Xe(Y,{get class(){return t(b)}})}r(x,L)},$$slots:{default:!0}})});var $=c(i,2);p($,()=>rt,(h,m)=>{m(h,{children:(x,ne)=>{var L=de(),J=_(L);{var U=b=>{var j=Kt(),w=d(j);Ue(w,17,()=>a().topTags.slice(0,l.tags?a().topTags.length:5),Be,(R,F)=>{let B=()=>t(F).tag,N=()=>t(F).count;{let he=T(()=>s.filters.tags.includes(B())?"bg-muted":"");re(R,{get class(){return`w-full flex items-center justify-between p-2 rounded-md hover:bg-muted transition-colors text-left no-underline ${t(he)??""}`},onclick:()=>v(B()),variant:"ghost",children:(X,we)=>{var ve=Ht(),se=_(ve),Ae=d(se,!0);n(se);var fe=c(se,2);Oe(fe,{variant:"outline",children:(pe,Ie)=>{O();var Le=M();W(()=>D(Le,N())),r(pe,Le)},$$slots:{default:!0}}),W(()=>D(Ae,B())),r(X,ve)},$$slots:{default:!0}})}});var I=c(w,2);{var S=R=>{re(R,{variant:"ghost",size:"sm",class:"w-full",onclick:()=>{l.tags=!0},children:(F,B)=>{O();var N=M();W(()=>D(N,`显示更多... (${a().topTags.length-5} 个)`)),r(F,N)},$$slots:{default:!0}})};ee(I,R=>{!l.tags&&a().topTags.length>5&&R(S)})}var q=c(I,2);{var _e=R=>{re(R,{variant:"ghost",size:"sm",class:"w-full",onclick:()=>{l.tags=!1},children:(F,B)=>{O();var N=M("收起");r(F,N)},$$slots:{default:!0}})};ee(q,R=>{l.tags&&a().topTags.length>5&&R(_e)})}n(j),r(b,j)},Y=b=>{var j=Jt();r(b,j)};ee(J,b=>{a().topTags.length>0?b(U):b(Y,!1)})}r(x,L)},$$slots:{default:!0}})}),n(Z),r(Q,Z)},$$slots:{default:!0}})});var V=c(z,2);p(V,()=>at,(y,P)=>{P(y,{open:!0,children:(Q,ae)=>{var Z=aa(),i=d(Z);p(i,()=>st,(h,m)=>{m(h,{class:"flex items-center justify-between w-full mb-3",children:(x,ne)=>{var L=Zt(),J=_(L),U=d(J);et(U,{class:"font-medium",children:(b,j)=>{O();var w=M("按作者分类");r(b,w)},$$slots:{default:!0}}),n(J);var Y=c(J,2);{let b=T(()=>`w-4 h-4 transition-transform ${l.authors?"rotate-180":""}`);Xe(Y,{get class(){return t(b)}})}r(x,L)},$$slots:{default:!0}})});var $=c(i,2);p($,()=>rt,(h,m)=>{m(h,{children:(x,ne)=>{var L=ta(),J=d(L);Ue(J,17,()=>a().topAuthors.slice(0,l.authors?a().topAuthors.length:5),Be,(w,I)=>{let S=()=>t(I).author,q=()=>t(I).count;{let _e=T(()=>s.filters.author.includes(S())?"bg-muted":"");re(w,{get class(){return`w-full flex items-center justify-between p-2 rounded-md hover:bg-muted transition-colors text-left no-underline ${t(_e)??""}`},onclick:()=>g(S()),variant:"ghost",children:(R,F)=>{var B=ea(),N=_(B),he=d(N,!0);n(N);var X=c(N,2);Oe(X,{variant:"outline",children:(we,ve)=>{O();var se=M();W(()=>D(se,q())),r(we,se)},$$slots:{default:!0}}),W(()=>D(he,S())),r(R,B)},$$slots:{default:!0}})}});var U=c(J,2);{var Y=w=>{re(w,{variant:"ghost",size:"sm",class:"w-full",onclick:()=>l.authors=!0,children:(I,S)=>{O();var q=M();W(()=>D(q,`显示更多... (${a().topAuthors.length-5} 个)`)),r(I,q)},$$slots:{default:!0}})};ee(U,w=>{!l.authors&&a().topAuthors.length>5&&w(Y)})}var b=c(U,2);{var j=w=>{re(w,{variant:"ghost",size:"sm",class:"w-full",onclick:()=>l.authors=!1,children:(I,S)=>{O();var q=M("收起");r(I,q)},$$slots:{default:!0}})};ee(b,w=>{l.authors&&a().topAuthors.length>5&&w(j)})}n(L),r(x,L)},$$slots:{default:!0}})}),n(Z),r(Q,Z)},$$slots:{default:!0}})}),n($e);var te=c($e,2),be=d(te);re(be,{variant:"outline",size:"sm",class:"w-full",onclick:C,children:(y,P)=>{O();var Q=M("清空筛选");r(y,Q)},$$slots:{default:!0}}),n(te),n(E),r(f,E),H()}var oa=u('<div class="flex items-center justify-center h-32"><div class="text-muted-foreground">加载中...</div></div>'),la=u('<div class="flex items-center justify-center h-32"><div class="text-muted-foreground"></div></div>'),ia=(f,e,a)=>e(t(a)),na=u("<!> <!>",1),da=u("<!> <!>",1),ca=u('<div class="flex flex-wrap gap-1 mt-2"><!></div>'),ua=u('<button type="button"><div class="flex-1 min-w-0"><div class="flex items-center justify-between mb-1"><div class="flex items-center gap-2"><span class="text-xs text-muted-foreground truncate max-w-[100px]"> </span> <!></div> <div class="flex items-center gap-2 text-xs text-muted-foreground"><span> </span></div></div> <div class="font-sm text-foreground mb-1 truncate"> </div> <div class="text-sm text-muted-foreground line-clamp-2 leading-relaxed svelte-efadq"> </div> <!></div></button>'),va=u('<div class="flex flex-col h-full bg-background"><div class="flex items-center justify-between p-4 border-b"><div class="flex items-center gap-2"><h1 class="text-lg font-semibold">POC 列表</h1> <!></div></div> <div class="flex-1 overflow-auto"><!></div> <div class="p-3 border-t flex items-center justify-between"><div class="text-sm text-muted-foreground"> </div> <div class="flex items-center gap-2"><!> <!></div></div></div>');function fa(f,e){G(e,!0);let a="",l=Ce(null),o=T(()=>{if(!s.pocs)return[];let z=s.pocs;if(a.trim()){const V=a.toLowerCase();z=z.filter(te=>te.name.toLowerCase().includes(V)||te.author&&typeof te.author=="string"&&te.author.toLowerCase().includes(V)||te.description.toLowerCase().includes(V)||te.tags&&typeof te.tags=="string"&&te.tags.toLowerCase().includes(V))}return z});function v(){s.pagination.page>1&&s.goToPage(s.pagination.page-1)}function g(){const z=Math.max(1,Math.ceil(s.pagination.total/s.pagination.pageSize));s.pagination.page<z&&s.goToPage(s.pagination.page+1)}async function C(z){A(l,z,!0),await s.selectPoc(z)}var k=va(),E=d(k),$e=d(E),K=c(d($e),2);{var ge=z=>{Oe(z,{variant:"secondary",class:"ml-2",children:(V,te)=>{O();var be=M();W(()=>D(be,s.pagination.total)),r(V,be)},$$slots:{default:!0}})};ee(K,z=>{s.pagination.total&&z(ge)})}n($e),n(E);var Pe=c(E,2),ke=d(Pe);{var ze=z=>{var V=oa();r(z,V)},ce=z=>{var V=de(),te=_(V);{var be=P=>{var Q=la(),ae=d(Q);ae.textContent="暂无 POC 数据",n(Q),r(P,Q)},y=P=>{var Q=de(),ae=_(Q);Ue(ae,19,()=>t(o),(Z,i)=>Z.poc_id||Z.id||i,(Z,i)=>{var $=ua();$.__click=[ia,C,i];var h=d($),m=d(h),x=d(m),ne=d(x),L=d(ne,!0);n(ne);var J=c(ne,2);{let R=T(()=>`${Lt(t(i).severity)} lowercase`);Oe(J,{variant:"secondary",get class(){return t(R)},children:(F,B)=>{O();var N=M();W(()=>D(N,t(i).severity)),r(F,N)},$$slots:{default:!0}})}n(x);var U=c(x,2),Y=d(U),b=d(Y,!0);n(Y),n(U),n(m);var j=c(m,2),w=d(j,!0);n(j);var I=c(j,2),S=d(I,!0);n(I);var q=c(I,2);{var _e=R=>{var F=ca(),B=d(F);{var N=X=>{var we=na(),ve=_(we);Ue(ve,17,()=>t(i).tags.split(",").slice(0,4),Be,(fe,pe)=>{Oe(fe,{variant:"outline",class:"text-xs px-1.5 py-0.5",children:(Ie,Le)=>{O();var De=M();W(Qe=>D(De,Qe),[()=>t(pe).trim()]),r(Ie,De)},$$slots:{default:!0}})});var se=c(ve,2);{var Ae=fe=>{Oe(fe,{variant:"outline",class:"text-xs px-1.5 py-0.5",children:(pe,Ie)=>{O();var Le=M();W(De=>D(Le,`+${De??""}`),[()=>t(i).tags.split(",").length-4]),r(pe,Le)},$$slots:{default:!0}})};ee(se,fe=>{t(i).tags.split(",").length>4&&fe(Ae)})}r(X,we)},he=X=>{var we=de(),ve=_(we);{var se=fe=>{var pe=da(),Ie=_(pe);Ue(Ie,17,()=>t(i).tags.slice(0,4),Be,(Qe,Ne)=>{Oe(Qe,{variant:"outline",class:"text-xs px-1.5 py-0.5",children:(Ke,We)=>{O();var Je=M();W(nt=>D(Je,nt),[()=>String(t(Ne))]),r(Ke,Je)},$$slots:{default:!0}})});var Le=c(Ie,2);{var De=Qe=>{Oe(Qe,{variant:"outline",class:"text-xs px-1.5 py-0.5",children:(Ne,Ke)=>{O();var We=M();W(()=>D(We,`+${t(i).tags.length-4}`)),r(Ne,We)},$$slots:{default:!0}})};ee(Le,Qe=>{t(i).tags.length>4&&Qe(De)})}r(fe,pe)},Ae=fe=>{Oe(fe,{variant:"outline",class:"text-xs px-1.5 py-0.5",children:(pe,Ie)=>{O();var Le=M();W(De=>D(Le,De),[()=>String(t(i).tags)]),r(pe,Le)},$$slots:{default:!0}})};ee(ve,fe=>{Array.isArray(t(i).tags)&&t(i).tags.length>0?fe(se):fe(Ae,!1)},!0)}r(X,we)};ee(B,X=>{typeof t(i).tags=="string"?X(N):X(he,!1)})}n(F),r(R,F)};ee(q,R=>{t(i).tags&&R(_e)})}n(h),n($),W(R=>{ht($,1,R,"svelte-efadq"),D(L,t(i).author),D(b,t(i).created),D(w,t(i).name),D(S,t(i).id||"暂无ID")},[()=>`flex items-start gap-4 p-4 border-b hover:bg-muted/50 cursor-pointer w-full text-left transition-colors ${(s.selectedPoc?.poc_id??s.selectedPoc?.id?.toString())===(t(i).poc_id??t(i).id?.toString())?"bg-muted/50":""}`]),r(Z,$)}),r(P,Q)};ee(te,P=>{!t(o)||t(o).length===0?P(be):P(y,!1)},!0)}r(z,V)};ee(ke,z=>{s.loading?z(ze):z(ce,!1)})}n(Pe);var ue=c(Pe,2),xe=d(ue),me=d(xe);n(xe);var ie=c(xe,2),Se=d(ie);{let z=T(()=>s.pagination.page<=1);re(Se,{variant:"outline",size:"sm",onclick:v,get disabled(){return t(z)},children:(V,te)=>{O();var be=M("上一页");r(V,be)},$$slots:{default:!0}})}var Te=c(Se,2);{let z=T(()=>s.pagination.page>=Math.max(1,Math.ceil(s.pagination.total/s.pagination.pageSize)));re(Te,{variant:"outline",size:"sm",onclick:g,get disabled(){return t(z)},children:(V,te)=>{O();var be=M("下一页");r(V,be)},$$slots:{default:!0}})}n(ie),n(ue),n(k),W(()=>D(me,`第 ${s.pagination.page??""} 页，共 ${s.pagination.total??""} 条`)),r(f,k),H()}lt(["click"]);const ga=it({base:"flex w-fit items-stretch has-[>[data-slot=button-group]]:gap-2 [&>*]:focus-visible:relative [&>*]:focus-visible:z-10 has-[select[aria-hidden=true]:last-child]:[&>[data-slot=select-trigger]:last-of-type]:rounded-r-md [&>[data-slot=select-trigger]:not([class*='w-'])]:w-fit [&>input]:flex-1",variants:{orientation:{horizontal:"[&>*:not(:first-child)]:rounded-l-none [&>*:not(:first-child)]:border-l-0 [&>*:not(:last-child)]:rounded-r-none",vertical:"flex-col [&>*:not(:first-child)]:rounded-t-none [&>*:not(:first-child)]:border-t-0 [&>*:not(:last-child)]:rounded-b-none"}},defaultVariants:{orientation:"horizontal"}});var ma=u("<div><!></div>");function _a(f,e){G(e,!0);let a=oe(e,"orientation",3,"horizontal"),l=le(e,["$$slots","$$events","$$legacy","class","children","orientation"]);var o=ma();Fe(o,g=>({role:"group","data-slot":"button-group","data-orientation":a(),class:g,...l}),[()=>ye(ga({orientation:a()}),e.class)]);var v=d(o);je(v,()=>e.children??Ye),n(o),r(f,o),H()}function ha(f,e){G(e,!0);let a=oe(e,"ref",15,null),l=le(e,["$$slots","$$events","$$legacy","ref"]);var o=de(),v=_(o);p(v,()=>pt,(g,C)=>{C(g,Me({"data-slot":"alert-dialog-trigger"},()=>l,{get ref(){return a()},set ref(k){a(k)}}))}),r(f,o),H()}function pa(f,e){G(e,!0);let a=oe(e,"ref",15,null),l=le(e,["$$slots","$$events","$$legacy","ref","class"]);var o=de(),v=_(o);{let g=T(()=>ye("text-lg font-semibold",e.class));p(v,()=>$t,(C,k)=>{k(C,Me({"data-slot":"alert-dialog-title",get class(){return t(g)}},()=>l,{get ref(){return a()},set ref(E){a(E)}}))})}r(f,o),H()}function $a(f,e){G(e,!0);let a=oe(e,"ref",15,null),l=le(e,["$$slots","$$events","$$legacy","ref","class"]);var o=de(),v=_(o);{let g=T(()=>ye(Ve(),e.class));p(v,()=>Pt,(C,k)=>{k(C,Me({"data-slot":"alert-dialog-action",get class(){return t(g)}},()=>l,{get ref(){return a()},set ref(E){a(E)}}))})}r(f,o),H()}function Pa(f,e){G(e,!0);let a=oe(e,"ref",15,null),l=le(e,["$$slots","$$events","$$legacy","ref","class"]);var o=de(),v=_(o);{let g=T(()=>ye(Ve({variant:"outline"}),e.class));p(v,()=>yt,(C,k)=>{k(C,Me({"data-slot":"alert-dialog-cancel",get class(){return t(g)}},()=>l,{get ref(){return a()},set ref(E){a(E)}}))})}r(f,o),H()}var ya=u("<div><!></div>");function xa(f,e){G(e,!0);let a=oe(e,"ref",15,null),l=le(e,["$$slots","$$events","$$legacy","ref","class","children"]);var o=ya();Fe(o,g=>({"data-slot":"alert-dialog-footer",class:g,...l}),[()=>ye("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e.class)]);var v=d(o);je(v,()=>e.children??Ye),n(o),He(o,g=>a(g),()=>a()),r(f,o),H()}var ba=u("<div><!></div>");function wa(f,e){G(e,!0);let a=oe(e,"ref",15,null),l=le(e,["$$slots","$$events","$$legacy","ref","class","children"]);var o=ba();Fe(o,g=>({"data-slot":"alert-dialog-header",class:g,...l}),[()=>ye("flex flex-col gap-2 text-center sm:text-left",e.class)]);var v=d(o);je(v,()=>e.children??Ye),n(o),He(o,g=>a(g),()=>a()),r(f,o),H()}function Ca(f,e){G(e,!0);let a=oe(e,"ref",15,null),l=le(e,["$$slots","$$events","$$legacy","ref","class"]);var o=de(),v=_(o);{let g=T(()=>ye("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e.class));p(v,()=>xt,(C,k)=>{k(C,Me({"data-slot":"alert-dialog-overlay",get class(){return t(g)}},()=>l,{get ref(){return a()},set ref(E){a(E)}}))})}r(f,o),H()}var ka=u("<!> <!>",1);function za(f,e){G(e,!0);let a=oe(e,"ref",15,null),l=le(e,["$$slots","$$events","$$legacy","ref","class","portalProps"]);var o=de(),v=_(o);p(v,()=>ot,(g,C)=>{C(g,Me(()=>e.portalProps,{children:(k,E)=>{var $e=ka(),K=_($e);Ca(K,{});var ge=c(K,2);{let Pe=T(()=>ye("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed left-[50%] top-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e.class));p(ge,()=>bt,(ke,ze)=>{ze(ke,Me({"data-slot":"alert-dialog-content",get class(){return t(Pe)}},()=>l,{get ref(){return a()},set ref(ce){a(ce)}}))})}r(k,$e)},$$slots:{default:!0}}))}),r(f,o),H()}function Sa(f,e){G(e,!0);let a=oe(e,"ref",15,null),l=le(e,["$$slots","$$events","$$legacy","ref","class"]);var o=de(),v=_(o);{let g=T(()=>ye("text-muted-foreground text-sm",e.class));p(v,()=>wt,(C,k)=>{k(C,Me({"data-slot":"alert-dialog-description",get class(){return t(g)}},()=>l,{get ref(){return a()},set ref(E){a(E)}}))})}r(f,o),H()}const Oa=Ct;var Aa=u("<div><!></div>");function Ea(f,e){G(e,!0);let a=le(e,["$$slots","$$events","$$legacy","class","children"]);var l=Aa();Fe(l,v=>({"data-slot":"empty",class:v,...a}),[()=>ye("flex min-w-0 flex-1 flex-col items-center justify-center gap-6 text-balance rounded-lg border-dashed p-6 text-center md:p-12",e.class)]);var o=d(l);je(o,()=>e.children??Ye),n(l),r(f,l),H()}var Ma=u("<div><!></div>");function Ta(f,e){G(e,!0);let a=le(e,["$$slots","$$events","$$legacy","class","children"]);var l=Ma();Fe(l,v=>({"data-slot":"empty-header",class:v,...a}),[()=>ye("flex max-w-sm flex-col items-center gap-2 text-center",e.class)]);var o=d(l);je(o,()=>e.children??Ye),n(l),r(f,l),H()}const La=it({base:"mb-2 flex shrink-0 items-center justify-center [&_svg]:pointer-events-none [&_svg]:shrink-0",variants:{variant:{default:"bg-transparent",icon:"bg-muted text-foreground flex size-10 shrink-0 items-center justify-center rounded-lg [&_svg:not([class*='size-'])]:size-6"}},defaultVariants:{variant:"default"}});var ja=u("<div><!></div>");function Ya(f,e){G(e,!0);let a=oe(e,"variant",3,"default"),l=le(e,["$$slots","$$events","$$legacy","class","children","variant"]);var o=ja();Fe(o,g=>({"data-slot":"empty-icon","data-variant":a(),class:g,...l}),[()=>ye(La({variant:a()}),e.class)]);var v=d(o);je(v,()=>e.children??Ye),n(o),r(f,o),H()}var Fa=u("<div><!></div>");function Ia(f,e){G(e,!0);let a=le(e,["$$slots","$$events","$$legacy","class","children"]);var l=Fa();Fe(l,v=>({"data-slot":"empty-title",class:v,...a}),[()=>ye("text-lg font-medium tracking-tight",e.class)]);var o=d(l);je(o,()=>e.children??Ye),n(l),r(f,l),H()}var Da=u("<div><!></div>");function Ra(f,e){G(e,!0);let a=le(e,["$$slots","$$events","$$legacy","class","children"]);var l=Da();Fe(l,v=>({"data-slot":"empty-description",class:v,...a}),[()=>ye("text-muted-foreground [&>a:hover]:text-primary text-sm/relaxed [&>a]:underline [&>a]:underline-offset-4",e.class)]);var o=d(l);je(o,()=>e.children??Ye),n(l),r(f,l),H()}var Qa=u("<div><!></div>");function Ua(f,e){G(e,!0);let a=le(e,["$$slots","$$events","$$legacy","class","children"]);var l=Qa();Fe(l,v=>({"data-slot":"empty-content",class:v,...a}),[()=>ye("flex w-full min-w-0 max-w-sm flex-col items-center gap-4 text-balance text-sm",e.class)]);var o=d(l);je(o,()=>e.children??Ye),n(l),r(f,l),H()}var qa=u("<!> <!>",1),Ba=u("<!>新建 PoC",1),Va=u("<!> <!>",1),Na=u("<!> <!>",1),Wa=u("<!> <!>",1),Ga=u("<!> <!>",1),Ha=u("<!> <!>",1),Ka=u("<p>提交漏洞 PoC 至 afrog 社区</p>"),Ja=u("<!> <!>",1),Xa=u("<!> <!> <!>",1),Za=u('<div class="h-full flex flex-col"><div class="flex-1 min-h-0 p-4 flex flex-col gap-3 overflow-hidden"><!> <div class="flex-1 min-h-0 overflow-hidden relative"><!> <!></div></div></div>'),es=u("<!> <!> <!>",1),ts=u("<!> 新建 PoC",1),as=u('<div class="flex gap-2"><!></div>'),ss=u("<!> <!>",1),rs=u('<div class="mt-6"><!></div>'),os=u('<div class="h-full flex flex-col"><div class="p-4 border-b flex items-center justify-between max-h-[3.8rem]"><h3 class="font-semibold text-lg">POC 详情</h3> <div class="flex items-center gap-2"><!> <!></div></div> <!></div>');function ls(f,e){G(e,!0);let a=Ce(!1),l=Ce(!1),o=Ce(""),v=Ce(!1),g=Ce(void 0),C=T(()=>()=>t(a)||t(l)?t(o):s.selectedPoc?.yaml_content||"");Ge(()=>{console.log("displayYamlContent changed:",{editMode:t(a),isCreating:t(l),yamlContentLength:t(o).length,selectedPocId:s.selectedPoc?.poc_id||s.selectedPoc?.id,selectedPocYamlLength:s.selectedPoc?.yaml_content?.length||0,finalContentLength:t(C)().length,selectedPocYamlPreview:s.selectedPoc?.yaml_content?.substring(0,100)||"empty"})}),Ge(()=>{if(console.log("selectedPoc effect triggered:",{selectedPocId:s.selectedPoc?.poc_id||s.selectedPoc?.id,editMode:t(a),isCreating:t(l),hasYamlContent:!!s.selectedPoc?.yaml_content,pocType:t(k)(),canEdit:t(E)(),canDelete:t($e)(),filePath:s.selectedPoc?.file_path,isCurated:s.selectedPoc?.is_curated}),s.selectedPoc&&!t(a)&&!t(l)){if(console.log("Clearing yamlContent for new POC selection"),A(o,""),!s.selectedPoc.yaml_content){const i=s.selectedPoc.poc_id||s.selectedPoc.id?.toString();i&&(console.log("Loading YAML content for POC:",i),s.loadPocContent(i))}}else!s.selectedPoc&&!t(l)&&(console.log("No POC selected, clearing yamlContent"),A(o,""))});let k=T(()=>()=>s.selectedPoc?(console.log("POC Type Debug:",{poc_id:s.selectedPoc.poc_id,file_path:s.selectedPoc.file_path,is_curated:s.selectedPoc.is_curated,source:s.filters?.source}),s.selectedPoc.file_path&&s.selectedPoc.file_path.includes("/my/")?"my":s.selectedPoc.is_curated===!0?"curated":s.filters?.source==="my"||s.selectedPoc.poc_id&&(s.selectedPoc.poc_id.includes("custom-")||s.selectedPoc.poc_id.includes("user-")||s.selectedPoc.poc_id.includes("my-"))?"my":"builtin"):"unknown"),E=T(()=>()=>t(k)()==="my"),$e=T(()=>()=>t(k)()==="my"),K=T(()=>()=>{const i=!t(a)&&!t(l);return console.log("isReadOnly calculated:",{editMode:t(a),isCreating:t(l),readonly:i,pocType:t(k)(),canEdit:t(E)()}),i});const ge=`id: new-poc

info:
  name: 新建 POC
  author: your-name
  severity: high
  description: |-
    描述
  tags: tag1,tag2
  created: ${new Date().toISOString().split("T")[0].replace(/-/g,"/")}

set:
  hostname: request.url.host
rules:
  r0:
    request:
      method: GET
      path: /login.html
    expression: response.status == 200 && response.body.bcontains(b'login')
expression: r0()`;function Pe(){const i=t(C)();i&&(navigator.clipboard?.writeText(i),Ee.success("YAML 内容已复制到剪贴板"))}function ke(){try{const i=t(C)();if(!i||!i.trim()){Ee.error("暂无可下载的 YAML 内容");return}const $=s.selectedPoc?.poc_id||s.selectedPoc?.id||"poc",m=`${String($).trim().replace(/[^\w.-]+/g,"_")}.yaml`,x=new Blob([i],{type:"text/yaml;charset=utf-8"}),ne=URL.createObjectURL(x),L=document.createElement("a");L.href=ne,L.download=m,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(ne),Ee.success(`已下载: ${m}`)}catch(i){console.error("下载失败:",i),Ee.error("下载失败，请稍后重试")}}function ze(){Ee.info("功能尚未完成")}function ce(){console.log("startEdit called:",{canEdit:t(E)(),currentEditMode:t(a),selectedPoc:!!s.selectedPoc}),t(E)()&&(A(a,!0),A(o,s.selectedPoc?.yaml_content||"",!0),console.log("startEdit completed:",{editMode:t(a),yamlContentLength:t(o).length}),setTimeout(()=>{if(t(g)&&t(g).focus)t(g).focus(),console.log("Monaco Editor focused via component method");else{const i=document.querySelector(".monaco-editor textarea");i&&(i.focus(),console.log("Monaco Editor focused via DOM element"))}},200))}function ue(){console.log("cancelEdit called:",{currentEditMode:t(a),currentIsCreating:t(l),yamlContentLength:t(o).length}),A(a,!1),A(l,!1),A(o,""),console.log("cancelEdit completed:",{editMode:t(a),isCreating:t(l),yamlContent:t(o).length}),setTimeout(()=>{console.log("Force update Monaco Editor after cancel")},100)}function xe(){A(l,!0),A(a,!1),A(o,ge),s.selectedPoc=null}async function me(){if(console.log("savePoc called:",{yamlContentLength:t(o).length,isCreating:t(l),editMode:t(a),selectedPocId:s.selectedPoc?.poc_id}),!t(o).trim()){Ee.error("YAML 内容不能为空");return}if(!Se(t(o))){Ee.error("YAML 格式不正确，请检查语法");return}const i=t(a),$=t(l),h=t(o);A(v,!0);try{let m;if(t(l))console.log("Creating new POC"),m=await Re.createPoc({yaml_content:t(o)}),console.log("Create POC result:",m),Ee.success("POC 创建成功"),A(l,!1);else if(t(a)&&s.selectedPoc){console.log("Updating existing POC:",{poc_id:s.selectedPoc.poc_id,id:s.selectedPoc.id,name:s.selectedPoc.name});const x=s.selectedPoc.poc_id||s.selectedPoc.id?.toString();if(!x)throw new Error("POC ID 不存在，无法更新");m=await Re.updatePoc(x,{yaml_content:t(o)}),console.log("Update POC result:",m),Ee.success("POC 更新成功"),A(a,!1),s.selectedPoc&&(s.selectedPoc.yaml_content=t(o)),m.success&&m.data&&(s.selectedPoc=m.data)}if(m&&!m.success)throw new Error(m.message||"保存失败");console.log("Clearing yamlContent after save"),A(o,""),console.log("Reloading POCs"),await s.loadPocs(),console.log("savePoc completed:",{editMode:t(a),isCreating:t(l),yamlContentLength:t(o).length})}catch(m){console.error("保存失败:",m),A(a,i,!0),A(l,$,!0),A(o,h,!0),console.log("State rolled back due to error:",{editMode:t(a),isCreating:t(l),yamlContent:t(o).slice(0,50)+"..."});let x="保存失败，请重试";m instanceof Error&&(m.name==="ApiError"||m.message.includes("HTTP")?x=`API错误: ${m.message}`:m.message.includes("网络错误")||m.message.includes("fetch")?x="网络连接失败，请检查网络后重试":m.message.includes("登录过期")||m.message.includes("401")?x="登录已过期，请重新登录":m.message.includes("权限")?x="权限不足，无法执行此操作":x=`保存失败: ${m.message}`),Ee.error(x)}finally{A(v,!1)}}async function ie(){if(!s.selectedPoc||!t($e)())return;const i=s.selectedPoc.poc_id||s.selectedPoc.id?.toString();if(!i){console.error("Delete POC failed: No valid POC ID found",{poc_id:s.selectedPoc.poc_id,id:s.selectedPoc.id,selectedPoc:s.selectedPoc}),Ee.error("删除失败: POC ID 无效");return}console.log("Deleting POC:",{pocId:i,poc_id:s.selectedPoc.poc_id,id:s.selectedPoc.id,name:s.selectedPoc.name});try{await Re.deletePoc(i),Ee.success("POC 删除成功"),s.selectedPoc=null,await s.loadPocs()}catch($){const h=$ instanceof Error?$.message:"未知错误";Ee.error(`删除失败: ${h}`)}}function Se(i){try{const $=i.split(`
`);let h=!1,m=!1;for(const x of $)x.trim().startsWith("id:")&&(h=!0),x.trim().startsWith("info:")&&(m=!0);return h&&m}catch{return!1}}function Te(i){A(o,i,!0)}var z=os(),V=d(z),te=c(d(V),2),be=d(te);p(be,()=>_a,(i,$)=>{$(i,{children:(h,m)=>{var x=de(),ne=_(x);{var L=U=>{var Y=qa(),b=_(Y);re(b,{variant:"outline",size:"sm",onclick:ue,get disabled(){return t(v)},children:(w,I)=>{O();var S=M("取消");r(w,S)},$$slots:{default:!0}});var j=c(b,2);re(j,{size:"sm",onclick:me,get disabled(){return t(v)},children:(w,I)=>{O();var S=M();W(()=>D(S,t(v)?"保存中...":"保存")),r(w,S)},$$slots:{default:!0}}),r(U,Y)},J=U=>{var Y=Va(),b=_(Y);re(b,{size:"sm",onclick:xe,children:(I,S)=>{var q=Ba(),_e=_(q);Ze(_e,{}),O(),r(I,q)},$$slots:{default:!0}});var j=c(b,2);{var w=I=>{re(I,{variant:"outline",size:"sm",onclick:ce,children:(S,q)=>{O();var _e=M("编辑");r(S,_e)},$$slots:{default:!0}})};ee(j,I=>{s.selectedPoc&&t(E)()&&I(w)})}r(U,Y)};ee(ne,U=>{t(l)||t(a)?U(L):U(J,!1)})}r(h,x)},$$slots:{default:!0}})});var y=c(be,2);{var P=i=>{var $=de(),h=_($);p(h,()=>Oa,(m,x)=>{x(m,{children:(ne,L)=>{var J=Ha(),U=_(J);{let b=T(()=>Ve({variant:"destructive",size:"sm"}));p(U,()=>ha,(j,w)=>{w(j,{get class(){return t(b)},children:(I,S)=>{kt(I,{})},$$slots:{default:!0}})})}var Y=c(U,2);p(Y,()=>za,(b,j)=>{j(b,{children:(w,I)=>{var S=Ga(),q=_(S);p(q,()=>wa,(R,F)=>{F(R,{children:(B,N)=>{var he=Na(),X=_(he);p(X,()=>pa,(ve,se)=>{se(ve,{children:(Ae,fe)=>{O();var pe=M("确认删除 PoC?");r(Ae,pe)},$$slots:{default:!0}})});var we=c(X,2);p(we,()=>Sa,(ve,se)=>{se(ve,{children:(Ae,fe)=>{O();var pe=M();W(()=>D(pe,`确定要删除 POC "${s.selectedPoc?.name??""}" 吗？此操作不可撤销。`)),r(Ae,pe)},$$slots:{default:!0}})}),r(B,he)},$$slots:{default:!0}})});var _e=c(q,2);p(_e,()=>xa,(R,F)=>{F(R,{children:(B,N)=>{var he=Wa(),X=_(he);p(X,()=>Pa,(ve,se)=>{se(ve,{children:(Ae,fe)=>{O();var pe=M("取消");r(Ae,pe)},$$slots:{default:!0}})});var we=c(X,2);{let ve=T(()=>Ve({variant:"destructive"}));p(we,()=>$a,(se,Ae)=>{Ae(se,{get class(){return t(ve)},onclick:ie,children:(fe,pe)=>{O();var Ie=M("确认删除");r(fe,Ie)},$$slots:{default:!0}})})}r(B,he)},$$slots:{default:!0}})}),r(w,S)},$$slots:{default:!0}})}),r(ne,J)},$$slots:{default:!0}})}),r(i,$)};ee(y,i=>{s.selectedPoc&&t($e)()&&i(P)})}n(te),n(V);var Q=c(V,2);{var ae=i=>{var $=Za(),h=d($),m=d(h);{var x=Y=>{};ee(m,Y=>{s.selectedPoc&&Y(x)})}var ne=c(m,2),L=d(ne);{var J=Y=>{var b=Xa(),j=_(b);re(j,{variant:"outline",size:"sm",onclick:Pe,"aria-label":"复制 YAML",title:"复制 YAML",class:"absolute top-2 right-15 z-10",children:(S,q)=>{Ot(S,{})},$$slots:{default:!0}});var w=c(j,2);re(w,{variant:"outline",size:"sm",onclick:ke,"aria-label":"下载 YAML",title:"下载 YAML",class:"absolute top-2 right-5 z-10",children:(S,q)=>{At(S,{})},$$slots:{default:!0}});var I=c(w,2);p(I,()=>Ft,(S,q)=>{q(S,{children:(_e,R)=>{var F=Ja(),B=_(F);{let he=T(()=>Ve({variant:"outline",size:"sm"}));p(B,()=>It,(X,we)=>{we(X,{onclick:ze,get class(){return`absolute top-2 right-25 z-10 ${t(he)??""}`},children:(ve,se)=>{Et(ve,{})},$$slots:{default:!0}})})}var N=c(B,2);p(N,()=>Qt,(he,X)=>{X(he,{children:(we,ve)=>{var se=Ka();r(we,se)},$$slots:{default:!0}})}),r(_e,F)},$$slots:{default:!0}})}),r(Y,b)};ee(L,Y=>{t(l)||Y(J)})}var U=c(L,2);{let Y=T(()=>t(C)()),b=T(()=>St.current==="dark"?"vs-dark":"vs"),j=T(()=>t(K)());He(Yt(U,{get value(){return t(Y)},language:"yaml",get theme(){return t(b)},get readonly(){return t(j)},height:"100%",onchange:Te}),w=>A(g,w,!0),()=>t(g))}n(ne),n(h),n($),r(i,$)},Z=i=>{var $=rs(),h=d($);p(h,()=>Ea,(m,x)=>{x(m,{class:"from-muted/50 h-full from-30%",children:(ne,L)=>{var J=ss(),U=_(J);p(U,()=>Ta,(b,j)=>{j(b,{children:(w,I)=>{var S=es(),q=_(S);p(q,()=>Ya,(F,B)=>{B(F,{variant:"icon",children:(N,he)=>{zt(N,{})},$$slots:{default:!0}})});var _e=c(q,2);p(_e,()=>Ia,(F,B)=>{B(F,{children:(N,he)=>{O();var X=M("No PoCs Yet");r(N,X)},$$slots:{default:!0}})});var R=c(_e,2);p(R,()=>Ra,(F,B)=>{B(F,{children:(N,he)=>{O();var X=M('请选择左侧列表中的 PoC 查看详情，或点击"新建 PoC"创建新的 PoC');r(N,X)},$$slots:{default:!0}})}),r(w,S)},$$slots:{default:!0}})});var Y=c(U,2);p(Y,()=>Ua,(b,j)=>{j(b,{children:(w,I)=>{var S=as(),q=d(S);re(q,{onclick:xe,children:(_e,R)=>{var F=ts(),B=_(F);Ze(B,{}),O(),r(_e,F)},$$slots:{default:!0}}),n(S),r(w,S)},$$slots:{default:!0}})}),r(ne,J)},$$slots:{default:!0}})}),n($),r(i,$)};ee(Q,i=>{s.selectedPoc||t(l)?i(ae):i(Z,!1)})}n(z),r(f,z),H()}function is(f,e,a){A(e,0),a()}var ns=u('<div class="text-sm text-muted-foreground mb-4"> </div>'),ds=u('<button class="px-4 py-2 bg-primary text-primary-foreground rounded hover:bg-primary/90">重试</button>'),cs=u('<div class="flex items-center justify-center p-8"><div class="text-center"><div class="text-destructive mb-2">数据加载失败</div> <div class="text-sm text-muted-foreground mb-4"> </div> <!></div></div>'),us=u('<div class="flex items-center justify-center p-8"><div class="text-center"><div class="animate-spin w-6 h-6 border-2 border-primary border-t-transparent rounded-full mx-auto mb-2"></div> <div class="text-sm text-muted-foreground">正在加载数据...</div></div></div>'),vs=u('<div class="flex flex-1 min-h-0"><div class="hidden xl:block w-64 border-r"><!></div> <div class="min-h-0 w-[350px]"><!></div> <div class="hidden lg:block flex-1 min-h-0 border-l"><!></div></div>'),fs=u('<div class="flex flex-1 flex-col"><!></div>');function xs(f,e){G(e,!0);let a=Ce(!1),l=Ce(null),o=Ce(0);const v=3;async function g(){if(tt.authenticated)try{A(l,null),await s.init(),A(a,!0),A(o,0)}catch(K){if(console.error("Failed to initialize POC data:",K),A(l,K instanceof Error?K.message:"数据加载失败",!0),K instanceof Error&&K.message.includes("401"))return;t(o)<v&&(Tt(o),setTimeout(()=>{g()},1e3*t(o)))}}Ge(()=>{Mt.url.pathname==="/pocs"&&tt.authenticated&&!t(a)&&g()});var C=fs(),k=d(C);{var E=K=>{var ge=cs(),Pe=d(ge),ke=c(d(Pe),2),ze=d(ke,!0);n(ke);var ce=c(ke,2);{var ue=me=>{var ie=ns(),Se=d(ie);n(ie),W(()=>D(Se,`正在重试... (${t(o)??""}/3)`)),r(me,ie)},xe=me=>{var ie=ds();ie.__click=[is,o,g],r(me,ie)};ee(ce,me=>{t(o)<v?me(ue):me(xe,!1)})}n(Pe),n(ge),W(()=>D(ze,t(l))),r(K,ge)},$e=K=>{var ge=de(),Pe=_(ge);{var ke=ce=>{var ue=us();r(ce,ue)},ze=ce=>{var ue=vs(),xe=d(ue),me=d(xe);ra(me,{}),n(xe);var ie=c(xe,2),Se=d(ie);fa(Se,{}),n(ie);var Te=c(ie,2),z=d(Te);ls(z,{}),n(Te),n(ue),r(ce,ue)};ee(Pe,ce=>{t(a)?ce(ze,!1):ce(ke)},!0)}r(K,ge)};ee(k,K=>{t(l)?K(E):K($e,!1)})}n(C),r(f,C),H()}lt(["click"]);export{xs as component};
