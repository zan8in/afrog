id: druid-default-login

info:
  name: Apache Druid Default Login
  author: pikpikcu
  severity: high
  verified: false
  description: |-
    Apache Druid default login information (admin/admin) was discovered.
    fofa: title="druid monitor"
  tags: druid,default-login
  created: 2023/06/23

rules:
  r0:
    stop_if_match: true
    brute:
      mode: clusterbomb
      commit: winner
      continue: false
      p:
        - /druid/submitLogin
        - /submitLogin
        - /prod-api/druid/submitLogin
      username:
        - admin
        - ruoyi
        - druid
      password:
        - admin
        - 123456
        - druid
        - admin123
        - admin888
    request:
      method: POST
      path: "{{p}}"
      body: loginUsername={{username}}&loginPassword={{password}}
    expression: 'response.status == 200 && "^success$".bmatches(response.body)'
expression: r0()
