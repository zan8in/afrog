id: graphql-detect

info:
  name: GraphQL API Detection
  author: nkxxkn,elsfa7110,ofjaaah,exceed
  severity: info
  verified: true
  description: |-
    GraphQL API was detected.
    fofa: product="GraphQL"
  tags: tech,graphql
  created: 2023/06/14

rules:
  r0:
    stop_if_match: true
    brute:
      mode: sniper
      commit: winner
      continue: false
      p:
        - /HyperGraphQL
        - /___graphql
        - /altair
        - /api/cask/graphql-playground
        - /api/graphql
        - /api/graphql/v1
        - /explorer
        - /express-graphql
        - /gql
        - /graph
        - /graph_cms
        - /graphiql
        - /graphql
    request:
      method: POST
      path: "{{p}}"
      headers:
        Content-Type: application/json
      body: '{"query":"query IntrospectionQuery{__schema {queryType { name }}}"}'
    expression: response.status == 200 && response.headers['content-type'].contains('application/json') && (response.body.bcontains(b'__schema') || "(Introspection|INTROSPECTION|introspection).*?".bmatches(response.body) || ".*?operation not found.*?".bmatches(response.body))
expression: r0()
