id: fckeditor

info:
  name: Fckeditor Detect
  author: princechaddha,bernardofsr
  severity: info
  verified: true
  tags: fckeditor,detect
  created: 2025/05/15

rules:
  r0:
    stop_if_match: true
    brute:
      mode: sniper
      commit: winner
      continue: false
      p:
        - /fckeditor/_samples/default.html
        - /fckeditor/editor/filemanager/connectors/uploadtest.html
        - /ckeditor/samples/
        - /editor/ckeditor/samples/
        - /ckeditor/samples/sample_posteddata.php
        - /editor/ckeditor/samples/sample_posteddata.php
        - /fck/editor/dialog/fck_spellerpages/spellerpages/server-scripts/spellchecker.php
        - /fckeditor/editor/dialog/fck_spellerpages/spellerpages/server-scripts/spellcheckder.php
    request:
      method: GET
      path: "{{p}}"
    expression: response.body.bcontains(b'<title>FCKeditor') || response.body.bcontains(b'<title>CKEditor Samples</title>') || response.body.bcontains(b'http://ckeditor.com</a>') || response.body.bcontains(b'Custom Uploader URL:') || response.body.bcontains(b'init_spell()') || response.body.bcontains(b"'tip':'")
expression: r0()
