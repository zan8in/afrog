id: adminer-panel

info:
  name: Adminer Login Panel
  author: random_robbie,meme-lord
  severity: info
  verified: true
  description: |-
    An Adminer login panel was detected.
    fofa: app="Adminer"
  reference:
    - https://blog.sorcery.ie/posts/adminer/
  tags: adminer,panel
  created: 2023/06/17

rules:
  r0:
    stop_if_match: true
    brute:
      mode: sniper
      commit: winner
      continue: false
      p:
        - /adminer.php
        - /_adminer.php
        - /adminer/
        - /editor.php
        - /mysql.php
        - /sql.php
        - /wp-content/plugins/adminer/adminer.php
    request:
      method: GET
      path: "{{p}}"
      headers:
        Accept-Language: en-US,en;q=0.5
    expression: response.status == 200 && response.body.bcontains(b'Login - Adminer') && "<span class=\"version\">([0-9.]+)".bmatches(response.body)
expression: r0()
