id: seeyon-version

info:
  name: Seeyon Version
  author: zan8in
  severity: info
  verified: true
  tags: seeyon,version,fingerprint
  created: 2024/04/16

rules:
  r0:
    request:
      method: GET
      path: /seeyon/main.do?method=showAbout
    expression: |
      response.status == 200 && 
      response.body.bcontains(b'>Build Id:</td>') && 
      response_text.contains('>注册数:</td>')
    extractors:
      - type: regex
        extractor:
          search: '"<td width=\"75%\">&nbsp;(?P<version>.*?)</td>".submatch(response_text)'
          v: search["version"]
expression: r0()
