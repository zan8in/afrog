id: CVE-2025-68613

info:
  name: n8n - Remote Code Execution via Expression Injection
  author: rxerium,PentesterFlow,MuhamadJuwandi
  severity: critical
  description: |
    n8n < 1.120.4, 1.121.1, 1.122.0 contains a remote code execution caused by insufficient isolation in workflow expression evaluation, letting authenticated attackers execute arbitrary code with n8n process privileges. Exploit requires authentication.
    Authenticated attackers can execute arbitrary code with n8n process privileges, potentially leading to full system compromise.
    Upgrade to versions 1.120.4, 1.121.1, or 1.122.0 or later.
    fofa: app="n8n"
  reference:
    - https://github.com/n8n-io/n8n/security/advisories/GHSA-v98v-ff95-f3cp
    - https://nvd.nist.gov/vuln/detail/CVE-2025-68613
  tags: cve,cve2025,n8n,authenticated,rce,intrusive
  created: 2026/01/09

rules:
  r0:
    request:
      method: GET
      path: /signin
    expression: |
      response.status == 200 && response.body.ibcontains(b'<title>n8n.io')
    output:
      search: |
        '<meta name="n8n:config:sentry" content="(?P<b64>[A-Za-z0-9+/=]+)"'.bsubmatch(response.body)
      decoded: base64Decode(search["b64"])
      version: |
        'n8n@(?P<version>[0-9]+\\.[0-9]+\\.[0-9]+)'.submatch(decoded)

extractors:
  - type: regex
    extractor:
      ver: version["version"]
expression: |
  r0() && 
  (versionCompare(version["version"], "<", "1.120.4") ||
  versionCompare(version["version"], "<", "1.121.1") ||
  versionCompare(version["version"], "<", "1.122.0"))
