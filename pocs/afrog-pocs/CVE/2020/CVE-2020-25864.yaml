id: CVE-2020-25864

info:
  name: HashiCorp Consul/Consul Enterprise <=1.9.4 - Cross-Site Scripting
  author: c-sh0
  severity: medium
  description: |-
    HashiCorp Consul and Consul Enterprise up to version 1.9.4 are vulnerable to cross-site scripting via the key-value (KV) raw mode.
    shodan:
      - http.title:"consul by hashicorp"
      - cpe:"cpe:2.3:a:hashicorp:consul"
    fofa: title="consul by hashicorp"
    google: intitle:"consul by hashicorp"
  reference:
    - https://discuss.hashicorp.com/t/hcsec-2021-07-consul-api-kv-endpoint-vulnerable-to-cross-site-scripting/23368
    - https://www.hashicorp.com/blog/category/consul
    - https://nvd.nist.gov/vuln/detail/CVE-2020-25864
    - https://security.gentoo.org/glsa/202208-09
    - https://github.com/ARPSyndicate/cvemon
  tags: cve,cve2020,consul,xss,intrusive,hashicorp
  created: 2025/07/17

set:
  randstr: randomLowercase(12)
  alertstr: randomLowercase(22)
rules:
  r0:
    request:
      method: PUT
      path: /v1/kv/{{randstr}}
      body: "{{alertstr}}"
    expression: response.status == 200
  r1:
    request:
      method: GET
      path: /v1/kv/{{randstr}}?raw
    expression: response.status == 200 && response.body.bcontains(bytes(alertstr))
expression: r0() && r1()
