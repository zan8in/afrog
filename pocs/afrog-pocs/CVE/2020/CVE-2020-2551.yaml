id: CVE-2020-2551

info:
  name: Oracle WebLogic Server - Remote Code Execution
  author: dwisiswant0
  severity: critical
  verified: true
  description: |
    Oracle WebLogic Server (Oracle Fusion Middleware (component: WLS Core Components) is susceptible to a remote code execution vulnerability. Supported versions that are affected are 10.3.6.0.0, 12.1.3.0.0, 2.2.1.3.0 and 12.2.1.4.0. This easily exploitable vulnerability could allow unauthenticated attackers with network access via IIOP to compromise Oracle WebLogic Server.
  reference:
    - https://github.com/hktalent/CVE-2020-2551
    - https://nvd.nist.gov/vuln/detail/CVE-2020-2551
    - https://www.oracle.com/security-alerts/cpujan2020.html
  tags: cve,cve2020,oracle,weblogic,rce,unauth
  created: 2023/08/17

set:
  hostname: request.url.host
rules:
  r0:
    request:
      method: GET
      path: /console/login/LoginForm.jsp
    expression: |
      response.status == 200 &&
      response.body.bcontains(b'WebLogic') &&
      (response.body.bcontains(b'10.3.6.0') ||
      response.body.bcontains(b'12.1.3.0') ||
      response.body.bcontains(b'12.2.1.3') ||
      response.body.bcontains(b'12.2.1.4') )
  r1:
    request:
      type: tcp
      host: "{{hostname}}"
      data: "47494f50010200030000001700000002000000000000000b4e616d6553657276696365"
      data-type: hex
      read-size: 1024
    expression: hexdecode(string(response.raw)).contains("GIOP") && hexdecode(string(response.raw)).contains("weblogic")

extractors:
  - type: word
    extractor:
      tips: "需要进行人工核查 (Manual verification is required)"
expression: r0() && r1()
