id: phpmyadmin-server-import

info:
  name: PhpMyAdmin Server Import
  author: Cristi vlad
  severity: high
  description: |-
    Finds Unauthenticated PhpMyAdmin Server Import Pages.
  tags: phpmyadmin,server,import
  created: 2023/10/13

rules:
  r0:
    brute:
      mode: sniper
      commit: winner
      continue: false
      p:
        - /pma/server_import.php
        - /phpmyadmin/server_import.php
        - /phpMyAdmin 2/server_import.php
        - /db/server_import.php
        - /server_import.php
        - /PMA/server_import.php
        - /admin/server_import.php
        - /admin/pma/server_import.php
        - /phpMyAdmin/server_import.php
        - /admin/phpMyAdmin/server_import.php
    request:
      method: GET
      path: "{{p}}"
    expression: |
      response.status == 200 && response.body.bcontains(b'File to import') && response.body.bcontains(b'Location of the text file')
expression: r0()
