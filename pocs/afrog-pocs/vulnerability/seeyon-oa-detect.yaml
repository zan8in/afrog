id: seeyon-oa-detect

info:
  name: 致远 SEYYON OA 检测
  author: zan8in
  severity: info
  verified: true
  description: |-
    致远 OA 检测
  reference:
    - https://mp.weixin.qq.com/s/GbmIyGNB3Gd16n9RCCyPCg
  tags: seeyon,oa,fingerprint
  created: 2026/01/20

rules:
  r0:
    brute:
      mode: clusterbomb
      commit: winner
      continue: false
      p:
        - /
        - /seeyon
    request:
      method: GET
      path: "{{p}}"
      follow_redirects: true
    expression: |
      (response.body.bcontains(b'href="/seeyon/common') && response.body.bcontains(b'src="/seeyon/common')) ||
       response.body.bcontains(b'/seeyon/USER-DATA/IMAGES/LOGIN/login.gif') ||
       response.body.bcontains(b'/seeyon/main.do?method=main') ||
       response.raw_header.bcontains(b'path=/yyoa') ||
       response.headers['server'].icontains('SY8044') ||
       (response_text.contains('A6-V5企业版') && response.body.bcontains(b'seeyon') && response.body.bcontains(b'seeyonProductId')) ||
       (response_text.contains('A8-V5企业版') && response.body.bcontains(b'seeyon'))
    extractors:
      - type: regex
        extractor:
          title: '"<title>.* (?P<version>.*?)</title>".submatch(response_text)'
          v: title["version"]
  r1:
    request:
      method: GET
      path: /favicon.ico
    expression: response.status == 200 && faviconHash(response.body) == -187813927
expression: r0() || r1()
