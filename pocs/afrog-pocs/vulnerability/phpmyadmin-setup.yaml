id: phpmyadmin-setup

info:
  name: Publicly Accessible Phpmyadmin Setup
  author: sheikhrishad,thevillagehacker
  severity: medium
  description: |-
    Publicly Accessible Phpmyadmin Setup
  tags: phpmyadmin,setup
  created: 2023/10/13

rules:
  r0:
    brute:
      mode: sniper
      commit: winner
      continue: false
      p:
        - /phpmyadmin/setup/index.php
        - /phpmyadmin/scripts/setup.php
        - /_phpmyadmin/scripts/setup.php
        - /forum/phpmyadmin/scripts/setup.php
        - /php/phpmyadmin/scripts/setup.php
        - /typo3/phpmyadmin/scripts/setup.php
        - /web/phpmyadmin/scripts/setup.php
        - /xampp/phpmyadmin/scripts/setup.php
        - /sysadmin/phpMyAdmin/scripts/setup.php
        - /phpmyadmin/setup/index.php
        - /pma/setup/index.php
    request:
      method: GET
      path: "{{p}}"
    expression: |
      response.status == 200  && response.body.ibcontains(b'<title>phpmyadmin setup</title>')
expression: r0()
