id: gitlab-user-enum

info:
  name: GitLab - User Enumeration
  author: Suman_Kar
  severity: info
  reference:
    - https://github.com/danielmiessler/SecLists/blob/master/Usernames/Names/malenames-usa-top1000.txt
  tags: gitlab,enum,user
  created: 2023/07/20

rules:
  r0:
    brute:
      mode: sniper
      commit: winner
      continue: false
      u:
        - root
        - alert-bot
        - support-bot
        - devops_user
        - jenkins
        - user
    request:
      method: GET
      path: /users/{{u}}/exists
    expression: response.status == 200 && response.raw_header.bcontains(b'application/json') && "exists.*:true".bmatches(response.body)
expression: r0()
