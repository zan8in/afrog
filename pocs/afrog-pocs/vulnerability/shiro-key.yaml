id: shiro-key

info:
  name: Shiro Key
  author: zan8in
  severity: critical
  verified: true
  tags: shiro,key
  created: 2025/12/27

set:
  randstr: randomLowercase(6)

rules:
  r0:
    request:
      method: GET
      path: /
      follow_redirects: true
      headers:
        cookie: JSESSIONID={{randstr}};rememberMe=123;
    expression: response.raw_header.bcontains(b'rememberMe=deleteMe')

  r1:
    request:
      type: go
      data: shiro_key
    expression: response.raw.bcontains(b'ShiroKey:')

expression: r0() && r1()
