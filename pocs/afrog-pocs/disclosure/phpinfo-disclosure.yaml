id: phpinfo-disclosure

info:
  name: phpinfo Disclosure
  author: pdteam,daffainfo,meme-lord,dhiyaneshDK
  severity: low
  verified: true
  tags: php,disclosure
  created: 2023/10/29

rules:
  r0:
    stop_if_match: true
    brute:
      mode: clusterbomb
      commit: winner
      continue: false
      p:
        - /phpinfo.php
        - /php.php
        - /info.php
        - /infophp.php
        - /php_info.php
        - /test.php
        - /i.php
        - /asdf.php
        - /pinfo.php
        - /phpversion.php
        - /time.php
        - /index.php
        - /temp.php
        - /old_phpinfo.php
        - /infos.php
        - /linusadmin.php
        - /php-info.php
        - /dashboard/phpinfo.php
    request:
      method: GET
      path: "{{p}}"
    expression: response.status == 200 && response.body.bcontains(b'PHP Extension') && response.body.bcontains(b'PHP Version') && r'>PHP Version <\/td><td class="v">([0-9.]+)'.bmatches(response.body)

expression: r0()
