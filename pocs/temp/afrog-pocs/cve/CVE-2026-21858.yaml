id: CVE-2026-21858

info:
  name: n8n <= 1.65.0 Unauthenticated Workflow RCE (CVE-2026-21858)
  author: rxerium
  severity: critical
  verified: true
  description: |
    A vulnerability in n8n allows an attacker to access files on the underlying server through execution of certain form-based workflows. A vulnerable workflow could grant access to an unauthenticated remote attacker. This could result in exposure of sensitive information stored on the system and may enable further compromise depending on deployment configuration and workflow usage.
    shodan: http.favicon.hash:-831756631
    fofa: app="n8n"
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2026-21858
    - https://github.com/n8n-io/n8n/security/advisories
  tags: cve,cve2026,n8n,workflow,rce,critical
  created: 2025/01/08

rules:
  r0:
    request:
      method: GET
      path: /signin
    expression: |
      response.status == 200 && response.body.ibcontains(b'<title>n8n.io')
    output:
      search: |
        '<meta name="n8n:config:sentry" content="(?P<b64>[A-Za-z0-9+/=]+)"'.bsubmatch(response.body)
      decoded: base64Decode(search["b64"])
      version: |
        'n8n@(?P<version>[0-9]+\\.[0-9]+\\.[0-9]+)'.submatch(decoded)

extractors:
  - type: regex
    extractor:
      ver: version["version"]
expression: r0() && versionCompare(version["version"], "<=", "1.65.0")
