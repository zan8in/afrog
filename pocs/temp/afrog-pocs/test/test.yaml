id: test

info:
  name: test yaml
  author: zan8in
  severity: info

rules:
  r0:
    request:
      method: GET
      path: /
    expression: true
    output:
      test: '"<title>(?P<title>.+)</title>(.*?)<h1>(?P<h1>.+)</h1>".bsubmatch(response.body)'
  r1:
    request:
      method: POST
      path: /title={{test['title']}}
      headers:
        "h1": "{{test['h1']}}"
    expression: true
expression: r0() && r1()
