id: shellscript-disclosure

info:
  name: Shell Script Disclosure
  author: zan8in
  severity: high
  description: |
    Shell Script Disclosure
  tags: shellscript,disclosure
  created: 2025/12/27

rules:
  r0:
    request:
      method: GET
      path: /install.sh
    expression: |
      (response.status == 200 || response.status == 206) &&
      response.headers['content-type'].icontains("text") &&
      response.body.bstartsWith(b"#!/")

  r1:
    request:
      method: GET
      path: /deploy.sh
    expression: |
      (response.status == 200 || response.status == 206) &&
      response.headers['content-type'].icontains("text") &&
      response.body.bstartsWith(b"#!/")

  r2:
    request:
      method: GET
      path: /upload.sh
    expression: |
      (response.status == 200 || response.status == 206) &&
      response.headers['content-type'].icontains("text") &&
      response.body.bstartsWith(b"#!/")

  r3:
    request:
      method: GET
      path: /setup.sh
    expression: |
      (response.status == 200 || response.status == 206) &&
      response.headers['content-type'].icontains("text") &&
      response.body.bstartsWith(b"#!/")

  r4:
    request:
      method: GET
      path: /backup.sh
    expression: |
      (response.status == 200 || response.status == 206) &&
      response.headers['content-type'].icontains("text") &&
      response.body.bstartsWith(b"#!/")

  r5:
    request:
      method: GET
      path: /rsync.sh
    expression: |
      (response.status == 200 || response.status == 206) &&
      response.headers['content-type'].icontains("text") &&
      response.body.bstartsWith(b"#!/")

  r6:
    request:
      method: GET
      path: /sync.sh
    expression: |
      (response.status == 200 || response.status == 206) &&
      response.headers['content-type'].icontains("text") &&
      response.body.bstartsWith(b"#!/")

  r7:
    request:
      method: GET
      path: /test.sh
    expression: |
      (response.status == 200 || response.status == 206) &&
      response.headers['content-type'].icontains("text") &&
      response.body.bstartsWith(b"#!/")

  r8:
    request:
      method: GET
      path: /run.sh
    expression: |
      (response.status == 200 || response.status == 206) &&
      response.headers['content-type'].icontains("text") &&
      response.body.bstartsWith(b"#!/")

expression: r0() || r1() || r2() || r3() || r4() || r5() || r6() || r7() || r8()
